‚úì Starting...
 ‚úì Ready in 1526ms
 ‚úì Compiled /middleware in 346ms (407 modules)
 ‚óã Compiling /api/auth/oidc/login ...
 ‚úì Compiled /api/auth/oidc/login in 938ms (726 modules)
{"@timestamp":"2025-10-12T07:50:28.877Z","level":"INFO","message":"Connecting to Redis","service":"bendcare-os","env":"development","file":"redis.ts","line":78,"function":"RedisClientManager.connect","component":"redis","host":"bcos-redis-dev-rt5vbv.serverless.use1.cache.amazonaws.com","port":6379,"username":"[REDACTED]","keyPrefix":"[REDACTED]","tls":true}
{"@timestamp":"2025-10-12T07:50:29.033Z","level":"INFO","message":"Redis connected successfully","service":"bendcare-os","env":"development","file":"redis.ts","line":109,"function":"EventEmitter.eval","component":"redis","host":"[REDACTED]","port":6379}
{"@timestamp":"2025-10-12T07:50:29.076Z","level":"INFO","message":"Redis ready for commands","service":"bendcare-os","env":"development","file":"redis.ts","line":119,"function":"EventEmitter.eval","component":"redis"}
{"@timestamp":"2025-10-12T07:50:29.201Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","type":"auth","identifier":"::1","current":4,"remaining":16,"limit":20}
{"@timestamp":"2025-10-12T07:50:29.202Z","level":"INFO","message":"GET /api/auth/oidc/login - OIDC login initiated","service":"bendcare-os","env":"development","file":"route.ts","line":55,"function":"oidcLoginHandler","correlationId":"cor_mgnemsnr_qjdhnbmr","component":"api","method":"GET","path":"/api/auth/oidc/login","request":{}}
{"@timestamp":"2025-10-12T07:50:29.205Z","level":"INFO","message":"OIDC login initiation started","service":"bendcare-os","env":"development","file":"route.ts","line":75,"function":"oidcLoginHandler","requestId":"unknown","ipAddress":"[REDACTED]","returnUrl":"/dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa","fingerprint":"13b197eeb712468a..."}
{"@timestamp":"2025-10-12T07:50:29.206Z","level":"DEBUG","message":"OIDC configuration loaded","service":"bendcare-os","env":"development","file":"config.ts","line":48,"function":"buildOIDCConfig","tenantId":"[UUID]","clientId":"44ae5aae...","redirectUri":"http://localhost:4001/api/auth/oidc/callback","scopes":["openid","profile","email"],"allowedDomains":["aara.care","sparc.care","illumination.health","bendcare.com","oasis.care"],"strictFingerprint":false}
{"@timestamp":"2025-10-12T07:50:29.207Z","level":"INFO","message":"Fetching OIDC discovery document","service":"bendcare-os","env":"development","file":"client.ts","line":65,"function":"OIDCClient.initialize","tenantId":"[UUID]"}
{"@timestamp":"2025-10-12T07:50:29.431Z","level":"INFO","message":"OIDC configuration discovered successfully","service":"bendcare-os","env":"development","file":"client.ts","line":72,"function":"OIDCClient.initialize","issuer":"https://login.microsoftonline.com/e0268fe2-3176-4ac0-8cef-5f1925dd490e/v2.0"}
{"@timestamp":"2025-10-12T07:50:29.435Z","level":"DEBUG","message":"Authorization URL created","service":"bendcare-os","env":"development","file":"client.ts","line":120,"function":"OIDCClient.createAuthUrl","state":"a-xV-Wsr...","nonce":"ziUCKmb3...","scopes":["openid","profile","email"]}
Query: insert into "oidc_states" ("state", "nonce", "user_fingerprint", "is_used", "created_at", "expires_at", "used_at") values ($1, $2, $3, $4, default, $5, default) -- params: ["a-xV-WsrnfDNZ3Mk-AMf_k6xoeHvE4IFUK5elWYZ_to", "ziUCKmb3y8VNbyU6Ds2_Wh9bjsNcjVxyH1BrY_wwKmg", "13b197eeb712468ac5b56dbf7be43c43", false, "2025-10-12T07:55:59.435Z"]
{"@timestamp":"2025-10-12T07:50:29.455Z","level":"DEBUG","message":"State token registered in database","service":"bendcare-os","env":"development","file":"database-state-manager.ts","line":72,"function":"DatabaseStateManager.registerState","state":"a-xV-Wsr...","expiresAt":"2025-10-12T07:55:59.435Z"}
{"@timestamp":"2025-10-12T07:50:29.455Z","level":"DEBUG","message":"OIDC state token registered","service":"bendcare-os","env":"development","file":"route.ts","line":88,"function":"oidcLoginHandler","state":"a-xV-Wsr..."}
{"@timestamp":"2025-10-12T07:50:29.459Z","level":"INFO","message":"OIDC login audit","service":"bendcare-os","env":"development","file":"route.ts","line":118,"function":"oidcLoginHandler","ipAddress":"[REDACTED]","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","returnUrl":"/dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa"}
{"@timestamp":"2025-10-12T07:50:29.459Z","level":"INFO","message":"OIDC login redirect","service":"bendcare-os","env":"development","file":"route.ts","line":124,"function":"oidcLoginHandler","duration":257,"authEndpoint":"https://login.microsoftonline.com/e0268fe2-3176-4ac0-8cef-5f1925dd490e/oauth2/v2.0/authorize"}
 GET /api/auth/oidc/login?returnUrl=%2Fdashboard%2Fview%2Fa0324818-ae41-4bf5-8291-447f30322faa 307 in 1723ms
 ‚óã Compiling /api/auth/oidc/callback ...
 ‚úì Compiled /api/auth/oidc/callback in 508ms (729 modules)
{"@timestamp":"2025-10-12T07:50:31.008Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","type":"auth","identifier":"::1","current":5,"remaining":15,"limit":20}
{"@timestamp":"2025-10-12T07:50:31.009Z","level":"INFO","message":"GET /api/auth/oidc/callback - OIDC callback received","service":"bendcare-os","env":"development","file":"route.ts","line":70,"function":"oidcCallbackHandler","correlationId":"cor_mgnemul5_wzcvapiq","component":"api","method":"GET","path":"/api/auth/oidc/callback","request":{}}
Query: select "state", "nonce", "user_fingerprint", "is_used", "created_at", "expires_at", "used_at" from "oidc_states" where ("oidc_states"."state" = $1 and "oidc_states"."expires_at" > $2) for update -- params: ["a-xV-WsrnfDNZ3Mk-AMf_k6xoeHvE4IFUK5elWYZ_to", "2025-10-12T07:50:31.015Z"]
Query: update "oidc_states" set "is_used" = $1, "used_at" = $2 where "oidc_states"."state" = $3 -- params: [true, "2025-10-12T07:50:31.019Z", "a-xV-WsrnfDNZ3Mk-AMf_k6xoeHvE4IFUK5elWYZ_to"]
{"@timestamp":"2025-10-12T07:50:31.020Z","level":"INFO","message":"State token validated and marked as used","service":"bendcare-os","env":"development","file":"database-state-manager.ts","line":135,"function":"eval","state":"a-xV-Wsr...","age":1567}
{"@timestamp":"2025-10-12T07:50:31.022Z","level":"DEBUG","message":"OIDC configuration loaded","service":"bendcare-os","env":"development","file":"config.ts","line":48,"function":"buildOIDCConfig","tenantId":"[UUID]","clientId":"44ae5aae...","redirectUri":"http://localhost:4001/api/auth/oidc/callback","scopes":["openid","profile","email"],"allowedDomains":["aara.care","sparc.care","illumination.health","bendcare.com","oasis.care"],"strictFingerprint":false}
{"@timestamp":"2025-10-12T07:50:31.022Z","level":"INFO","message":"Fetching OIDC discovery document","service":"bendcare-os","env":"development","file":"client.ts","line":65,"function":"OIDCClient.initialize","tenantId":"[UUID]"}
{"@timestamp":"2025-10-12T07:50:31.080Z","level":"INFO","message":"OIDC configuration discovered successfully","service":"bendcare-os","env":"development","file":"client.ts","line":72,"function":"OIDCClient.initialize","issuer":"https://login.microsoftonline.com/e0268fe2-3176-4ac0-8cef-5f1925dd490e/v2.0"}
{"@timestamp":"2025-10-12T07:50:31.429Z","level":"DEBUG","message":"Token exchange successful","service":"bendcare-os","env":"development","file":"client.ts","line":183,"function":"OIDCClient.handleCallback","hasAccessToken":"[REDACTED]","hasIdToken":"[REDACTED]","hasRefreshToken":"[REDACTED]"}
{"@timestamp":"2025-10-12T07:50:31.430Z","level":"INFO","message":"ID token validation successful","service":"bendcare-os","env":"development","file":"client.ts","line":310,"function":"OIDCClient.handleCallback","email":"[REDACTED]","iat":"2025-10-12T07:45:31.000Z","exp":"2025-10-12T08:50:31.000Z","tokenAge":"[REDACTED]"}
{"@timestamp":"2025-10-12T07:50:31.430Z","level":"INFO","message":"OIDC token exchange successful","service":"bendcare-os","env":"development","file":"route.ts","line":244,"function":"oidcCallbackHandler","email":"[REDACTED]","emailVerified":"[REDACTED]"}
Query: select "user_id", "email", "first_name", "last_name", "password_hash", "email_verified", "is_active", "created_at", "updated_at", "deleted_at" from "users" where "users"."email" = $1 limit $2 -- params: ["pj@illumination.health", 1]
Query: insert into "refresh_tokens" ("token_id", "user_id", "token_hash", "device_fingerprint", "ip_address", "user_agent", "remember_me", "issued_at", "expires_at", "last_used", "is_active", "revoked_at", "revoked_reason", "rotation_count", "created_at") values ($1, $2, $3, $4, $5, $6, $7, default, $8, default, default, default, default, $9, default) -- params: ["3L5k8giiJ-HxCF-DISX3uzAj2G6Yb8M3", "cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", "f228df258a8f5d4e668dfb1f1b695075dcca9b6a72808d400d14af5fd48df172", "13b197eeb712468ac5b56dbf7be43c43", "::1", "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36", false, "2025-10-19T07:50:31.433Z", 0]
Query: insert into "user_sessions" ("session_id", "user_id", "refresh_token_id", "device_fingerprint", "device_name", "ip_address", "user_agent", "remember_me", "is_active", "last_activity", "created_at", "ended_at", "end_reason") values ($1, $2, $3, $4, $5, $6, $7, $8, default, default, default, default, default) -- params: ["x3PeM8U_ULaUvInt0X4p1wLgqXkWPAFm", "cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", "3L5k8giiJ-HxCF-DISX3uzAj2G6Yb8M3", "13b197eeb712468ac5b56dbf7be43c43", "Chrome Browser", "::1", "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36", false]
Query: insert into "login_attempts" ("attempt_id", "email", "user_id", "ip_address", "user_agent", "device_fingerprint", "success", "failure_reason", "remember_me_requested", "session_id", "attempted_at") values ($1, $2, $3, $4, $5, $6, $7, default, $8, $9, default) -- params: ["-ZdkYI4yyCVPxUWnNHyxK", "pj@illumination.health", "cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", "::1", "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36", "13b197eeb712468ac5b56dbf7be43c43", true, false, "x3PeM8U_ULaUvInt0X4p1wLgqXkWPAFm"]
{"@timestamp":"2025-10-12T07:50:31.442Z","level":"INFO","message":"Auth: login","service":"bendcare-os","env":"development","file":"audit.ts","line":17,"function":"AuditLoggerService.logAuth","component":"auth","action":"login","success":true,"userId":"[UUID]","ipAddress":"[REDACTED]","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","email":"[REDACTED]","authMethod":"oidc","sessionId":"x3PeM8U_ULaUvInt0X4p1wLgqXkWPAFm","refreshTokenId":"[REDACTED]","rememberMe":false,"deviceFingerprint":"13b197eeb712468ac5b56dbf7be43c43","deviceName":"Chrome Browser"}
{"@timestamp":"2025-10-12T07:50:31.443Z","level":"INFO","message":"Audit event processed","service":"bendcare-os","env":"development","file":"audit.ts","line":25,"function":"AuditLoggerService.logAuth","eventType":"auth","action":"login","severity":"medium","complianceFramework":"HIPAA","retentionPeriod":"7_years"}
Query: insert into "audit_logs" ("audit_log_id", "event_type", "action", "user_id", "ip_address", "user_agent", "resource_type", "resource_id", "old_values", "new_values", "metadata", "severity", "created_at") values ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13) -- params: ["wrC8enFUB6iBMqQouxDnh", "auth", "login", "cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", "::1", "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36", null, null, null, null, "{\"email\":\"pj@illumination.health\",\"authMethod\":\"oidc\",\"sessionId\":\"x3PeM8U_ULaUvInt0X4p1wLgqXkWPAFm\",\"refreshTokenId\":\"3L5k8giiJ-HxCF-DISX3uzAj2G6Yb8M3\",\"rememberMe\":false,\"deviceFingerprint\":\"13b197eeb712468ac5b56dbf7be43c43\",\"deviceName\":\"Chrome Browser\"}", "medium", "2025-10-12T07:50:31.443Z"]
{"@timestamp":"2025-10-12T07:50:31.445Z","level":"DEBUG","message":"Audit log created","service":"bendcare-os","env":"development","file":"audit.ts","line":145,"function":"AuditLoggerService.log","eventType":"auth","action":"login","userId":"[UUID]","severity":"medium","operation":"createAuditLog","component":"audit-system","feature":"compliance-logging"}
{"@timestamp":"2025-10-12T07:50:31.445Z","level":"INFO","message":"OIDC callback successful - user authenticated","service":"bendcare-os","env":"development","file":"route.ts","line":348,"function":"oidcCallbackHandler","operation":"oidc_callback","success":true,"userId":"[UUID]","email":"[REDACTED]","authMethod":"oidc","sessionId":"x3PeM8U_ULaUvInt0X4p1wLgqXkWPAFm","ipAddress":"[REDACTED]","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","deviceName":"Chrome Browser","deviceFingerprint":"13b197ee","securityValidations":{"sessionDecryption":"passed","stateCsrfProtection":"passed","stateReplayPrevention":"passed","deviceFingerprintCheck":"passed","pkceValidation":"passed","emailVerification":"[REDACTED]","emailDomain":"[REDACTED]","profileSanitization":"passed","userProvisioning":"existing","userActiveStatus":"active"},"duration":436,"component":"auth","severity":"info"}
{"@timestamp":"2025-10-12T07:50:31.446Z","level":"INFO","message":"OIDC callback redirect","service":"bendcare-os","env":"development","file":"route.ts","line":405,"function":"oidcCallbackHandler","requestedReturnUrl":"/dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa","resolvedReturnUrl":"/dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa","baseUrl":"http://localhost:4001/api/auth/oidc/callback?code=1.ASkA4o8m4HYxwEqM718ZJd1JDq5arkSCS7dDreiVxdfAXZUpAE0pAA.AgABBAIAAABlMNzVhAPUTrARzfQjWPtKAwDs_wUA9P-aN4wejZ1a-PBmNV4JkKkIC0vBoh37r7WeVP9JzXPmdRzb_kKPoLkFvG8N3__dxqXJhA3VDMMcaAMgurU0CHyNT956LoF8w1aQntab_kas-qU79OyBhLfG-tJ_4Q9f_0dNsvsXusSxK1H5v41YzPin3AetxueLmDttURwQ3PKLqBpqyEg7NZCETT4I7rhDWkIKKoURtLMXgcGUyDBWNi0QCaaR5DspfsPxAiUOHtNEg15NNM9XIQLpjo3c0POc0Utcrx4B43QlPQQH4No48lyaEMjvonimrDwEu9eDZa5M4nTTTf-ux2Rcor9Twgje94wFGrfZ5J5M2OlHEfVXlo0kaqqpcmhvaB1_ZUx6gyNa9Lh18IcanM0dzXInpgkDzj1KnGBlnJiRUx9Z0iybJVhc9SgXsIN3R4w8aW4c2kS7-4Yh_OVeIDrZycAQADDDhZ-1kJevMCWE8kLwZbIMeVterF7nIgP-eIsjh-vDMRnqytYKKVRc13gy07Fm3Hd3XLhDekjKPZg1sGCRn-Vx-JM_E71aGKecpxWQTG4NwqjPLa0w1oOnlv_Zp6hd6XmuQX14CIM1ajy5uzf4jsHCJr25BfL20ULA0JMQzTejt0K50CnZBBCYsegp4QIsD-bZkEZGcel4hPEO90foTNowW1fsVjZqR0MGPRxnJ2fHCBjKXmriYfwwt9DfRXK6lp2A5TvKmEHWQK97Rc7guL5VZy8AitlAIjHu6Ip2wH4NU3hdk6gTLjJJjrrJrN3SdBJKOvXQFQ0ht6El-WNtKI2n-dc0rxp4cXm0RSdBeZgmTP1Ds52XU-69UidqNWXI2cH012mQeheXC7W-JCQxtYTY_PoYE6j9LyRruI7HPnaqqT8og7EwW76WDv1WZlzb01E4Eircw7o-o2mecoaGFpO_Cx3JIMk&state=a-xV-WsrnfDNZ3Mk-AMf_k6xoeHvE4IFUK5elWYZ_to&session_state=008cb789-1185-0cdd-3831-9608c634a050","finalRedirect":"http://localhost:4001/authenticating?returnUrl=%2Fdashboard%2Fview%2Fa0324818-ae41-4bf5-8291-447f30322faa"}
 GET /api/auth/oidc/callback?code=1.ASkA4o8m4HYxwEqM718ZJd1JDq5arkSCS7dDreiVxdfAXZUpAE0pAA.AgABBAIAAABlMNzVhAPUTrARzfQjWPtKAwDs_wUA9P-aN4wejZ1a-PBmNV4JkKkIC0vBoh37r7WeVP9JzXPmdRzb_kKPoLkFvG8N3__dxqXJhA3VDMMcaAMgurU0CHyNT956LoF8w1aQntab_kas-qU79OyBhLfG-tJ_4Q9f_0dNsvsXusSxK1H5v41YzPin3AetxueLmDttURwQ3PKLqBpqyEg7NZCETT4I7rhDWkIKKoURtLMXgcGUyDBWNi0QCaaR5DspfsPxAiUOHtNEg15NNM9XIQLpjo3c0POc0Utcrx4B43QlPQQH4No48lyaEMjvonimrDwEu9eDZa5M4nTTTf-ux2Rcor9Twgje94wFGrfZ5J5M2OlHEfVXlo0kaqqpcmhvaB1_ZUx6gyNa9Lh18IcanM0dzXInpgkDzj1KnGBlnJiRUx9Z0iybJVhc9SgXsIN3R4w8aW4c2kS7-4Yh_OVeIDrZycAQADDDhZ-1kJevMCWE8kLwZbIMeVterF7nIgP-eIsjh-vDMRnqytYKKVRc13gy07Fm3Hd3XLhDekjKPZg1sGCRn-Vx-JM_E71aGKecpxWQTG4NwqjPLa0w1oOnlv_Zp6hd6XmuQX14CIM1ajy5uzf4jsHCJr25BfL20ULA0JMQzTejt0K50CnZBBCYsegp4QIsD-bZkEZGcel4hPEO90foTNowW1fsVjZqR0MGPRxnJ2fHCBjKXmriYfwwt9DfRXK6lp2A5TvKmEHWQK97Rc7guL5VZy8AitlAIjHu6Ip2wH4NU3hdk6gTLjJJjrrJrN3SdBJKOvXQFQ0ht6El-WNtKI2n-dc0rxp4cXm0RSdBeZgmTP1Ds52XU-69UidqNWXI2cH012mQeheXC7W-JCQxtYTY_PoYE6j9LyRruI7HPnaqqT8og7EwW76WDv1WZlzb01E4Eircw7o-o2mecoaGFpO_Cx3JIMk&state=a-xV-WsrnfDNZ3Mk-AMf_k6xoeHvE4IFUK5elWYZ_to&session_state=008cb789-1185-0cdd-3831-9608c634a050 307 in 1217ms
üåê MIDDLEWARE: Processing request for: /authenticating
üåê MIDDLEWARE: Public path detected, allowing through: /authenticating
 ‚óã Compiling /authenticating ...
 ‚úì Compiled /authenticating in 1445ms (1984 modules)
 GET /authenticating?returnUrl=%2Fdashboard%2Fview%2Fa0324818-ae41-4bf5-8291-447f30322faa 200 in 1761ms
 ‚úì Compiled /api/auth/me in 366ms (1989 modules)
üåê MIDDLEWARE: Processing request for: /authenticating
üåê MIDDLEWARE: Public path detected, allowing through: /authenticating
{"@timestamp":"2025-10-12T07:50:34.163Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","type":"api","identifier":"::1","current":3,"remaining":197,"limit":200}
{"@timestamp":"2025-10-12T07:50:34.164Z","level":"INFO","message":"JWT authentication middleware initiated","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":100,"function":"requireJWTAuth","url":"http://localhost:4001/api/auth/me","method":"GET","hasAuthHeader":false,"hasCookieHeader":"[REDACTED]"}
üîê AUTH: Using access token from httpOnly cookie
 GET /authenticating?returnUrl=%2Fdashboard%2Fview%2Fa0324818-ae41-4bf5-8291-447f30322faa 200 in 72ms
Query: select "jti", "user_id", "token_type", "blacklisted_at", "expires_at", "reason", "blacklisted_by", "ip_address", "user_agent" from "token_blacklist" where "token_blacklist"."jti" = $1 limit $2 -- params: ["HRQVCpPKhG0mwJy5ANZp0", 1]
{"@timestamp":"2025-10-12T07:50:34.203Z","level":"INFO","message":"Auth: jwt_validation","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":153,"function":"requireJWTAuth","component":"auth","action":"jwt_validation","success":true,"userId":"[UUID]","sessionId":"x3PeM8U_ULaUvInt0X4p1wLgqXkWPAFm","tokenSource":"[REDACTED]","validationDuration":39}
üîê AUTH: JWT cache miss, falling back to database query
{"@timestamp":"2025-10-12T07:50:34.318Z","level":"DEBUG","message":"Redis user context cache hit","service":"bendcare-os","env":"development","file":"cached-user-context.ts","line":256,"function":"eval","userId":"[UUID]","rolesCount":1,"permissionsCount":89,"fromRedis":true}
{"@timestamp":"2025-10-12T07:50:34.318Z","level":"INFO","message":"JWT authentication completed","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":189,"function":"requireJWTAuth","userId":"[UUID]","sessionId":"x3PeM8U_ULaUvInt0X4p1wLgqXkWPAFm","tokenSource":"[REDACTED]","cacheHit":true,"roleCount":1,"permissionCount":89,"duration":154}
{"@timestamp":"2025-10-12T07:50:34.318Z","level":"WARN","message":"Security: jwt_authentication_successful","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":199,"function":"requireJWTAuth","component":"security","event":"jwt_authentication_successful","severity":"low","action":"jwt_middleware_success","userId":"[UUID]","tokenValidated":"[REDACTED]","rbacContextLoaded":true,"cacheOptimized":true}
{"@timestamp":"2025-10-12T07:50:34.319Z","level":"INFO","message":"JWT middleware completed","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":207,"function":"requireJWTAuth","duration":155,"performanceTiming":true,"tokenValidationTime":"[REDACTED]","cacheEnabled":true,"totalOperations":90}
{"@timestamp":"2025-10-12T07:50:34.319Z","level":"INFO","message":"user context retrieved successfully from JWT token","service":"bendcare-os","env":"development","file":"route.ts","line":41,"function":"GET","operation":"get_user_context","userId":"[UUID]","email":"[REDACTED]","rbac":{"roles":1,"permissions":89,"isSuperAdmin":true,"orgAdminFor":0},"organizations":{"direct":0,"accessible":0,"current":null},"duration":229,"slow":false,"component":"auth","cached":true}
 GET /api/auth/me 200 in 760ms
üåê MIDDLEWARE: Processing request for: /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa
üåê MIDDLEWARE: Protected route detected
üåê MIDDLEWARE: Checking auth - access token: true, refresh token: true
üåê MIDDLEWARE: Access token valid - allowing access
üåê MIDDLEWARE: User authenticated (or has refresh token) - allowing request to proceed
 ‚óã Compiling /dashboard/view/[dashboardId] ...
 ‚úì Compiled /dashboard/view/[dashboardId] in 1496ms (2591 modules)
{"@timestamp":"2025-10-12T07:50:36.081Z","level":"INFO","message":"GET /api/csrf - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":41,"function":"eval","correlationId":"cor_mgnemxqv_ui3jin9a","method":"GET","path":"/api/csrf","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/csrf"}}
{"@timestamp":"2025-10-12T07:50:36.082Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":42,"function":"eval","correlationId":"cor_mgnemxqv_ui3jin9a","method":"GET","path":"/api/csrf","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"endpoint":"/api/csrf","requiredPermissions":[],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/csrf"}}
{"@timestamp":"2025-10-12T07:50:36.152Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnemxqv_ui3jin9a","method":"GET","path":"/api/csrf","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":71,"type":"api","identifier":"::1","current":4,"remaining":196,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/csrf"}}
{"@timestamp":"2025-10-12T07:50:36.152Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":55,"function":"eval","correlationId":"cor_mgnemxqv_ui3jin9a","method":"GET","path":"/api/csrf","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":70,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/csrf"}}
{"@timestamp":"2025-10-12T07:50:36.153Z","level":"DEBUG","message":"Route marked as public","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgnemxqv_ui3jin9a","method":"GET","path":"/api/csrf","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":72,"reason":"CSRF tokens must be available to anonymous users for login protection","_contextMetadata":{"method":"GET","path":"/api/csrf"}}
{"@timestamp":"2025-10-12T07:50:36.153Z","level":"DEBUG","message":"Public route - skipping user context and RBAC checks","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":96,"function":"eval","correlationId":"cor_mgnemxqv_ui3jin9a","method":"GET","path":"/api/csrf","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":72,"endpoint":"/api/csrf","publicReason":"CSRF tokens must be available to anonymous users for login protection","_contextMetadata":{"method":"GET","path":"/api/csrf"}}
Query: select "jti", "user_id", "token_type", "blacklisted_at", "expires_at", "reason", "blacklisted_by", "ip_address", "user_agent" from "token_blacklist" where "token_blacklist"."jti" = $1 limit $2 -- params: ["HRQVCpPKhG0mwJy5ANZp0", 1]
{"@timestamp":"2025-10-12T07:50:36.159Z","level":"INFO","message":"CSRF token request initiated","service":"bendcare-os","env":"development","file":"route.ts","line":47,"function":"getCSRFTokenHandler","correlationId":"cor_mgnemxqv_ui3jin9a","method":"GET","path":"/api/csrf","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":78,"isAuthenticated":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/csrf"}}
{"@timestamp":"2025-10-12T07:50:36.160Z","level":"INFO","message":"Authenticated CSRF token generated","service":"bendcare-os","env":"development","file":"route.ts","line":58,"function":"getCSRFTokenHandler","correlationId":"cor_mgnemxqv_ui3jin9a","method":"GET","path":"/api/csrf","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":79,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/csrf"}}
{"@timestamp":"2025-10-12T07:50:36.161Z","level":"INFO","message":"CSRF token issued successfully","service":"bendcare-os","env":"development","file":"route.ts","line":82,"function":"getCSRFTokenHandler","correlationId":"cor_mgnemxqv_ui3jin9a","method":"GET","path":"/api/csrf","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":80,"tokenType":"[REDACTED]","_contextMetadata":{"method":"GET","path":"/api/csrf"}}
{"@timestamp":"2025-10-12T07:50:36.161Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":103,"function":"eval","correlationId":"cor_mgnemxqv_ui3jin9a","method":"GET","path":"/api/csrf","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":8,"statusCode":200,"isPublic":true,"_contextMetadata":{"method":"GET","path":"/api/csrf"}}
{"@timestamp":"2025-10-12T07:50:36.161Z","level":"INFO","message":"Public route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":109,"function":"eval","correlationId":"cor_mgnemxqv_ui3jin9a","method":"GET","path":"/api/csrf","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":80,"endpoint":"/api/csrf","statusCode":200,"totalDuration":80,"_contextMetadata":{"method":"GET","path":"/api/csrf"}}
 GET /api/csrf 200 in 1834ms
 GET /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa 200 in 2273ms
 ‚óã Compiling /api/admin/analytics/dashboards/[dashboardId] ...
 ‚úì Compiled /api/admin/analytics/dashboards/[dashboardId] in 1765ms (2599 modules)
{"@timestamp":"2025-10-12T07:50:38.784Z","level":"INFO","message":"GET /api/admin/analytics/dashboards - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":41,"function":"eval","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:38.784Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":42,"function":"eval","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"endpoint":"/api/admin/analytics/dashboards","requiredPermissions":["analytics:read:all"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
üåê MIDDLEWARE: Processing request for: /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa
üåê MIDDLEWARE: Protected route detected
üåê MIDDLEWARE: Checking auth - access token: true, refresh token: true
üåê MIDDLEWARE: Access token valid - allowing access
üåê MIDDLEWARE: User authenticated (or has refresh token) - allowing request to proceed
{"@timestamp":"2025-10-12T07:50:38.881Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":98,"type":"api","identifier":"::1","current":5,"remaining":195,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:38.881Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":55,"function":"eval","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":97,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:38.881Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":98,"pathname":"/api/admin/analytics/dashboards","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
 GET /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa 200 in 89ms
{"@timestamp":"2025-10-12T07:50:38.913Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":130,"type":"api","identifier":"::1","current":6,"remaining":194,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:38.914Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":104,"function":"applyGlobalAuth","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":131,"pathname":"/api/admin/analytics/dashboards","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:38.914Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":131,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:38.987Z","level":"DEBUG","message":"Loading user context","service":"bendcare-os","env":"development","file":"user-context.ts","line":304,"function":"getUserContextSafe","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":204,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
Query: select "user_id", "email", "first_name", "last_name", "is_active", "email_verified", "created_at", "updated_at" from "users" where "users"."user_id" = $1 limit $2 -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", 1]
Query: select "user_organizations"."user_organization_id", "user_organizations"."user_id", "user_organizations"."organization_id", "user_organizations"."is_active", "user_organizations"."joined_at", "user_organizations"."created_at", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at" from "user_organizations" inner join "organizations" on "user_organizations"."organization_id" = "organizations"."organization_id" where ("user_organizations"."user_id" = $1 and "user_organizations"."is_active" = $2 and "organizations"."is_active" = $3) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true]
Query: select distinct "user_roles"."user_role_id", "user_roles"."user_id", "user_roles"."role_id", "user_roles"."organization_id", "user_roles"."granted_by", "user_roles"."granted_at", "user_roles"."expires_at", "user_roles"."is_active", "user_roles"."created_at", "roles"."name", "roles"."description", "roles"."organization_id", "roles"."is_system_role", "roles"."is_active", "roles"."created_at", "roles"."updated_at", "roles"."deleted_at", "permissions"."permission_id", "permissions"."name", "permissions"."description", "permissions"."resource", "permissions"."action", "permissions"."scope", "permissions"."is_active", "permissions"."created_at", "permissions"."updated_at" from "user_roles" inner join "roles" on "user_roles"."role_id" = "roles"."role_id" inner join "role_permissions" on "roles"."role_id" = "role_permissions"."role_id" inner join "permissions" on "role_permissions"."permission_id" = "permissions"."permission_id" where ("user_roles"."user_id" = $1 and "user_roles"."is_active" = $2 and "roles"."is_active" = $3 and "permissions"."is_active" = $4) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true, true]
{"@timestamp":"2025-10-12T07:50:39.003Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"user-context.ts","line":314,"function":"eval","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":220,"userId":"[UUID]","rolesCount":1,"permissionsCount":89,"organizationsCount":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.003Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":126,"function":"applyGlobalAuth","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/dashboards","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":89,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.003Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":65,"function":"eval","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":122,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.004Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":68,"function":"eval","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":221,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.004Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":126,"function":"eval","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.004Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":148,"function":"eval","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":221,"userId":"[UUID]","roleCount":1,"permissionCount":89,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.004Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":164,"function":"eval","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:all"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.004Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":173,"function":"eval","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":221,"userId":"[UUID]","permissions":["analytics:read:all"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.004Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":180,"function":"eval","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":221,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
Query: select "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "users"."user_id", "users"."first_name", "users"."last_name", "users"."email", count("dashboard_charts"."chart_definition_id") from "dashboards" left join "chart_categories" on "dashboards"."dashboard_category_id" = "chart_categories"."chart_category_id" left join "users" on "dashboards"."created_by" = "users"."user_id" left join "dashboard_charts" on "dashboards"."dashboard_id" = "dashboard_charts"."dashboard_id" where ("dashboards"."is_active" = $1 and "dashboards"."is_published" = $2) group by "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "users"."user_id", "users"."first_name", "users"."last_name", "users"."email" order by "dashboards"."created_at" desc limit $3 -- params: [true, true, 1000000]
Query: select count(*) from "dashboards" where ("dashboards"."is_active" = $1 and "dashboards"."is_published" = $2) -- params: [true, true]
{"@timestamp":"2025-10-12T07:50:39.012Z","level":"INFO","message":"dashboards list query completed - returned 4 of 4","service":"bendcare-os","env":"development","file":"route.ts","line":63,"function":"getDashboardsHandler","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_dashboards","resourceType":"dashboards","userId":"[UUID]","filters":{"is_active":true,"is_published":true},"filterCount":2,"results":{"returned":4,"total":4,"published":4,"draft":0,"hasDefault":true,"defaultDashboardId":"[UUID]","totalCharts":18,"averageChartsPerDashboard":5,"page":1,"pageSize":4},"duration":8,"slow":false,"component":"analytics","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.013Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":186,"function":"eval","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":9,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.013Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgnemznu_5m4vt0ak","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":230,"userId":"[UUID]","statusCode":200,"totalDuration":229,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
 GET /api/admin/analytics/dashboards?is_published=true&is_active=true 200 in 2202ms
{"@timestamp":"2025-10-12T07:50:39.033Z","level":"INFO","message":"GET /api/admin/analytics/dashboards - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":41,"function":"eval","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.034Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":42,"function":"eval","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"endpoint":"/api/admin/analytics/dashboards","requiredPermissions":["analytics:read:all"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.128Z","level":"INFO","message":"GET /api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":41,"function":"eval","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.128Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":42,"function":"eval","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","requiredPermissions":["analytics:read:all"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.126Z","level":"INFO","message":"Main database connections closed","service":"bendcare-os","env":"development","file":"index.ts","line":154,"function":"process.closeDb"}
{"@timestamp":"2025-10-12T07:50:39.133Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":100,"type":"api","identifier":"::1","current":7,"remaining":193,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.133Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":55,"function":"eval","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":99,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.133Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":100,"pathname":"/api/admin/analytics/dashboards","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.165Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":37,"type":"api","identifier":"::1","current":8,"remaining":192,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.165Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":55,"function":"eval","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":37,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.165Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":37,"pathname":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.167Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":134,"type":"api","identifier":"::1","current":9,"remaining":191,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.167Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":104,"function":"applyGlobalAuth","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":134,"pathname":"/api/admin/analytics/dashboards","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.167Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":134,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.199Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":71,"type":"api","identifier":"::1","current":10,"remaining":190,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.199Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":104,"function":"applyGlobalAuth","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":71,"pathname":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.200Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":72,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.235Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":202,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.236Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":126,"function":"applyGlobalAuth","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/dashboards","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":68,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.236Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":65,"function":"eval","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":103,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.236Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":68,"function":"eval","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":203,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.236Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":126,"function":"eval","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.236Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":148,"function":"eval","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":203,"userId":"[UUID]","roleCount":1,"permissionCount":89,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.236Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":164,"function":"eval","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:all"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.236Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":173,"function":"eval","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":203,"userId":"[UUID]","permissions":["analytics:read:all"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.236Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":180,"function":"eval","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":203,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
Query: select "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "users"."user_id", "users"."first_name", "users"."last_name", "users"."email", count("dashboard_charts"."chart_definition_id") from "dashboards" left join "chart_categories" on "dashboards"."dashboard_category_id" = "chart_categories"."chart_category_id" left join "users" on "dashboards"."created_by" = "users"."user_id" left join "dashboard_charts" on "dashboards"."dashboard_id" = "dashboard_charts"."dashboard_id" where ("dashboards"."is_active" = $1 and "dashboards"."is_published" = $2) group by "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "users"."user_id", "users"."first_name", "users"."last_name", "users"."email" order by "dashboards"."created_at" desc limit $3 -- params: [true, true, 1000000]
Query: select count(*) from "dashboards" where ("dashboards"."is_active" = $1 and "dashboards"."is_published" = $2) -- params: [true, true]
{"@timestamp":"2025-10-12T07:50:39.241Z","level":"INFO","message":"dashboards list query completed - returned 4 of 4","service":"bendcare-os","env":"development","file":"route.ts","line":63,"function":"getDashboardsHandler","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_dashboards","resourceType":"dashboards","userId":"[UUID]","filters":{"is_active":true,"is_published":true},"filterCount":2,"results":{"returned":4,"total":4,"published":4,"draft":0,"hasDefault":true,"defaultDashboardId":"[UUID]","totalCharts":18,"averageChartsPerDashboard":5,"page":1,"pageSize":4},"duration":5,"slow":false,"component":"analytics","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.241Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":186,"function":"eval","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":5,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-12T07:50:39.241Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgnen1d7_jwh6q74f","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":208,"userId":"[UUID]","statusCode":200,"totalDuration":208,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
 GET /api/admin/analytics/dashboards?is_published=true&is_active=true 200 in 223ms
{"@timestamp":"2025-10-12T07:50:39.271Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":143,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.271Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":126,"function":"applyGlobalAuth","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":71,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.271Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":65,"function":"eval","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":106,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.271Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":68,"function":"eval","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":143,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.271Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":126,"function":"eval","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.272Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":148,"function":"eval","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":144,"userId":"[UUID]","roleCount":1,"permissionCount":89,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.272Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":164,"function":"eval","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:all"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.272Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":173,"function":"eval","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":144,"userId":"[UUID]","permissions":["analytics:read:all"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.272Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":180,"function":"eval","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":144,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
Error: Route "/api/admin/analytics/dashboards/[dashboardId]" used `params.dashboardId`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at getDashboardHandler (app/api/admin/analytics/dashboards/[dashboardId]/route.ts:26:25)
    at eval (lib/api/rbac-route-handler.ts:236:32)
  24 |
  25 |   log.info('Dashboard get request initiated', {
> 26 |     dashboardId: params.dashboardId,
     |                         ^
  27 |     requestingUserId: userContext.user_id,
  28 |   });
  29 |
{"@timestamp":"2025-10-12T07:50:39.330Z","level":"INFO","message":"Dashboard get request initiated","service":"bendcare-os","env":"development","file":"route.ts","line":29,"function":"getDashboardHandler","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":202,"dashboardId":"[UUID]","requestingUserId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
Error: Route "/api/admin/analytics/dashboards/[dashboardId]" used `params.dashboardId`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at getDashboardHandler (app/api/admin/analytics/dashboards/[dashboardId]/route.ts:35:71)
    at eval (lib/api/rbac-route-handler.ts:236:32)
  33 |
  34 |     // Get dashboard with automatic permission checking
> 35 |     const dashboard = await dashboardsService.getDashboardById(params.dashboardId);
     |                                                                       ^
  36 |
  37 |     if (!dashboard) {
  38 |       return createErrorResponse('Dashboard not found', 404);
Query: select "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "dashboards" left join "chart_categories" on "dashboards"."dashboard_category_id" = "chart_categories"."chart_category_id" left join "users" on "dashboards"."created_by" = "users"."user_id" where "dashboards"."dashboard_id" = $1 limit $2 -- params: ["a0324818-ae41-4bf5-8291-447f30322faa", 1]
Query: select count(*) from "dashboard_charts" where "dashboard_charts"."dashboard_id" = $1 -- params: ["a0324818-ae41-4bf5-8291-447f30322faa"]
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "dashboard_charts"."position_config" from "dashboard_charts" inner join "chart_definitions" on "dashboard_charts"."chart_definition_id" = "chart_definitions"."chart_definition_id" where "dashboard_charts"."dashboard_id" = $1 order by "dashboard_charts"."added_at" -- params: ["a0324818-ae41-4bf5-8291-447f30322faa"]
{"@timestamp":"2025-10-12T07:50:39.373Z","level":"DEBUG","message":"DB: SELECT on dashboards","service":"bendcare-os","env":"development","file":"route.ts","line":41,"function":"getDashboardHandler","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","component":"database","operation":"SELECT","table":"dashboards","duration":101,"rowCount":1,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.373Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":186,"function":"eval","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":101,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.373Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgnemznu_0yxiqvm8","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":245,"userId":"[UUID]","statusCode":200,"totalDuration":245,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
 GET /api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa 200 in 2555ms
{"@timestamp":"2025-10-12T07:50:39.399Z","level":"INFO","message":"GET /api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":41,"function":"eval","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.399Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":42,"function":"eval","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","requiredPermissions":["analytics:read:all"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.433Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":34,"type":"api","identifier":"::1","current":11,"remaining":189,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.433Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":55,"function":"eval","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":34,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.433Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":34,"pathname":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.465Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":66,"type":"api","identifier":"::1","current":12,"remaining":188,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.466Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":104,"function":"applyGlobalAuth","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":67,"pathname":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.466Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":67,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.628Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":229,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.628Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":126,"function":"applyGlobalAuth","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":162,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.628Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":65,"function":"eval","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":195,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.628Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":68,"function":"eval","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":229,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.628Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":126,"function":"eval","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.628Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":148,"function":"eval","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":229,"userId":"[UUID]","roleCount":1,"permissionCount":89,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.629Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":164,"function":"eval","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"userId":"[UUID]","permissions":["analytics:read:all"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.629Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":173,"function":"eval","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":230,"userId":"[UUID]","permissions":["analytics:read:all"],"rbacDuration":1,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.629Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":180,"function":"eval","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":230,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
Error: Route "/api/admin/analytics/dashboards/[dashboardId]" used `params.dashboardId`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at getDashboardHandler (app/api/admin/analytics/dashboards/[dashboardId]/route.ts:26:25)
    at eval (lib/api/rbac-route-handler.ts:236:32)
  24 |
  25 |   log.info('Dashboard get request initiated', {
> 26 |     dashboardId: params.dashboardId,
     |                         ^
  27 |     requestingUserId: userContext.user_id,
  28 |   });
  29 |
{"@timestamp":"2025-10-12T07:50:39.664Z","level":"INFO","message":"Dashboard get request initiated","service":"bendcare-os","env":"development","file":"route.ts","line":29,"function":"getDashboardHandler","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":265,"dashboardId":"[UUID]","requestingUserId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
Error: Route "/api/admin/analytics/dashboards/[dashboardId]" used `params.dashboardId`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at getDashboardHandler (app/api/admin/analytics/dashboards/[dashboardId]/route.ts:35:71)
    at eval (lib/api/rbac-route-handler.ts:236:32)
  33 |
  34 |     // Get dashboard with automatic permission checking
> 35 |     const dashboard = await dashboardsService.getDashboardById(params.dashboardId);
     |                                                                       ^
  36 |
  37 |     if (!dashboard) {
  38 |       return createErrorResponse('Dashboard not found', 404);
Query: select "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "dashboards" left join "chart_categories" on "dashboards"."dashboard_category_id" = "chart_categories"."chart_category_id" left join "users" on "dashboards"."created_by" = "users"."user_id" where "dashboards"."dashboard_id" = $1 limit $2 -- params: ["a0324818-ae41-4bf5-8291-447f30322faa", 1]
Query: select count(*) from "dashboard_charts" where "dashboard_charts"."dashboard_id" = $1 -- params: ["a0324818-ae41-4bf5-8291-447f30322faa"]
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "dashboard_charts"."position_config" from "dashboard_charts" inner join "chart_definitions" on "dashboard_charts"."chart_definition_id" = "chart_definitions"."chart_definition_id" where "dashboard_charts"."dashboard_id" = $1 order by "dashboard_charts"."added_at" -- params: ["a0324818-ae41-4bf5-8291-447f30322faa"]
{"@timestamp":"2025-10-12T07:50:39.737Z","level":"DEBUG","message":"DB: SELECT on dashboards","service":"bendcare-os","env":"development","file":"route.ts","line":41,"function":"getDashboardHandler","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","component":"database","operation":"SELECT","table":"dashboards","duration":108,"rowCount":1,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.737Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":186,"function":"eval","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":108,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
{"@timestamp":"2025-10-12T07:50:39.737Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgnen1n7_hx377hjl","method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":338,"userId":"[UUID]","statusCode":200,"totalDuration":338,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa"}}
 GET /api/admin/analytics/dashboards/a0324818-ae41-4bf5-8291-447f30322faa 200 in 357ms
{"@timestamp":"2025-10-12T07:50:39.754Z","level":"INFO","message":"Main database connections closed","service":"bendcare-os","env":"development","file":"index.ts","line":154,"function":"process.closeDb"}
 ‚úì Compiled /api/admin/analytics/charts in 393ms (2602 modules)
{"@timestamp":"2025-10-12T07:50:39.948Z","level":"INFO","message":"GET /api/admin/analytics/charts - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":41,"function":"eval","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:39.948Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":42,"function":"eval","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"endpoint":"/api/admin/analytics/charts","requiredPermissions":["analytics:read:all"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:39.982Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":35,"type":"api","identifier":"::1","current":13,"remaining":187,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:39.982Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":55,"function":"eval","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":34,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:39.982Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":35,"pathname":"/api/admin/analytics/charts","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.015Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":68,"type":"api","identifier":"::1","current":14,"remaining":186,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.015Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":104,"function":"applyGlobalAuth","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":68,"pathname":"/api/admin/analytics/charts","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.015Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":68,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.185Z","level":"DEBUG","message":"Loading user context","service":"bendcare-os","env":"development","file":"user-context.ts","line":304,"function":"getUserContextSafe","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":238,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
Query: select "user_id", "email", "first_name", "last_name", "is_active", "email_verified", "created_at", "updated_at" from "users" where "users"."user_id" = $1 limit $2 -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", 1]
Query: select "user_organizations"."user_organization_id", "user_organizations"."user_id", "user_organizations"."organization_id", "user_organizations"."is_active", "user_organizations"."joined_at", "user_organizations"."created_at", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at" from "user_organizations" inner join "organizations" on "user_organizations"."organization_id" = "organizations"."organization_id" where ("user_organizations"."user_id" = $1 and "user_organizations"."is_active" = $2 and "organizations"."is_active" = $3) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true]
Query: select distinct "user_roles"."user_role_id", "user_roles"."user_id", "user_roles"."role_id", "user_roles"."organization_id", "user_roles"."granted_by", "user_roles"."granted_at", "user_roles"."expires_at", "user_roles"."is_active", "user_roles"."created_at", "roles"."name", "roles"."description", "roles"."organization_id", "roles"."is_system_role", "roles"."is_active", "roles"."created_at", "roles"."updated_at", "roles"."deleted_at", "permissions"."permission_id", "permissions"."name", "permissions"."description", "permissions"."resource", "permissions"."action", "permissions"."scope", "permissions"."is_active", "permissions"."created_at", "permissions"."updated_at" from "user_roles" inner join "roles" on "user_roles"."role_id" = "roles"."role_id" inner join "role_permissions" on "roles"."role_id" = "role_permissions"."role_id" inner join "permissions" on "role_permissions"."permission_id" = "permissions"."permission_id" where ("user_roles"."user_id" = $1 and "user_roles"."is_active" = $2 and "roles"."is_active" = $3 and "permissions"."is_active" = $4) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true, true]
{"@timestamp":"2025-10-12T07:50:40.217Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"user-context.ts","line":314,"function":"eval","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":270,"userId":"[UUID]","rolesCount":1,"permissionsCount":89,"organizationsCount":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.218Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":126,"function":"applyGlobalAuth","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/charts","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":203,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.218Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":65,"function":"eval","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":236,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.219Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":68,"function":"eval","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":272,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.219Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":126,"function":"eval","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.219Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":148,"function":"eval","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":272,"userId":"[UUID]","roleCount":1,"permissionCount":89,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.224Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":164,"function":"eval","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":4,"userId":"[UUID]","permissions":["analytics:read:all"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.224Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":173,"function":"eval","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":277,"userId":"[UUID]","permissions":["analytics:read:all"],"rbacDuration":4,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.225Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":180,"function":"eval","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":278,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "chart_definitions"."data_source", "chart_definitions"."chart_config", "chart_definitions"."access_control", "chart_definitions"."data_source_id", "chart_definitions"."chart_category_id", "chart_definitions"."created_by", "chart_definitions"."created_at", "chart_definitions"."updated_at", "chart_definitions"."is_active", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "chart_definitions" left join "chart_categories" on "chart_definitions"."chart_category_id" = "chart_categories"."chart_category_id" left join "users" on "chart_definitions"."created_by" = "users"."user_id" where "chart_definitions"."is_active" = $1 order by "chart_definitions"."created_at" desc limit $2 -- params: [true, 1000000]
Query: select count(*) from "chart_definitions" where "chart_definitions"."is_active" = $1 -- params: [true]
{"@timestamp":"2025-10-12T07:50:40.237Z","level":"INFO","message":"charts list query completed - returned 12 of 12","service":"bendcare-os","env":"development","file":"route.ts","line":50,"function":"getChartsHandler","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_charts","resourceType":"chart_definitions","userId":"[UUID]","filters":{"is_active":true},"filterCount":1,"results":{"returned":12,"total":12,"chartTypeBreakdown":{"number":2,"dual-axis":2,"progress-bar":1,"table":1,"horizontal-bar":1,"bar":4,"stacked-bar":1},"activeCount":12,"inactiveCount":0},"duration":12,"slow":false,"component":"analytics","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.239Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":186,"function":"eval","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":14,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.240Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgnen1nn_a9f6xu9y","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":293,"userId":"[UUID]","statusCode":200,"totalDuration":292,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
 GET /api/admin/analytics/charts?is_active=true 200 in 845ms
{"@timestamp":"2025-10-12T07:50:40.283Z","level":"INFO","message":"GET /api/admin/analytics/charts - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":41,"function":"eval","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.283Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":42,"function":"eval","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"endpoint":"/api/admin/analytics/charts","requiredPermissions":["analytics:read:all"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.319Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":37,"type":"api","identifier":"::1","current":15,"remaining":185,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.319Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":55,"function":"eval","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":36,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.319Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":37,"pathname":"/api/admin/analytics/charts","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.356Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":74,"type":"api","identifier":"::1","current":16,"remaining":184,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.357Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":104,"function":"applyGlobalAuth","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":75,"pathname":"/api/admin/analytics/charts","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.357Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":75,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.438Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":156,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.438Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":126,"function":"applyGlobalAuth","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/charts","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":81,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.438Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":65,"function":"eval","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":119,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.438Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":68,"function":"eval","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":156,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.438Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":126,"function":"eval","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.438Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":148,"function":"eval","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":156,"userId":"[UUID]","roleCount":1,"permissionCount":89,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.438Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":164,"function":"eval","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:all"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.438Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":173,"function":"eval","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":156,"userId":"[UUID]","permissions":["analytics:read:all"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.438Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":180,"function":"eval","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":156,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "chart_definitions"."data_source", "chart_definitions"."chart_config", "chart_definitions"."access_control", "chart_definitions"."data_source_id", "chart_definitions"."chart_category_id", "chart_definitions"."created_by", "chart_definitions"."created_at", "chart_definitions"."updated_at", "chart_definitions"."is_active", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "chart_definitions" left join "chart_categories" on "chart_definitions"."chart_category_id" = "chart_categories"."chart_category_id" left join "users" on "chart_definitions"."created_by" = "users"."user_id" where "chart_definitions"."is_active" = $1 order by "chart_definitions"."created_at" desc limit $2 -- params: [true, 1000000]
Query: select count(*) from "chart_definitions" where "chart_definitions"."is_active" = $1 -- params: [true]
{"@timestamp":"2025-10-12T07:50:40.484Z","level":"INFO","message":"charts list query completed - returned 12 of 12","service":"bendcare-os","env":"development","file":"route.ts","line":50,"function":"getChartsHandler","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_charts","resourceType":"chart_definitions","userId":"[UUID]","filters":{"is_active":true},"filterCount":1,"results":{"returned":12,"total":12,"chartTypeBreakdown":{"number":2,"dual-axis":2,"progress-bar":1,"table":1,"horizontal-bar":1,"bar":4,"stacked-bar":1},"activeCount":12,"inactiveCount":0},"duration":46,"slow":false,"component":"analytics","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.484Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":186,"function":"eval","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":46,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-12T07:50:40.484Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgnen2bj_mmub71wi","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":202,"userId":"[UUID]","statusCode":200,"totalDuration":202,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
 GET /api/admin/analytics/charts?is_active=true 200 in 228ms
 ‚úì Compiled /api/admin/analytics/chart-data in 411ms (2615 modules)
{"@timestamp":"2025-10-12T07:50:40.838Z","level":"INFO","message":"POST /api/admin/analytics/chart-data - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":41,"function":"eval","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.839Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":42,"function":"eval","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"endpoint":"/api/admin/analytics/chart-data","requiredPermissions":["analytics:read:organization","analytics:read:all"],"requireAllPermissions":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.839Z","level":"INFO","message":"POST /api/admin/analytics/chart-data - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":41,"function":"eval","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.839Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":42,"function":"eval","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/admin/analytics/chart-data","requiredPermissions":["analytics:read:organization","analytics:read:all"],"requireAllPermissions":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.873Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":35,"type":"api","identifier":"::1","current":17,"remaining":183,"limit":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.873Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":55,"function":"eval","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":34,"limitType":"api","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.873Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":35,"pathname":"/api/admin/analytics/chart-data","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.873Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":34,"type":"api","identifier":"::1","current":18,"remaining":182,"limit":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.873Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":55,"function":"eval","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":34,"limitType":"api","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.873Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":34,"pathname":"/api/admin/analytics/chart-data","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.904Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":66,"type":"api","identifier":"::1","current":19,"remaining":181,"limit":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.904Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":104,"function":"applyGlobalAuth","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":66,"pathname":"/api/admin/analytics/chart-data","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.904Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":66,"component":"auth","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.907Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":68,"type":"api","identifier":"::1","current":20,"remaining":180,"limit":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.907Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":104,"function":"applyGlobalAuth","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":68,"pathname":"/api/admin/analytics/chart-data","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.907Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":68,"component":"auth","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.974Z","level":"DEBUG","message":"Loading user context","service":"bendcare-os","env":"development","file":"user-context.ts","line":304,"function":"getUserContextSafe","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":136,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
Query: select "user_id", "email", "first_name", "last_name", "is_active", "email_verified", "created_at", "updated_at" from "users" where "users"."user_id" = $1 limit $2 -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", 1]
Query: select "user_organizations"."user_organization_id", "user_organizations"."user_id", "user_organizations"."organization_id", "user_organizations"."is_active", "user_organizations"."joined_at", "user_organizations"."created_at", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at" from "user_organizations" inner join "organizations" on "user_organizations"."organization_id" = "organizations"."organization_id" where ("user_organizations"."user_id" = $1 and "user_organizations"."is_active" = $2 and "organizations"."is_active" = $3) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true]
Query: select distinct "user_roles"."user_role_id", "user_roles"."user_id", "user_roles"."role_id", "user_roles"."organization_id", "user_roles"."granted_by", "user_roles"."granted_at", "user_roles"."expires_at", "user_roles"."is_active", "user_roles"."created_at", "roles"."name", "roles"."description", "roles"."organization_id", "roles"."is_system_role", "roles"."is_active", "roles"."created_at", "roles"."updated_at", "roles"."deleted_at", "permissions"."permission_id", "permissions"."name", "permissions"."description", "permissions"."resource", "permissions"."action", "permissions"."scope", "permissions"."is_active", "permissions"."created_at", "permissions"."updated_at" from "user_roles" inner join "roles" on "user_roles"."role_id" = "roles"."role_id" inner join "role_permissions" on "roles"."role_id" = "role_permissions"."role_id" inner join "permissions" on "role_permissions"."permission_id" = "permissions"."permission_id" where ("user_roles"."user_id" = $1 and "user_roles"."is_active" = $2 and "roles"."is_active" = $3 and "permissions"."is_active" = $4) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true, true]
{"@timestamp":"2025-10-12T07:50:40.983Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"user-context.ts","line":314,"function":"eval","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":145,"userId":"[UUID]","rolesCount":1,"permissionsCount":89,"organizationsCount":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.983Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":144,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.983Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":126,"function":"applyGlobalAuth","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/chart-data","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":79,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.983Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":126,"function":"applyGlobalAuth","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/chart-data","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":76,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.984Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":65,"function":"eval","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":110,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.984Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":68,"function":"eval","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":146,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.984Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":126,"function":"eval","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.984Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":148,"function":"eval","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":146,"userId":"[UUID]","roleCount":1,"permissionCount":89,"isSuperAdmin":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.984Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":65,"function":"eval","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":111,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.984Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":68,"function":"eval","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":145,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.984Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":126,"function":"eval","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.984Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":148,"function":"eval","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":145,"userId":"[UUID]","roleCount":1,"permissionCount":89,"isSuperAdmin":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.984Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":164,"function":"eval","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:organization","analytics:read:all"],"requireAll":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.984Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":173,"function":"eval","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":146,"userId":"[UUID]","permissions":["analytics:read:organization","analytics:read:all"],"rbacDuration":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.984Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":180,"function":"eval","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":146,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.985Z","level":"INFO","message":"Transform chart data request initiated","service":"bendcare-os","env":"development","file":"route.ts","line":40,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":147,"requestingUserId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.985Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":164,"function":"eval","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"userId":"[UUID]","permissions":["analytics:read:organization","analytics:read:all"],"requireAll":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.985Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":173,"function":"eval","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":146,"userId":"[UUID]","permissions":["analytics:read:organization","analytics:read:all"],"rbacDuration":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.985Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":180,"function":"eval","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":146,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.985Z","level":"INFO","message":"Transform chart data request initiated","service":"bendcare-os","env":"development","file":"route.ts","line":40,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":146,"requestingUserId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.986Z","level":"INFO","message":"Chart data request received","service":"bendcare-os","env":"development","file":"route.ts","line":47,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":148,"requestingUserId":"[UUID]","chartType":"bar","hasMultipleSeries":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.986Z","level":"INFO","message":"Chart data request received","service":"bendcare-os","env":"development","file":"route.ts","line":47,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":147,"requestingUserId":"[UUID]","chartType":"bar","hasMultipleSeries":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.987Z","level":"INFO","message":"Chart data request validated","service":"bendcare-os","env":"development","file":"route.ts","line":54,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":149,"requestingUserId":"[UUID]","chartType":"bar","hasDataSourceId":true,"hasMultipleSeries":true,"hasPeriodComparison":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.987Z","level":"INFO","message":"Fetching measures from analytics database","service":"bendcare-os","env":"development","file":"route.ts","line":111,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":149,"requestingUserId":"[UUID]","queryParams":{"frequency":"Monthly","hasFilters":false,"hasMultipleSeries":true},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.988Z","level":"INFO","message":"Building efficient multiple series analytics query","service":"bendcare-os","env":"development","file":"analytics-query-builder.ts","line":527,"function":"AnalyticsQueryBuilder.queryMultipleSeries","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":150,"seriesCount":2,"measures":["Charges by Provider","Payments by Provider"],"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.988Z","level":"INFO","message":"Chart data request validated","service":"bendcare-os","env":"development","file":"route.ts","line":54,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":149,"requestingUserId":"[UUID]","chartType":"bar","hasDataSourceId":true,"hasMultipleSeries":true,"hasPeriodComparison":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.988Z","level":"INFO","message":"Fetching measures from analytics database","service":"bendcare-os","env":"development","file":"route.ts","line":111,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":149,"requestingUserId":"[UUID]","queryParams":{"frequency":"Monthly","hasFilters":false,"hasMultipleSeries":true},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:40.988Z","level":"INFO","message":"Building efficient multiple series analytics query","service":"bendcare-os","env":"development","file":"analytics-query-builder.ts","line":527,"function":"AnalyticsQueryBuilder.queryMultipleSeries","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":149,"seriesCount":2,"measures":["Charges by Provider","Payments by Provider"],"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:41.032Z","level":"DEBUG","message":"Data source config cache hit","service":"bendcare-os","env":"development","file":"chart-config-cache.ts","line":50,"function":"ChartConfigCacheService.getDataSourceConfig","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":194,"component":"chart-config-cache","dataSourceId":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
üîç EXECUTING SQL: {
  sql: '\n' +
    '      SELECT practice, practice_primary, practice_uid, provider_name, measure, frequency as frequency, date_index as date_index, measure_value as measure_value, measure_type as measure_type\n' +
    '      FROM ih.agg_app_measures\n' +
    '      WHERE measure = ANY($1) AND frequency = $2 AND date_index >= $3 AND date_index <= $4\n' +
    '      ORDER BY measure, date_index ASC\n' +
    '    ',
  parameters: [
    [ 'Charges by Provider', 'Payments by Provider' ],
    'Monthly',
    '2025-01-01',
    '2025-09-18'
  ],
  paramCount: 4
}
{"@timestamp":"2025-10-12T07:50:41.043Z","level":"DEBUG","message":"Data source config cache hit","service":"bendcare-os","env":"development","file":"chart-config-cache.ts","line":50,"function":"ChartConfigCacheService.getDataSourceConfig","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":204,"component":"chart-config-cache","dataSourceId":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
üîç EXECUTING SQL: {
  sql: '\n' +
    '      SELECT practice, practice_primary, practice_uid, provider_name, measure, frequency as frequency, date_index as date_index, measure_value as measure_value, measure_type as measure_type\n' +
    '      FROM ih.agg_app_measures\n' +
    '      WHERE measure = ANY($1) AND frequency = $2 AND date_index >= $3 AND date_index <= $4\n' +
    '      ORDER BY measure, date_index ASC\n' +
    '    ',
  parameters: [
    [ 'Charges by Provider', 'Payments by Provider' ],
    'Monthly',
    '2025-01-01',
    '2025-09-18'
  ],
  paramCount: 4
}
‚úÖ QUERY RESULT: {
  duration: '863ms',
  rowCount: 3081,
  sampleData: {
    practice: 'Sierra Pacific Arth Rheumatology Centers',
    practice_primary: 'Watrous, Daniel',
    practice_uid: 56,
    provider_name: 'Scott, Frank',
    measure: 'Charges by Provider',
    frequency: 'Monthly',
    date_index: '2025-02-28',
    measure_value: '269485',
    measure_type: 'currency'
  }
}
üîç EXECUTING SQL: {
  sql: '\n' +
    '      SELECT COUNT(*) as count\n' +
    '      FROM ih.agg_app_measures\n' +
    '      WHERE measure = ANY($1) AND frequency = $2 AND date_index >= $3 AND date_index <= $4\n' +
    '    ',
  parameters: [
    [ 'Charges by Provider', 'Payments by Provider' ],
    'Monthly',
    '2025-01-01',
    '2025-09-18'
  ],
  paramCount: 4
}
‚úÖ QUERY RESULT: {
  duration: '871ms',
  rowCount: 3081,
  sampleData: {
    practice: 'Sierra Pacific Arth Rheumatology Centers',
    practice_primary: 'Watrous, Daniel',
    practice_uid: 56,
    provider_name: 'Scott, Frank',
    measure: 'Charges by Provider',
    frequency: 'Monthly',
    date_index: '2025-02-28',
    measure_value: '269485',
    measure_type: 'currency'
  }
}
üîç EXECUTING SQL: {
  sql: '\n' +
    '      SELECT COUNT(*) as count\n' +
    '      FROM ih.agg_app_measures\n' +
    '      WHERE measure = ANY($1) AND frequency = $2 AND date_index >= $3 AND date_index <= $4\n' +
    '    ',
  parameters: [
    [ 'Charges by Provider', 'Payments by Provider' ],
    'Monthly',
    '2025-01-01',
    '2025-09-18'
  ],
  paramCount: 4
}
‚úÖ QUERY RESULT: { duration: '71ms', rowCount: 1, sampleData: { count: '3081' } }
{"@timestamp":"2025-10-12T07:50:41.981Z","level":"INFO","message":"Efficient multiple series query completed","service":"bendcare-os","env":"development","file":"analytics-query-builder.ts","line":657,"function":"AnalyticsQueryBuilder.queryMultipleSeries","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1142,"seriesCount":2,"totalRecords":3081,"queryTime":993,"userId":"[UUID]","measuresQueried":["Charges by Provider","Payments by Provider"],"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:41.982Z","level":"INFO","message":"Measures fetched successfully","service":"bendcare-os","env":"development","file":"route.ts","line":123,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1143,"requestingUserId":"[UUID]","measureCount":3081,"queryTimeMs":993,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
‚úÖ QUERY RESULT: { duration: '71ms', rowCount: 1, sampleData: { count: '3081' } }
{"@timestamp":"2025-10-12T07:50:41.983Z","level":"INFO","message":"Efficient multiple series query completed","service":"bendcare-os","env":"development","file":"analytics-query-builder.ts","line":657,"function":"AnalyticsQueryBuilder.queryMultipleSeries","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1145,"seriesCount":2,"totalRecords":3081,"queryTime":995,"userId":"[UUID]","measuresQueried":["Charges by Provider","Payments by Provider"],"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:41.984Z","level":"INFO","message":"Measures fetched successfully","service":"bendcare-os","env":"development","file":"route.ts","line":123,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1146,"requestingUserId":"[UUID]","measureCount":3081,"queryTimeMs":995,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:42.018Z","level":"DEBUG","message":"Column metadata cache hit","service":"bendcare-os","env":"development","file":"chart-metadata-loader.server.ts","line":32,"function":"loadColumnMetadata","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1179,"dataSourceId":1,"columnCount":9,"component":"chart-metadata-loader","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:42.019Z","level":"INFO","message":"Column metadata loaded","service":"bendcare-os","env":"development","file":"route.ts","line":143,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1180,"requestingUserId":"[UUID]","dataSourceId":1,"columnCount":9,"hasMetadata":true,"groupByColumn":{"id":4,"columnName":"provider_name","displayName":"Provider Name","description":"Provider name","dataType":"string","isFilterable":true,"isGroupable":true,"isMeasure":false,"isDimension":true,"isDateField":false,"formatType":"string","sortOrder":4,"exampleValue":"Busch, Howard"},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:42.025Z","level":"INFO","message":"Transformation parameters","service":"bendcare-os","env":"development","file":"route.ts","line":169,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1186,"requestingUserId":"[UUID]","transformChartType":"bar","groupBy":"provider_name","totalMeasures":3081,"sampleMeasures":[{"provider_name":"Scott, Frank","measure_value":"269485"},{"provider_name":"Kades, Wagdy","measure_value":"594023"},{"provider_name":"Kinter, Christopher","measure_value":"71482"},{"provider_name":"Guigui, Muriel","measure_value":"61605"},{"provider_name":"Munoz, George","measure_value":"1248655"}],"uniqueGroupValuesCount":309,"uniqueGroupValuesSample":["Scott, Frank","Kades, Wagdy","Kinter, Christopher","Guigui, Muriel","Munoz, George","Khorran, Kavita","Carter, Mary","Soto-Aguilar, Maria","Kanagasegar, Sivalingam","White, Robyn"],"hasNullValues":0,"hasUndefinedValues":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:42.043Z","level":"INFO","message":"Chart data transformed successfully","service":"bendcare-os","env":"development","file":"route.ts","line":201,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","requestingUserId":"[UUID]","duration":1057,"chartType":"bar","measureCount":3081,"datasetCount":2,"labelCount":6,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:42.050Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":186,"function":"eval","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1065,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:42.050Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgnen2c6_7wwcencc","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1211,"userId":"[UUID]","statusCode":200,"totalDuration":1211,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:42.051Z","level":"DEBUG","message":"Column metadata cache hit","service":"bendcare-os","env":"development","file":"chart-metadata-loader.server.ts","line":32,"function":"loadColumnMetadata","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1213,"dataSourceId":1,"columnCount":9,"component":"chart-metadata-loader","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:42.052Z","level":"INFO","message":"Column metadata loaded","service":"bendcare-os","env":"development","file":"route.ts","line":143,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1214,"requestingUserId":"[UUID]","dataSourceId":1,"columnCount":9,"hasMetadata":true,"groupByColumn":{"id":4,"columnName":"provider_name","displayName":"Provider Name","description":"Provider name","dataType":"string","isFilterable":true,"isGroupable":true,"isMeasure":false,"isDimension":true,"isDateField":false,"formatType":"string","sortOrder":4,"exampleValue":"Busch, Howard"},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:42.052Z","level":"INFO","message":"Transformation parameters","service":"bendcare-os","env":"development","file":"route.ts","line":169,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1214,"requestingUserId":"[UUID]","transformChartType":"bar","groupBy":"provider_name","totalMeasures":3081,"sampleMeasures":[{"provider_name":"Scott, Frank","measure_value":"269485"},{"provider_name":"Kades, Wagdy","measure_value":"594023"},{"provider_name":"Kinter, Christopher","measure_value":"71482"},{"provider_name":"Guigui, Muriel","measure_value":"61605"},{"provider_name":"Munoz, George","measure_value":"1248655"}],"uniqueGroupValuesCount":309,"uniqueGroupValuesSample":["Scott, Frank","Kades, Wagdy","Kinter, Christopher","Guigui, Muriel","Munoz, George","Khorran, Kavita","Carter, Mary","Soto-Aguilar, Maria","Kanagasegar, Sivalingam","White, Robyn"],"hasNullValues":0,"hasUndefinedValues":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:42.054Z","level":"INFO","message":"Chart data transformed successfully","service":"bendcare-os","env":"development","file":"route.ts","line":201,"function":"transformChartDataHandler","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","requestingUserId":"[UUID]","duration":1068,"chartType":"bar","measureCount":3081,"datasetCount":2,"labelCount":6,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:42.057Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":186,"function":"eval","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1073,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
{"@timestamp":"2025-10-12T07:50:42.058Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgnen2c6_ve1hgw6a","method":"POST","path":"/api/admin/analytics/chart-data","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1220,"userId":"[UUID]","statusCode":200,"totalDuration":1219,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/chart-data"}}
 POST /api/admin/analytics/chart-data 200 in 1776ms
 POST /api/admin/analytics/chart-data 200 in 1776ms
 ‚úì Compiled in 165ms (995 modules)
üåê MIDDLEWARE: Processing request for: /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa
üåê MIDDLEWARE: Protected route detected
üåê MIDDLEWARE: Checking auth - access token: true, refresh token: true
üåê MIDDLEWARE: Access token valid - allowing access
üåê MIDDLEWARE: User authenticated (or has refresh token) - allowing request to proceed
 GET /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa 200 in 73ms
 ‚úì Compiled in 157ms (995 modules)
üåê MIDDLEWARE: Processing request for: /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa
üåê MIDDLEWARE: Protected route detected
üåê MIDDLEWARE: Checking auth - access token: true, refresh token: true
üåê MIDDLEWARE: Access token valid - allowing access
üåê MIDDLEWARE: User authenticated (or has refresh token) - allowing request to proceed
 GET /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa 200 in 57ms
 ‚úì Compiled in 279ms (995 modules)
üåê MIDDLEWARE: Processing request for: /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa
üåê MIDDLEWARE: Protected route detected
üåê MIDDLEWARE: Checking auth - access token: true, refresh token: true
üåê MIDDLEWARE: Access token valid - allowing access
üåê MIDDLEWARE: User authenticated (or has refresh token) - allowing request to proceed
 GET /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa 200 in 26ms
 ‚úì Compiled in 162ms (995 modules)
üåê MIDDLEWARE: Processing request for: /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa
üåê MIDDLEWARE: Protected route detected
üåê MIDDLEWARE: Checking auth - access token: true, refresh token: true
üåê MIDDLEWARE: Access token valid - allowing access
üåê MIDDLEWARE: User authenticated (or has refresh token) - allowing request to proceed
 GET /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa 200 in 26ms
 ‚úì Compiled in 185ms (995 modules)
üåê MIDDLEWARE: Processing request for: /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa
üåê MIDDLEWARE: Protected route detected
üåê MIDDLEWARE: Checking auth - access token: true, refresh token: true
üåê MIDDLEWARE: Access token valid - allowing access
üåê MIDDLEWARE: User authenticated (or has refresh token) - allowing request to proceed
 GET /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa 200 in 87ms
 ‚úì Compiled in 174ms (995 modules)
üåê MIDDLEWARE: Processing request for: /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa
üåê MIDDLEWARE: Protected route detected
üåê MIDDLEWARE: Checking auth - access token: true, refresh token: true
üåê MIDDLEWARE: Access token valid - allowing access
üåê MIDDLEWARE: User authenticated (or has refresh token) - allowing request to proceed
 GET /dashboard/view/a0324818-ae41-4bf5-8291-447f30322faa 200 in 31ms