Last login: Wed Oct 15 13:33:06 on ttys006
pstewart@Patricks-MacBook-Pro-2 ~ % cd bcos 
pstewart@Patricks-MacBook-Pro-2 bcos % ./dev.sh restart
================================
  BCOS Development Helper
================================
[INFO] Restarting BCOS application...
[INFO] Killing processes on port 4001...
[INFO] Killed processes: 19555
[INFO] Starting fresh development server...
[INFO] Starting development server on port 4001...

> bendcare-os@0.1.0 dev /Users/pstewart/bcos
> next dev -p ${PORT:-4001}

   ‚ñ≤ Next.js 15.5.3
   - Local:        http://localhost:4001
   - Network:      http://192.168.4.53:4001
   - Environments: .env.local, .env
   - Experiments (use with caution):
     ¬∑ optimizePackageImports

 ‚úì Starting...
 ‚úì Ready in 1859ms
 ‚úì Compiled /middleware in 325ms (407 modules)
üåê MIDDLEWARE: Processing request for: /dashboard/view/e118a803-c656-4caa-a1d1-bd501c6d3e47
üåê MIDDLEWARE: Protected route detected
üåê MIDDLEWARE: Checking auth - access token: true, refresh token: true
üåê MIDDLEWARE: Access token valid - allowing access
üåê MIDDLEWARE: User authenticated (or has refresh token) - allowing request to proceed
 ‚óã Compiling /dashboard/view/[dashboardId] ...
 ‚úì Compiled /dashboard/view/[dashboardId] in 2.4s (2220 modules)
 GET /dashboard/view/e118a803-c656-4caa-a1d1-bd501c6d3e47?datePreset=this_year&org=d9e5bd24-b104-4ff5-a219-678eedb31aaa 200 in 3584ms
 ‚óã Compiling /api/admin/analytics/dashboards/[dashboardId] ...
 ‚úì Compiled /api/admin/analytics/dashboards/[dashboardId] in 2.2s (2673 modules)
{"@timestamp":"2025-10-15T17:43:30.820Z","level":"INFO","message":"Connecting to Redis","service":"bendcare-os","env":"development","file":"redis.ts","line":78,"function":"RedisClientManager.connect","component":"redis","host":"bcos-redis-dev-rt5vbv.serverless.use1.cache.amazonaws.com","port":6379,"username":"[REDACTED]","keyPrefix":"[REDACTED]","tls":true}
{"@timestamp":"2025-10-15T17:43:30.872Z","level":"INFO","message":"GET /api/admin/analytics/dashboards - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:30.872Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/admin/analytics/dashboards","requiredPermissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
üåê MIDDLEWARE: Processing request for: /dashboard/view/e118a803-c656-4caa-a1d1-bd501c6d3e47
üåê MIDDLEWARE: Protected route detected
üåê MIDDLEWARE: Checking auth - access token: true, refresh token: true
üåê MIDDLEWARE: Access token valid - allowing access
üåê MIDDLEWARE: User authenticated (or has refresh token) - allowing request to proceed
 GET /dashboard/view/e118a803-c656-4caa-a1d1-bd501c6d3e47?datePreset=this_year&org=d9e5bd24-b104-4ff5-a219-678eedb31aaa 200 in 90ms
{"@timestamp":"2025-10-15T17:43:31.009Z","level":"INFO","message":"Redis connected successfully","service":"bendcare-os","env":"development","file":"redis.ts","line":109,"function":"EventEmitter.eval","component":"redis","host":"[REDACTED]","port":6379}
{"@timestamp":"2025-10-15T17:43:31.047Z","level":"INFO","message":"Redis ready for commands","service":"bendcare-os","env":"development","file":"redis.ts","line":119,"function":"EventEmitter.eval","component":"redis"}
{"@timestamp":"2025-10-15T17:43:31.084Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":212,"type":"api","identifier":"::1","current":2,"remaining":198,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.084Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":211,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.085Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":213,"pathname":"/api/admin/analytics/dashboards","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.115Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","type":"api","identifier":"::1","current":1,"remaining":199,"limit":200}
{"@timestamp":"2025-10-15T17:43:31.116Z","level":"INFO","message":"JWT authentication middleware initiated","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":100,"function":"requireJWTAuth","url":"http://localhost:4001/api/auth/me","method":"GET","hasAuthHeader":false,"hasCookieHeader":"[REDACTED]"}
üîê AUTH: Using access token from httpOnly cookie
{"@timestamp":"2025-10-15T17:43:31.117Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":245,"type":"api","identifier":"::1","current":3,"remaining":197,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.117Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":245,"pathname":"/api/admin/analytics/dashboards","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.117Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":245,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
Query: select "jti", "user_id", "token_type", "blacklisted_at", "expires_at", "reason", "blacklisted_by", "ip_address", "user_agent" from "token_blacklist" where "token_blacklist"."jti" = $1 limit $2 -- params: ["K-wCQmG2Rrs46DvStvVb9", 1]
Query: select "jti", "user_id", "token_type", "blacklisted_at", "expires_at", "reason", "blacklisted_by", "ip_address", "user_agent" from "token_blacklist" where "token_blacklist"."jti" = $1 limit $2 -- params: ["K-wCQmG2Rrs46DvStvVb9", 1]
{"@timestamp":"2025-10-15T17:43:31.171Z","level":"INFO","message":"Auth: jwt_validation","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":153,"function":"requireJWTAuth","component":"auth","action":"jwt_validation","success":true,"userId":"[UUID]","sessionId":"qEOcjMnIWE5Db5eTz8M7X8k6IywULeuQ","tokenSource":"[REDACTED]","validationDuration":55}
üîê AUTH: JWT cache miss, falling back to database query
Query: select "user_id", "email", "first_name", "last_name", "password_hash", "email_verified", "is_active", "created_at", "updated_at", "deleted_at" from "users" where "users"."user_id" = $1 limit $2 -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", 1]
Query: select "user_id", "email", "first_name", "last_name", "is_active", "email_verified", "provider_uid", "created_at", "updated_at" from "users" where "users"."user_id" = $1 limit $2 -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", 1]
{"@timestamp":"2025-10-15T17:43:31.207Z","level":"DEBUG","message":"Loading user context","service":"bendcare-os","env":"development","file":"user-context.ts","line":304,"function":"getUserContextSafe","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":335,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
Query: select "user_id", "email", "first_name", "last_name", "is_active", "email_verified", "created_at", "updated_at" from "users" where "users"."user_id" = $1 limit $2 -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", 1]
Query: select "user_organizations"."user_organization_id", "user_organizations"."user_id", "user_organizations"."organization_id", "user_organizations"."is_active", "user_organizations"."joined_at", "user_organizations"."created_at", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."practice_uids", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at" from "user_organizations" inner join "organizations" on "user_organizations"."organization_id" = "organizations"."organization_id" where ("user_organizations"."user_id" = $1 and "user_organizations"."is_active" = $2 and "organizations"."is_active" = $3) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true]
Query: select "user_organizations"."user_organization_id", "user_organizations"."user_id", "user_organizations"."organization_id", "user_organizations"."is_active", "user_organizations"."joined_at", "user_organizations"."created_at", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at" from "user_organizations" inner join "organizations" on "user_organizations"."organization_id" = "organizations"."organization_id" where ("user_organizations"."user_id" = $1 and "user_organizations"."is_active" = $2 and "organizations"."is_active" = $3) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true]
Query: select "user_roles"."user_role_id", "user_roles"."user_id", "user_roles"."role_id", "user_roles"."organization_id", "user_roles"."granted_by", "user_roles"."granted_at", "user_roles"."expires_at", "user_roles"."is_active", "user_roles"."created_at", "roles"."name", "roles"."description", "roles"."organization_id", "roles"."is_system_role", "roles"."is_active", "roles"."created_at", "roles"."updated_at", "roles"."deleted_at" from "user_roles" inner join "roles" on "user_roles"."role_id" = "roles"."role_id" where ("user_roles"."user_id" = $1 and "user_roles"."is_active" = $2 and "roles"."is_active" = $3) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true]
Query: select distinct "user_roles"."user_role_id", "user_roles"."user_id", "user_roles"."role_id", "user_roles"."organization_id", "user_roles"."granted_by", "user_roles"."granted_at", "user_roles"."expires_at", "user_roles"."is_active", "user_roles"."created_at", "roles"."name", "roles"."description", "roles"."organization_id", "roles"."is_system_role", "roles"."is_active", "roles"."created_at", "roles"."updated_at", "roles"."deleted_at", "permissions"."permission_id", "permissions"."name", "permissions"."description", "permissions"."resource", "permissions"."action", "permissions"."scope", "permissions"."is_active", "permissions"."created_at", "permissions"."updated_at" from "user_roles" inner join "roles" on "user_roles"."role_id" = "roles"."role_id" inner join "role_permissions" on "roles"."role_id" = "role_permissions"."role_id" inner join "permissions" on "role_permissions"."permission_id" = "permissions"."permission_id" where ("user_roles"."user_id" = $1 and "user_roles"."is_active" = $2 and "roles"."is_active" = $3 and "permissions"."is_active" = $4) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true, true]
{"@timestamp":"2025-10-15T17:43:31.222Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"user-context.ts","line":314,"function":"eval","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":350,"userId":"[UUID]","rolesCount":1,"permissionsCount":90,"organizationsCount":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.222Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/dashboards","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":105,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.222Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":138,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.222Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":350,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.222Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.222Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":350,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.223Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.223Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":351,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"rbacDuration":1,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.223Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":351,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
Query: select "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."organization_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "users"."user_id", "users"."first_name", "users"."last_name", "users"."email", count("dashboard_charts"."chart_definition_id") from "dashboards" left join "chart_categories" on "dashboards"."dashboard_category_id" = "chart_categories"."chart_category_id" left join "users" on "dashboards"."created_by" = "users"."user_id" left join "dashboard_charts" on "dashboards"."dashboard_id" = "dashboard_charts"."dashboard_id" where ("dashboards"."is_active" = $1 and "dashboards"."is_published" = $2) group by "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."organization_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "users"."user_id", "users"."first_name", "users"."last_name", "users"."email" order by "dashboards"."created_at" desc limit $3 -- params: [true, true, 1000000]
{"@timestamp":"2025-10-15T17:43:31.229Z","level":"INFO","message":"GET /api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47 - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.229Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","requiredPermissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.227Z","level":"INFO","message":"Main database connections closed","service":"bendcare-os","env":"development","file":"index.ts","line":160,"function":"process.closeDb"}
{"@timestamp":"2025-10-15T17:43:31.233Z","level":"INFO","message":"dashboards list query completed - returned 8 of 8","service":"bendcare-os","env":"development","file":"rbac-dashboards-service.ts","line":211,"function":"RBACDashboardsServiceImpl.getDashboards","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_dashboards","resourceType":"dashboards","userId":"[UUID]","filters":{"is_active":true,"is_published":true},"filterCount":2,"results":{"returned":8,"total":8,"page":1},"empty":false,"duration":10,"slow":false,"component":"service","query":{"duration":10,"slow":false},"rbacScope":"all","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
Query: select count(*) from "dashboards" where ("dashboards"."is_active" = $1 and "dashboards"."is_published" = $2) -- params: [true, true]
{"@timestamp":"2025-10-15T17:43:31.236Z","level":"INFO","message":"dashboards counted","service":"bendcare-os","env":"development","file":"rbac-dashboards-service.ts","line":366,"function":"RBACDashboardsServiceImpl.getDashboardCount","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"count_dashboards","userId":"[UUID]","filters":{"is_active":true,"is_published":true},"count":8,"duration":2,"metadata":{"query":{"duration":2,"slow":false},"rbacScope":"all","component":"service"},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.237Z","level":"INFO","message":"dashboards list query completed - returned 8 of 8","service":"bendcare-os","env":"development","file":"route.ts","line":63,"function":"getDashboardsHandler","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_dashboards","resourceType":"dashboards","userId":"[UUID]","filters":{"is_active":true,"is_published":true},"filterCount":2,"results":{"returned":8,"total":8,"published":8,"draft":0,"hasDefault":true,"defaultDashboardId":"[UUID]","totalCharts":30,"averageChartsPerDashboard":4,"page":1,"pageSize":8},"duration":14,"slow":false,"component":"analytics","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.237Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":14,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:43:31.237Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa4yuv_j2tizktl","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":365,"userId":"[UUID]","statusCode":200,"totalDuration":365,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
 GET /api/admin/analytics/dashboards?is_published=true&is_active=true 200 in 2859ms
{"@timestamp":"2025-10-15T17:43:31.361Z","level":"DEBUG","message":"Cached user context loaded successfully","service":"bendcare-os","env":"development","file":"cached-user-context.ts","line":277,"function":"eval","userId":"[UUID]","rolesCount":1,"permissionsCount":90,"organizationsCount":0}
{"@timestamp":"2025-10-15T17:43:31.361Z","level":"INFO","message":"JWT authentication completed","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":189,"function":"requireJWTAuth","userId":"[UUID]","sessionId":"qEOcjMnIWE5Db5eTz8M7X8k6IywULeuQ","tokenSource":"[REDACTED]","cacheHit":true,"roleCount":1,"permissionCount":90,"duration":245}
{"@timestamp":"2025-10-15T17:43:31.362Z","level":"WARN","message":"Security: jwt_authentication_successful","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":199,"function":"requireJWTAuth","component":"security","event":"jwt_authentication_successful","severity":"low","action":"jwt_middleware_success","userId":"[UUID]","tokenValidated":"[REDACTED]","rbacContextLoaded":true,"cacheOptimized":true}
{"@timestamp":"2025-10-15T17:43:31.362Z","level":"INFO","message":"JWT middleware completed","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":207,"function":"requireJWTAuth","duration":246,"performanceTiming":true,"tokenValidationTime":"[REDACTED]","cacheEnabled":true,"totalOperations":91}
{"@timestamp":"2025-10-15T17:43:31.362Z","level":"INFO","message":"user context retrieved successfully from JWT token","service":"bendcare-os","env":"development","file":"route.ts","line":41,"function":"GET","operation":"get_user_context","userId":"[UUID]","email":"[REDACTED]","rbac":{"roles":1,"permissions":90,"isSuperAdmin":true,"orgAdminFor":0},"organizations":{"direct":0,"accessible":0,"current":null},"duration":543,"slow":false,"component":"auth","cached":true}
 GET /api/auth/me 200 in 2978ms
{"@timestamp":"2025-10-15T17:43:31.363Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":134,"type":"api","identifier":"::1","current":4,"remaining":196,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.363Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":134,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.363Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":134,"pathname":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.463Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":234,"type":"api","identifier":"::1","current":5,"remaining":195,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.464Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":235,"pathname":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.464Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":235,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.530Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":301,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.530Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":66,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.531Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":167,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.531Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":302,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.531Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.532Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":303,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.532Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.532Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":303,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.533Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":304,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.533Z","level":"INFO","message":"Dashboard get request initiated","service":"bendcare-os","env":"development","file":"route.ts","line":30,"function":"getDashboardHandler","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":304,"dashboardId":"[UUID]","requestingUserId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
Query: select "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."organization_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."provider_uid", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "dashboards" left join "chart_categories" on "dashboards"."dashboard_category_id" = "chart_categories"."chart_category_id" left join "users" on "dashboards"."created_by" = "users"."user_id" where "dashboards"."dashboard_id" = $1 limit $2 -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47", 1]
Query: select count(*) from "dashboard_charts" where "dashboard_charts"."dashboard_id" = $1 -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47"]
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "dashboard_charts"."position_config" from "dashboard_charts" inner join "chart_definitions" on "dashboard_charts"."chart_definition_id" = "chart_definitions"."chart_definition_id" where "dashboard_charts"."dashboard_id" = $1 order by "dashboard_charts"."added_at" -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47"]
{"@timestamp":"2025-10-15T17:43:31.547Z","level":"INFO","message":"dashboard retrieved successfully","service":"bendcare-os","env":"development","file":"rbac-dashboards-service.ts","line":336,"function":"RBACDashboardsServiceImpl.getDashboardById","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"read_dashboard","resourceType":"dashboard","resourceId":"[UUID]","resourceName":"Charges","userId":"[UUID]","found":true,"duration":12,"slow":false,"component":"service","query":{"duration":5,"slow":false},"chartCountQuery":{"duration":3,"slow":false},"chartsQuery":{"duration":4,"slow":false},"chartCount":1,"rbacScope":"all","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.547Z","level":"DEBUG","message":"DB: SELECT on dashboards","service":"bendcare-os","env":"development","file":"route.ts","line":42,"function":"getDashboardHandler","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","component":"database","operation":"SELECT","table":"dashboards","duration":14,"rowCount":1,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.548Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":15,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:43:31.549Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa4yuv_jrkmze95","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":320,"userId":"[UUID]","statusCode":200,"totalDuration":319,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
 GET /api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47 200 in 3151ms
 ‚úì Compiled /api/admin/analytics/charts in 309ms (2676 modules)
{"@timestamp":"2025-10-15T17:43:32.071Z","level":"INFO","message":"GET /api/admin/analytics/charts - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.071Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"endpoint":"/api/admin/analytics/charts","requiredPermissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.103Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":33,"type":"api","identifier":"::1","current":6,"remaining":194,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.103Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":32,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.104Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":34,"pathname":"/api/admin/analytics/charts","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.137Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":67,"type":"api","identifier":"::1","current":7,"remaining":193,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.137Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":67,"pathname":"/api/admin/analytics/charts","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.137Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":67,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.199Z","level":"DEBUG","message":"Loading user context","service":"bendcare-os","env":"development","file":"user-context.ts","line":304,"function":"getUserContextSafe","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":129,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
Query: select "user_id", "email", "first_name", "last_name", "is_active", "email_verified", "created_at", "updated_at" from "users" where "users"."user_id" = $1 limit $2 -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", 1]
Query: select "user_organizations"."user_organization_id", "user_organizations"."user_id", "user_organizations"."organization_id", "user_organizations"."is_active", "user_organizations"."joined_at", "user_organizations"."created_at", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at" from "user_organizations" inner join "organizations" on "user_organizations"."organization_id" = "organizations"."organization_id" where ("user_organizations"."user_id" = $1 and "user_organizations"."is_active" = $2 and "organizations"."is_active" = $3) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true]
Query: select distinct "user_roles"."user_role_id", "user_roles"."user_id", "user_roles"."role_id", "user_roles"."organization_id", "user_roles"."granted_by", "user_roles"."granted_at", "user_roles"."expires_at", "user_roles"."is_active", "user_roles"."created_at", "roles"."name", "roles"."description", "roles"."organization_id", "roles"."is_system_role", "roles"."is_active", "roles"."created_at", "roles"."updated_at", "roles"."deleted_at", "permissions"."permission_id", "permissions"."name", "permissions"."description", "permissions"."resource", "permissions"."action", "permissions"."scope", "permissions"."is_active", "permissions"."created_at", "permissions"."updated_at" from "user_roles" inner join "roles" on "user_roles"."role_id" = "roles"."role_id" inner join "role_permissions" on "roles"."role_id" = "role_permissions"."role_id" inner join "permissions" on "role_permissions"."permission_id" = "permissions"."permission_id" where ("user_roles"."user_id" = $1 and "user_roles"."is_active" = $2 and "roles"."is_active" = $3 and "permissions"."is_active" = $4) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true, true]
{"@timestamp":"2025-10-15T17:43:32.208Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"user-context.ts","line":314,"function":"eval","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":138,"userId":"[UUID]","rolesCount":1,"permissionsCount":90,"organizationsCount":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.208Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/charts","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":71,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.208Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":105,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.208Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":138,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.208Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.209Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":139,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.209Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.209Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":139,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.209Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":139,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "chart_definitions"."data_source", "chart_definitions"."chart_config", "chart_definitions"."access_control", "chart_definitions"."data_source_id", "chart_definitions"."chart_category_id", "chart_definitions"."created_by", "chart_definitions"."created_at", "chart_definitions"."updated_at", "chart_definitions"."is_active", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."provider_uid", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "chart_definitions" left join "chart_categories" on "chart_definitions"."chart_category_id" = "chart_categories"."chart_category_id" left join "users" on "chart_definitions"."created_by" = "users"."user_id" where "chart_definitions"."is_active" = $1 order by "chart_definitions"."created_at" desc limit $2 -- params: [true, 1000000]
Query: select count(*) from "chart_definitions" where "chart_definitions"."is_active" = $1 -- params: [true]
{"@timestamp":"2025-10-15T17:43:32.215Z","level":"INFO","message":"charts list query completed - returned 15 of 15","service":"bendcare-os","env":"development","file":"route.ts","line":50,"function":"getChartsHandler","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_charts","resourceType":"chart_definitions","userId":"[UUID]","filters":{"is_active":true},"filterCount":1,"results":{"returned":15,"total":15,"chartTypeBreakdown":{"bar":5,"number":3,"stacked-bar":2,"dual-axis":2,"progress-bar":1,"table":1,"horizontal-bar":1},"activeCount":15,"inactiveCount":0},"duration":6,"slow":false,"component":"analytics","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.215Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":6,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:43:32.215Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa51bn_l7wh7ghx","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":145,"userId":"[UUID]","statusCode":200,"totalDuration":145,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
 GET /api/admin/analytics/charts?is_active=true 200 in 645ms
üåê MIDDLEWARE: ‚úì CSRF validated for POST /api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render
{"@timestamp":"2025-10-15T17:43:32.232Z","level":"DEBUG","message":"Request sanitization completed","service":"bendcare-os","env":"development","file":"request-sanitization.ts","line":232,"function":"sanitizeRequestBody","duration":1,"hasErrors":false,"errorCount":0}
 ‚úì Compiled /api/admin/analytics/dashboard/[dashboardId]/render in 439ms (2718 modules)
{"@timestamp":"2025-10-15T17:43:32.838Z","level":"INFO","message":"Registering chart type handlers","service":"bendcare-os","env":"development","file":"index.ts","line":43,"function":"registerAllHandlers"}
{"@timestamp":"2025-10-15T17:43:32.838Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"line","totalHandlers":1}
{"@timestamp":"2025-10-15T17:43:32.838Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"bar","totalHandlers":2}
{"@timestamp":"2025-10-15T17:43:32.839Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"pie","totalHandlers":3}
{"@timestamp":"2025-10-15T17:43:32.839Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"table","totalHandlers":4}
{"@timestamp":"2025-10-15T17:43:32.839Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"number","totalHandlers":5}
{"@timestamp":"2025-10-15T17:43:32.839Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"progress-bar","totalHandlers":6}
{"@timestamp":"2025-10-15T17:43:32.839Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"dual-axis","totalHandlers":7}
{"@timestamp":"2025-10-15T17:43:32.839Z","level":"INFO","message":"Chart type handlers registered successfully","service":"bendcare-os","env":"development","file":"index.ts","line":66,"function":"registerAllHandlers","count":7,"types":["line","bar","pie","table","number","progress-bar","dual-axis"]}
{"@timestamp":"2025-10-15T17:43:33.214Z","level":"INFO","message":"Registering chart type handlers","service":"bendcare-os","env":"development","file":"index.ts","line":43,"function":"registerAllHandlers"}
{"@timestamp":"2025-10-15T17:43:33.215Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"line","totalHandlers":1}
{"@timestamp":"2025-10-15T17:43:33.215Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"bar","totalHandlers":2}
{"@timestamp":"2025-10-15T17:43:33.216Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"pie","totalHandlers":3}
{"@timestamp":"2025-10-15T17:43:33.216Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"table","totalHandlers":4}
{"@timestamp":"2025-10-15T17:43:33.216Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"number","totalHandlers":5}
{"@timestamp":"2025-10-15T17:43:33.216Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"progress-bar","totalHandlers":6}
{"@timestamp":"2025-10-15T17:43:33.216Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"dual-axis","totalHandlers":7}
{"@timestamp":"2025-10-15T17:43:33.216Z","level":"INFO","message":"Chart type handlers registered successfully","service":"bendcare-os","env":"development","file":"index.ts","line":66,"function":"registerAllHandlers","count":7,"types":["line","bar","pie","table","number","progress-bar","dual-axis"]}
{"@timestamp":"2025-10-15T17:43:33.234Z","level":"INFO","message":"POST /api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"component":"api","request":{},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.234Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"endpoint":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","requiredPermissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAllPermissions":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.231Z","level":"INFO","message":"Main database connections closed","service":"bendcare-os","env":"development","file":"index.ts","line":160,"function":"process.closeDb"}
{"@timestamp":"2025-10-15T17:43:33.264Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":31,"type":"api","identifier":"::1","current":8,"remaining":192,"limit":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.264Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":30,"limitType":"api","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.265Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":32,"pathname":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.295Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":62,"type":"api","identifier":"::1","current":9,"remaining":191,"limit":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.295Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":62,"pathname":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.295Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":62,"component":"auth","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.455Z","level":"DEBUG","message":"Loading user context","service":"bendcare-os","env":"development","file":"user-context.ts","line":304,"function":"getUserContextSafe","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":222,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
Query: select "user_id", "email", "first_name", "last_name", "is_active", "email_verified", "created_at", "updated_at" from "users" where "users"."user_id" = $1 limit $2 -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", 1]
Query: select "user_organizations"."user_organization_id", "user_organizations"."user_id", "user_organizations"."organization_id", "user_organizations"."is_active", "user_organizations"."joined_at", "user_organizations"."created_at", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at" from "user_organizations" inner join "organizations" on "user_organizations"."organization_id" = "organizations"."organization_id" where ("user_organizations"."user_id" = $1 and "user_organizations"."is_active" = $2 and "organizations"."is_active" = $3) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true]
Query: select distinct "user_roles"."user_role_id", "user_roles"."user_id", "user_roles"."role_id", "user_roles"."organization_id", "user_roles"."granted_by", "user_roles"."granted_at", "user_roles"."expires_at", "user_roles"."is_active", "user_roles"."created_at", "roles"."name", "roles"."description", "roles"."organization_id", "roles"."is_system_role", "roles"."is_active", "roles"."created_at", "roles"."updated_at", "roles"."deleted_at", "permissions"."permission_id", "permissions"."name", "permissions"."description", "permissions"."resource", "permissions"."action", "permissions"."scope", "permissions"."is_active", "permissions"."created_at", "permissions"."updated_at" from "user_roles" inner join "roles" on "user_roles"."role_id" = "roles"."role_id" inner join "role_permissions" on "roles"."role_id" = "role_permissions"."role_id" inner join "permissions" on "role_permissions"."permission_id" = "permissions"."permission_id" where ("user_roles"."user_id" = $1 and "user_roles"."is_active" = $2 and "roles"."is_active" = $3 and "permissions"."is_active" = $4) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true, true]
{"@timestamp":"2025-10-15T17:43:33.478Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"user-context.ts","line":314,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":245,"userId":"[UUID]","rolesCount":1,"permissionsCount":90,"organizationsCount":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.479Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":184,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.480Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":215,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.480Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":247,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.480Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.480Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":247,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.482Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":2,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAll":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.482Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":249,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"rbacDuration":2,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.482Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":250,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
Error: Route "/api/admin/analytics/dashboard/[dashboardId]/render" used `params.dashboardId`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at renderDashboardHandler (app/api/admin/analytics/dashboard/[dashboardId]/render/route.ts:47:11)
    at eval (lib/api/rbac-route-handler.ts:261:32)
  45 |   const startTime = Date.now();
  46 |   const { params } = args[0] as RenderDashboardParams;
> 47 |   const { dashboardId } = params;
     |           ^
  48 |
  49 |   log.info('Dashboard batch render request initiated', {
  50 |     dashboardId,
{"@timestamp":"2025-10-15T17:43:33.556Z","level":"INFO","message":"Dashboard batch render request initiated","service":"bendcare-os","env":"development","file":"route.ts","line":25,"function":"renderDashboardHandler","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":323,"dashboardId":"[UUID]","userId":"[UUID]","component":"analytics","operation":"batch_render","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.558Z","level":"INFO","message":"Dashboard universal filters applied","service":"bendcare-os","env":"development","file":"route.ts","line":40,"function":"renderDashboardHandler","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":325,"dashboardId":"[UUID]","filters":{"hasDateRange":false,"dateRangePreset":"this_year","organizationId":"[UUID]"},"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.558Z","level":"INFO","message":"Dashboard batch render initiated","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":55,"function":"DashboardRenderer.renderDashboard","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":325,"dashboardId":"[UUID]","userId":"[UUID]","hasUniversalFilters":true,"organizationFilter":"[UUID]","queryDeduplicationEnabled":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
Query: select "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."organization_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."provider_uid", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "dashboards" left join "chart_categories" on "dashboards"."dashboard_category_id" = "chart_categories"."chart_category_id" left join "users" on "dashboards"."created_by" = "users"."user_id" where "dashboards"."dashboard_id" = $1 limit $2 -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47", 1]
Query: select count(*) from "dashboard_charts" where "dashboard_charts"."dashboard_id" = $1 -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47"]
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "dashboard_charts"."position_config" from "dashboard_charts" inner join "chart_definitions" on "dashboard_charts"."chart_definition_id" = "chart_definitions"."chart_definition_id" where "dashboard_charts"."dashboard_id" = $1 order by "dashboard_charts"."added_at" -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47"]
{"@timestamp":"2025-10-15T17:43:33.565Z","level":"INFO","message":"dashboard retrieved successfully","service":"bendcare-os","env":"development","file":"rbac-dashboards-service.ts","line":336,"function":"RBACDashboardsServiceImpl.getDashboardById","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"read_dashboard","resourceType":"dashboard","resourceId":"[UUID]","resourceName":"Charges","userId":"[UUID]","found":true,"duration":7,"slow":false,"component":"service","query":{"duration":4,"slow":false},"chartCountQuery":{"duration":1,"slow":false},"chartsQuery":{"duration":2,"slow":false},"chartCount":1,"rbacScope":"all","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.566Z","level":"INFO","message":"User has analytics:read:all - no practice_uid filtering","service":"bendcare-os","env":"development","file":"organization-access-service.ts","line":64,"function":"OrganizationAccessService.getAccessiblePracticeUids","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":333,"userId":"[UUID]","permissionScope":"all","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.566Z","level":"INFO","message":"Super admin can filter by any organization","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":370,"function":"DashboardRenderer.validateOrganizationFilterAccess","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":333,"userId":"[UUID]","requestedOrganizationId":"[UUID]","permissionScope":"all","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.599Z","level":"DEBUG","message":"Organization hierarchy cache hit","service":"bendcare-os","env":"development","file":"organization-hierarchy-service.ts","line":62,"function":"OrganizationHierarchyService.getAllOrganizations","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","totalOrganizations":5,"duration":33,"cacheHit":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.600Z","level":"INFO","message":"Organization hierarchy resolved","service":"bendcare-os","env":"development","file":"organization-hierarchy-service.ts","line":156,"function":"OrganizationHierarchyService.getOrganizationHierarchy","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","rootOrganizationId":"[UUID]","rootOrganizationName":"Family Arthrits Center","totalOrganizations":1,"includesChildren":false,"duration":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.600Z","level":"INFO","message":"Hierarchy practice_uids collected","service":"bendcare-os","env":"development","file":"organization-hierarchy-service.ts","line":200,"function":"OrganizationHierarchyService.getHierarchyPracticeUids","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","organizationId":"[UUID]","hierarchySize":1,"practiceUidCount":1,"practiceUids":[114],"duration":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.600Z","level":"INFO","message":"Organization practice_uids resolved for dashboard filter","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":429,"function":"DashboardRenderer.getOrganizationPracticeUids","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":367,"organizationId":"[UUID]","practiceUidCount":1,"practiceUids":[114],"includesHierarchy":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.600Z","level":"INFO","message":"Dashboard organization filter processed","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":74,"function":"DashboardRenderer.renderDashboard","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":367,"dashboardId":"[UUID]","organizationId":"[UUID]","practiceUidCount":1,"practiceUids":[114],"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "chart_definitions"."data_source", "chart_definitions"."chart_config", "chart_definitions"."access_control", "chart_definitions"."data_source_id", "chart_definitions"."chart_category_id", "chart_definitions"."created_by", "chart_definitions"."created_at", "chart_definitions"."updated_at", "chart_definitions"."is_active", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."provider_uid", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "chart_definitions" left join "chart_categories" on "chart_definitions"."chart_category_id" = "chart_categories"."chart_category_id" left join "users" on "chart_definitions"."created_by" = "users"."user_id" where "chart_definitions"."chart_definition_id" = $1 limit $2 -- params: ["60ffd8fd-d938-4256-8d9e-d4d0e0ae7164", 1]
{"@timestamp":"2025-10-15T17:43:33.603Z","level":"INFO","message":"Dashboard charts loaded","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":136,"function":"DashboardRenderer.renderDashboard","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":370,"dashboardId":"[UUID]","totalCharts":1,"validCharts":1,"chartTypes":["bar"],"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.603Z","level":"INFO","message":"Processing chart in batch","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":154,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":370,"chartId":"[UUID]","chartName":"Charges by Provider","chartType":"bar","batchSupported":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.603Z","level":"INFO","message":"Batch chart config prepared","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":222,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":370,"chartId":"[UUID]","chartType":"bar","chartName":"Charges by Provider","hasGroupBy":true,"groupByValue":"provider_name","hasDualAxisConfig":false,"hasAggregation":false,"runtimeFilterKeys":"[REDACTED]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.603Z","level":"DEBUG","message":"Query hash generated","service":"bendcare-os","env":"development","file":"dashboard-query-cache.ts","line":95,"function":"generateQueryHash","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":370,"dataSourceId":1,"measure":"Charges by Provider","hashLength":64,"signatureKeys":"[REDACTED]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.603Z","level":"INFO","message":"Query cache miss - executing query","service":"bendcare-os","env":"development","file":"dashboard-query-cache.ts","line":161,"function":"DashboardQueryCache.get","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":370,"queryHash":"[PHONE]","cacheSize":0,"deduplication":"miss","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.604Z","level":"INFO","message":"Chart configuration resolved","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":28,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":371,"chartType":"bar","dataSourceId":1,"hasRuntimeFilters":true,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
Query: select "data_source_id", "data_source_name", "data_source_description", "table_name", "schema_name", "database_type", "connection_config", "is_active", "requires_auth", "created_at", "updated_at", "created_by" from "chart_data_sources" where "chart_data_sources"."data_source_id" = $1 -- params: [1]
Query: select count(*) from "chart_data_source_columns" where ("chart_data_source_columns"."data_source_id" = $1 and "chart_data_source_columns"."is_active" = $2) -- params: [1, true]
{"@timestamp":"2025-10-15T17:43:33.607Z","level":"INFO","message":"Data source access check passed","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":207,"function":"ChartDataOrchestrator.verifyDataSourceAccess","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":374,"dataSourceId":1,"dataSourceName":"Practice Analytics","userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.607Z","level":"INFO","message":"Data source access verified","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":36,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":374,"dataSourceId":1,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.607Z","level":"INFO","message":"Runtime filters merged","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":42,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":374,"chartType":"bar","hasStartDate":true,"hasEndDate":true,"hasPracticeUid":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.607Z","level":"INFO","message":"Chart handler retrieved","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":55,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":374,"chartType":"bar","handlerType":"bar","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.607Z","level":"INFO","message":"Chart configuration validated","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":64,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":374,"chartType":"bar","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.608Z","level":"INFO","message":"dashboard organization filter applied","service":"bendcare-os","env":"development","file":"base-handler.ts","line":167,"function":"BarChartHandler.buildQueryParams","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":375,"operation":"build_query_params","practiceUidCount":1,"practiceUids":[114],"source":"dashboard_universal_filter","component":"chart-handler","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.608Z","level":"INFO","message":"Fetching chart data with Redis cache integration","service":"bendcare-os","env":"development","file":"base-handler.ts","line":42,"function":"BarChartHandler.fetchData","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":375,"chartType":"bar","dataSourceId":1,"userId":"[UUID]","hasDataSourceId":true,"note":"Passing UserContext to enable Redis cache path","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.608Z","level":"INFO","message":"Building analytics query with caching","service":"bendcare-os","env":"development","file":"analytics-query-builder.ts","line":325,"function":"AnalyticsQueryBuilder.queryMeasures","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":375,"params":{"data_source_id":1,"start_date":"2025-01-01","end_date":"2025-12-31","limit":10000,"measure":"Charges by Provider","advanced_filters":[{"field":"practice_uid","operator":"in","value":[114]}]},"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.640Z","level":"DEBUG","message":"Data source config cache hit","service":"bendcare-os","env":"development","file":"chart-config-cache.ts","line":50,"function":"ChartConfigCacheService.getDataSourceConfig","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":407,"component":"chart-config-cache","dataSourceId":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:33.641Z","level":"DEBUG","message":"Chart context built","service":"bendcare-os","env":"development","file":"chart-context.ts","line":46,"function":"buildChartRenderContext","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","userId":"[UUID]","permissionScope":"all","practiceCount":0,"providerCount":0,"organizationCount":0,"includesHierarchy":false,"duration":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.245Z","level":"INFO","message":"Data source cache hit","service":"bendcare-os","env":"development","file":"data-source-cache.ts","line":146,"function":"DataSourceCacheService.getCached","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1012,"cacheKey":"[REDACTED]","cacheLevel":0,"rowCount":4462,"sizeKB":1238,"cachedAt":"2025-10-15T17:37:28.635Z","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.246Z","level":"WARN","message":"Security: RBAC filter: all scope, no filtering","service":"bendcare-os","env":"development","file":"data-source-cache.ts","line":472,"function":"DataSourceCacheService.applyRBACFilter","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1013,"component":"security","event":"RBAC filter: all scope, no filtering","severity":"low","userId":"[UUID]","rowCount":4462,"permissionScope":"all","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.248Z","level":"DEBUG","message":"Column mapping cache miss - loading from config","service":"bendcare-os","env":"development","file":"column-mapping-service.ts","line":62,"function":"ColumnMappingService.getMapping","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1015,"component":"column-mapping-service","dataSourceId":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.284Z","level":"DEBUG","message":"Data source config cache hit","service":"bendcare-os","env":"development","file":"chart-config-cache.ts","line":50,"function":"ChartConfigCacheService.getDataSourceConfig","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1052,"component":"chart-config-cache","dataSourceId":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.286Z","level":"INFO","message":"Column mapping loaded and cached","service":"bendcare-os","env":"development","file":"column-mapping-service.ts","line":82,"function":"ColumnMappingService.getMapping","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1053,"component":"column-mapping-service","dataSourceId":1,"mapping":"[REDACTED]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.287Z","level":"INFO","message":"Data source served from cache (server-filtered)","service":"bendcare-os","env":"development","file":"data-source-cache.ts","line":615,"function":"DataSourceCacheService.fetchDataSource","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","cacheKey":"[REDACTED]","cacheLevel":0,"cachedRowCount":4462,"afterRBAC":3368,"finalRowCount":3368,"duration":646,"userId":"[UUID]","permissionScope":"all","security":"filtered_before_client_send","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.288Z","level":"DEBUG","message":"Column mapping cache hit","service":"bendcare-os","env":"development","file":"column-mapping-service.ts","line":56,"function":"ColumnMappingService.getMapping","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1055,"component":"column-mapping-service","dataSourceId":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.289Z","level":"INFO","message":"Analytics query completed (with caching)","service":"bendcare-os","env":"development","file":"analytics-query-builder.ts","line":391,"function":"AnalyticsQueryBuilder.queryMeasures","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","dataSourceId":1,"measure":"Charges by Provider","rowCount":3368,"totalCount":2321011858,"duration":681,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.290Z","level":"INFO","message":"Chart data fetched successfully","service":"bendcare-os","env":"development","file":"base-handler.ts","line":54,"function":"BarChartHandler.fetchData","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1057,"chartType":"bar","recordCount":3368,"queryTimeMs":681,"cacheHit":true,"fetchDuration":682,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.290Z","level":"INFO","message":"Chart data fetched","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":71,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1057,"chartType":"bar","recordCount":3368,"fetchDuration":683,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.291Z","level":"INFO","message":"Transforming bar chart data","service":"bendcare-os","env":"development","file":"bar-chart-handler.ts","line":41,"function":"BarChartHandler.transform","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1058,"chartType":"bar","recordCount":3368,"groupBy":"provider_name","colorPalette":"default","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.309Z","level":"INFO","message":"Bar chart data transformed","service":"bendcare-os","env":"development","file":"bar-chart-handler.ts","line":70,"function":"BarChartHandler.transform","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","chartType":"bar","duration":17,"datasetCount":300,"labelCount":12,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.309Z","level":"INFO","message":"Chart data transformed","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":80,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1076,"chartType":"bar","datasetCount":300,"labelCount":12,"transformDuration":19,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.309Z","level":"INFO","message":"Chart data orchestration completed","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":111,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1077,"chartType":"bar","totalDuration":705,"fetchDuration":683,"transformDuration":19,"recordCount":3368,"hasColumns":false,"columnCount":0,"hasFormattedData":false,"formattedRowCount":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.310Z","level":"INFO","message":"Dashboard batch render completed","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":306,"function":"DashboardRenderer.renderDashboard","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","dashboardId":"[UUID]","chartsRendered":1,"cacheHits":0,"cacheMisses":1,"totalQueryTime":683,"parallelDuration":706,"duration":752,"queryDeduplication":{"uniqueQueries":1,"queriesDeduped":0,"deduplicationRate":"0%","totalCharts":1,"queriesSaved":0},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.311Z","level":"INFO","message":"Query cache cleared","service":"bendcare-os","env":"development","file":"dashboard-query-cache.ts","line":184,"function":"DashboardQueryCache.clear","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1078,"uniqueQueries":1,"queriesDeduped":0,"deduplicationRate":"0%","totalRequests":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.311Z","level":"INFO","message":"Dashboard batch render completed","service":"bendcare-os","env":"development","file":"route.ts","line":58,"function":"renderDashboardHandler","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","dashboardId":"[UUID]","userId":"[UUID]","component":"analytics","operation":"batch_render","duration":828,"metrics":{"chartsRendered":1,"queriesExecuted":1,"cacheHits":0,"cacheMisses":1,"cacheHitRate":0,"totalQueryTime":683,"parallelExecution":true,"filtersApplied":3,"nocache":false},"slow":false,"performance":{"target":2000,"actual":828,"overTarget":false},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.316Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":833,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:43:34.317Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa51tw_0pswta23","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1084,"userId":"[UUID]","statusCode":200,"totalDuration":1082,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
 POST /api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render 200 in 2087ms
 ‚úì Compiled /api/organizations in 315ms (2729 modules)
{"@timestamp":"2025-10-15T17:43:34.811Z","level":"INFO","message":"GET /api/organizations - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:34.811Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/organizations","requiredPermissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:34.844Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":33,"type":"api","identifier":"::1","current":10,"remaining":190,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:34.844Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":33,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:34.845Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":34,"pathname":"/api/organizations","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:34.876Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":65,"type":"api","identifier":"::1","current":11,"remaining":189,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:34.876Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":65,"pathname":"/api/organizations","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:34.877Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":66,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.031Z","level":"DEBUG","message":"Loading user context","service":"bendcare-os","env":"development","file":"user-context.ts","line":304,"function":"getUserContextSafe","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":220,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
Query: select "user_id", "email", "first_name", "last_name", "is_active", "email_verified", "created_at", "updated_at" from "users" where "users"."user_id" = $1 limit $2 -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", 1]
Query: select "user_organizations"."user_organization_id", "user_organizations"."user_id", "user_organizations"."organization_id", "user_organizations"."is_active", "user_organizations"."joined_at", "user_organizations"."created_at", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at" from "user_organizations" inner join "organizations" on "user_organizations"."organization_id" = "organizations"."organization_id" where ("user_organizations"."user_id" = $1 and "user_organizations"."is_active" = $2 and "organizations"."is_active" = $3) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true]
Query: select distinct "user_roles"."user_role_id", "user_roles"."user_id", "user_roles"."role_id", "user_roles"."organization_id", "user_roles"."granted_by", "user_roles"."granted_at", "user_roles"."expires_at", "user_roles"."is_active", "user_roles"."created_at", "roles"."name", "roles"."description", "roles"."organization_id", "roles"."is_system_role", "roles"."is_active", "roles"."created_at", "roles"."updated_at", "roles"."deleted_at", "permissions"."permission_id", "permissions"."name", "permissions"."description", "permissions"."resource", "permissions"."action", "permissions"."scope", "permissions"."is_active", "permissions"."created_at", "permissions"."updated_at" from "user_roles" inner join "roles" on "user_roles"."role_id" = "roles"."role_id" inner join "role_permissions" on "roles"."role_id" = "role_permissions"."role_id" inner join "permissions" on "role_permissions"."permission_id" = "permissions"."permission_id" where ("user_roles"."user_id" = $1 and "user_roles"."is_active" = $2 and "roles"."is_active" = $3 and "permissions"."is_active" = $4) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true, true]
{"@timestamp":"2025-10-15T17:43:35.052Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"user-context.ts","line":314,"function":"eval","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":241,"userId":"[UUID]","rolesCount":1,"permissionsCount":90,"organizationsCount":0,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.053Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/organizations","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":176,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.053Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":209,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.053Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":242,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.053Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.054Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":243,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.056Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":2,"userId":"[UUID]","permissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.056Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":245,"userId":"[UUID]","permissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"rbacDuration":2,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.057Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":246,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
Query: select "organizations"."organization_id", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at", "practices"."practice_id", "practices"."domain", "practices"."status", "practices"."template_id" from "organizations" left join "practices" on "organizations"."organization_id" = "practices"."practice_id" where ("organizations"."is_active" = $1 and "organizations"."deleted_at" is null and "organizations"."is_active" = $2) order by "organizations"."created_at" desc -- params: [true, true]
Query: select "organization_id", count(*) from "user_organizations" where ("user_organizations"."organization_id" in ($1, $2, $3, $4, $5) and "user_organizations"."is_active" = $6) group by "user_organizations"."organization_id" -- params: ["d9e5bd24-b104-4ff5-a219-678eedb31aaa", "4e23ee8f-33b1-4a6a-a371-0437d01c40d6", "7b70e645-82f2-4b18-8b22-db946991f6d5", "640c5969-74bc-4189-a455-81bf26f74829", "13f5a859-91ba-46ad-a4d1-40fb7a2996f2", true]
Query: select "parent_organization_id", count(*) from "organizations" where ("organizations"."parent_organization_id" in ($1, $2, $3, $4, $5) and "organizations"."parent_organization_id" is not null and "organizations"."is_active" = $6 and "organizations"."deleted_at" is null) group by "organizations"."parent_organization_id" -- params: ["d9e5bd24-b104-4ff5-a219-678eedb31aaa", "4e23ee8f-33b1-4a6a-a371-0437d01c40d6", "7b70e645-82f2-4b18-8b22-db946991f6d5", "640c5969-74bc-4189-a455-81bf26f74829", "13f5a859-91ba-46ad-a4d1-40fb7a2996f2", true]
{"@timestamp":"2025-10-15T17:43:35.066Z","level":"INFO","message":"organizations list query completed - returned 5 of 5","service":"bendcare-os","env":"development","file":"index.ts","line":257,"function":"OrganizationsService.getOrganizations","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_organizations","resourceType":"organizations","userId":"[UUID]","filters":{"is_active":true},"filterCount":1,"results":{"returned":5,"total":5,"page":1,"hasMore":false},"empty":false,"duration":6,"slow":false,"component":"service","query":{"duration":3,"slow":false},"enrichment":{"duration":3,"slow":false},"rbacScope":"all","batchOptimized":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.067Z","level":"INFO","message":"organizations list query completed - returned 5 organizations","service":"bendcare-os","env":"development","file":"route.ts","line":67,"function":"getOrganizationsHandler","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_organizations","resourceType":"organizations","userId":"[UUID]","isSuperAdmin":true,"filters":{"is_active":true},"filterCount":1,"results":{"returned":5,"active":5,"inactive":0,"page":1,"pageSize":10},"sort":{"field":"created_at","direction":"desc"},"duration":10,"slow":false,"component":"business-logic","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.068Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":11,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.068Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa53gu_wpjdc522","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":257,"userId":"[UUID]","statusCode":200,"totalDuration":257,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
 GET /api/organizations?is_active=true 200 in 722ms
{"@timestamp":"2025-10-15T17:43:35.103Z","level":"INFO","message":"GET /api/organizations - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.103Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/organizations","requiredPermissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.137Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":34,"type":"api","identifier":"::1","current":12,"remaining":188,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.137Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":34,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.138Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":35,"pathname":"/api/organizations","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.169Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":66,"type":"api","identifier":"::1","current":13,"remaining":187,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.170Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":67,"pathname":"/api/organizations","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.170Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":67,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.242Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":139,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.243Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/organizations","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":73,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.243Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":106,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.244Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":141,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.244Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.244Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":141,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.245Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.245Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":142,"userId":"[UUID]","permissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.246Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":143,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
Query: select "organizations"."organization_id", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at", "practices"."practice_id", "practices"."domain", "practices"."status", "practices"."template_id" from "organizations" left join "practices" on "organizations"."organization_id" = "practices"."practice_id" where ("organizations"."is_active" = $1 and "organizations"."deleted_at" is null and "organizations"."is_active" = $2) order by "organizations"."created_at" desc -- params: [true, true]
Query: select "organization_id", count(*) from "user_organizations" where ("user_organizations"."organization_id" in ($1, $2, $3, $4, $5) and "user_organizations"."is_active" = $6) group by "user_organizations"."organization_id" -- params: ["d9e5bd24-b104-4ff5-a219-678eedb31aaa", "4e23ee8f-33b1-4a6a-a371-0437d01c40d6", "7b70e645-82f2-4b18-8b22-db946991f6d5", "640c5969-74bc-4189-a455-81bf26f74829", "13f5a859-91ba-46ad-a4d1-40fb7a2996f2", true]
Query: select "parent_organization_id", count(*) from "organizations" where ("organizations"."parent_organization_id" in ($1, $2, $3, $4, $5) and "organizations"."parent_organization_id" is not null and "organizations"."is_active" = $6 and "organizations"."deleted_at" is null) group by "organizations"."parent_organization_id" -- params: ["d9e5bd24-b104-4ff5-a219-678eedb31aaa", "4e23ee8f-33b1-4a6a-a371-0437d01c40d6", "7b70e645-82f2-4b18-8b22-db946991f6d5", "640c5969-74bc-4189-a455-81bf26f74829", "13f5a859-91ba-46ad-a4d1-40fb7a2996f2", true]
{"@timestamp":"2025-10-15T17:43:35.254Z","level":"INFO","message":"organizations list query completed - returned 5 of 5","service":"bendcare-os","env":"development","file":"index.ts","line":257,"function":"OrganizationsService.getOrganizations","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_organizations","resourceType":"organizations","userId":"[UUID]","filters":{"is_active":true},"filterCount":1,"results":{"returned":5,"total":5,"page":1,"hasMore":false},"empty":false,"duration":7,"slow":false,"component":"service","query":{"duration":4,"slow":false},"enrichment":{"duration":3,"slow":false},"rbacScope":"all","batchOptimized":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.254Z","level":"INFO","message":"organizations list query completed - returned 5 organizations","service":"bendcare-os","env":"development","file":"route.ts","line":67,"function":"getOrganizationsHandler","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_organizations","resourceType":"organizations","userId":"[UUID]","isSuperAdmin":true,"filters":{"is_active":true},"filterCount":1,"results":{"returned":5,"active":5,"inactive":0,"page":1,"pageSize":10},"sort":{"field":"created_at","direction":"desc"},"duration":8,"slow":false,"component":"business-logic","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.255Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":9,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:43:35.256Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa5414_63h9dhmh","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":153,"userId":"[UUID]","statusCode":200,"totalDuration":152,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
 GET /api/organizations?is_active=true 200 in 176ms
üåê MIDDLEWARE: Processing request for: /dashboard/view/e118a803-c656-4caa-a1d1-bd501c6d3e47
üåê MIDDLEWARE: Protected route detected
üåê MIDDLEWARE: Checking auth - access token: true, refresh token: true
üåê MIDDLEWARE: Access token valid - allowing access
üåê MIDDLEWARE: User authenticated (or has refresh token) - allowing request to proceed
 GET /dashboard/view/e118a803-c656-4caa-a1d1-bd501c6d3e47?datePreset=this_year&org=d9e5bd24-b104-4ff5-a219-678eedb31aaa 200 in 484ms
{"@timestamp":"2025-10-15T17:44:15.029Z","level":"INFO","message":"GET /api/admin/analytics/dashboards - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.029Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/admin/analytics/dashboards","requiredPermissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.062Z","level":"INFO","message":"GET /api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47 - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.062Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","requiredPermissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.078Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","type":"api","identifier":"::1","current":2,"remaining":198,"limit":200}
{"@timestamp":"2025-10-15T17:44:15.079Z","level":"INFO","message":"JWT authentication middleware initiated","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":100,"function":"requireJWTAuth","url":"http://localhost:4001/api/auth/me","method":"GET","hasAuthHeader":false,"hasCookieHeader":"[REDACTED]"}
üîê AUTH: Using access token from httpOnly cookie
{"@timestamp":"2025-10-15T17:44:15.093Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":31,"type":"api","identifier":"::1","current":3,"remaining":197,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.093Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":31,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.093Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":31,"pathname":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.097Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":68,"type":"api","identifier":"::1","current":1,"remaining":199,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.097Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":68,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.097Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":68,"pathname":"/api/admin/analytics/dashboards","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.108Z","level":"INFO","message":"Auth: jwt_validation","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":153,"function":"requireJWTAuth","component":"auth","action":"jwt_validation","success":true,"userId":"[UUID]","sessionId":"qEOcjMnIWE5Db5eTz8M7X8k6IywULeuQ","tokenSource":"[REDACTED]","validationDuration":29}
üîê AUTH: JWT cache miss, falling back to database query
{"@timestamp":"2025-10-15T17:44:15.123Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":61,"type":"api","identifier":"::1","current":4,"remaining":196,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.123Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":61,"pathname":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.123Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":61,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.130Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":101,"type":"api","identifier":"::1","current":5,"remaining":195,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.130Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":101,"pathname":"/api/admin/analytics/dashboards","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.130Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":101,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.211Z","level":"DEBUG","message":"Redis user context cache hit","service":"bendcare-os","env":"development","file":"cached-user-context.ts","line":261,"function":"eval","userId":"[UUID]","rolesCount":1,"permissionsCount":90,"fromRedis":true}
{"@timestamp":"2025-10-15T17:44:15.212Z","level":"INFO","message":"JWT authentication completed","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":189,"function":"requireJWTAuth","userId":"[UUID]","sessionId":"qEOcjMnIWE5Db5eTz8M7X8k6IywULeuQ","tokenSource":"[REDACTED]","cacheHit":true,"roleCount":1,"permissionCount":90,"duration":133}
{"@timestamp":"2025-10-15T17:44:15.212Z","level":"WARN","message":"Security: jwt_authentication_successful","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":199,"function":"requireJWTAuth","component":"security","event":"jwt_authentication_successful","severity":"low","action":"jwt_middleware_success","userId":"[UUID]","tokenValidated":"[REDACTED]","rbacContextLoaded":true,"cacheOptimized":true}
{"@timestamp":"2025-10-15T17:44:15.212Z","level":"INFO","message":"JWT middleware completed","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":207,"function":"requireJWTAuth","duration":133,"performanceTiming":true,"tokenValidationTime":"[REDACTED]","cacheEnabled":true,"totalOperations":91}
{"@timestamp":"2025-10-15T17:44:15.212Z","level":"INFO","message":"user context retrieved successfully from JWT token","service":"bendcare-os","env":"development","file":"route.ts","line":41,"function":"GET","operation":"get_user_context","userId":"[UUID]","email":"[REDACTED]","rbac":{"roles":1,"permissions":90,"isSuperAdmin":true,"orgAdminFor":0},"organizations":{"direct":0,"accessible":0,"current":null},"duration":165,"slow":false,"component":"auth","cached":true}
 GET /api/auth/me 200 in 251ms
{"@timestamp":"2025-10-15T17:44:15.245Z","level":"DEBUG","message":"Loading user context","service":"bendcare-os","env":"development","file":"user-context.ts","line":304,"function":"getUserContextSafe","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":183,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
Query: select "user_id", "email", "first_name", "last_name", "is_active", "email_verified", "created_at", "updated_at" from "users" where "users"."user_id" = $1 limit $2 -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", 1]
Query: select "user_organizations"."user_organization_id", "user_organizations"."user_id", "user_organizations"."organization_id", "user_organizations"."is_active", "user_organizations"."joined_at", "user_organizations"."created_at", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at" from "user_organizations" inner join "organizations" on "user_organizations"."organization_id" = "organizations"."organization_id" where ("user_organizations"."user_id" = $1 and "user_organizations"."is_active" = $2 and "organizations"."is_active" = $3) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true]
Query: select distinct "user_roles"."user_role_id", "user_roles"."user_id", "user_roles"."role_id", "user_roles"."organization_id", "user_roles"."granted_by", "user_roles"."granted_at", "user_roles"."expires_at", "user_roles"."is_active", "user_roles"."created_at", "roles"."name", "roles"."description", "roles"."organization_id", "roles"."is_system_role", "roles"."is_active", "roles"."created_at", "roles"."updated_at", "roles"."deleted_at", "permissions"."permission_id", "permissions"."name", "permissions"."description", "permissions"."resource", "permissions"."action", "permissions"."scope", "permissions"."is_active", "permissions"."created_at", "permissions"."updated_at" from "user_roles" inner join "roles" on "user_roles"."role_id" = "roles"."role_id" inner join "role_permissions" on "roles"."role_id" = "role_permissions"."role_id" inner join "permissions" on "role_permissions"."permission_id" = "permissions"."permission_id" where ("user_roles"."user_id" = $1 and "user_roles"."is_active" = $2 and "roles"."is_active" = $3 and "permissions"."is_active" = $4) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true, true]
{"@timestamp":"2025-10-15T17:44:15.278Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"user-context.ts","line":314,"function":"eval","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":216,"userId":"[UUID]","rolesCount":1,"permissionsCount":90,"organizationsCount":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.278Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":249,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.278Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":155,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.278Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/dashboards","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":148,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.279Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":185,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.279Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":217,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.279Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.279Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":217,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.279Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":182,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.279Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":250,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.279Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.279Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":250,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.279Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.279Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":217,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.279Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":217,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.279Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.279Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":250,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.279Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":250,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
Query: select "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."organization_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "users"."user_id", "users"."first_name", "users"."last_name", "users"."email", count("dashboard_charts"."chart_definition_id") from "dashboards" left join "chart_categories" on "dashboards"."dashboard_category_id" = "chart_categories"."chart_category_id" left join "users" on "dashboards"."created_by" = "users"."user_id" left join "dashboard_charts" on "dashboards"."dashboard_id" = "dashboard_charts"."dashboard_id" where ("dashboards"."is_active" = $1 and "dashboards"."is_published" = $2) group by "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."organization_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "users"."user_id", "users"."first_name", "users"."last_name", "users"."email" order by "dashboards"."created_at" desc limit $3 -- params: [true, true, 1000000]
{"@timestamp":"2025-10-15T17:44:15.280Z","level":"INFO","message":"Dashboard get request initiated","service":"bendcare-os","env":"development","file":"route.ts","line":30,"function":"getDashboardHandler","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":218,"dashboardId":"[UUID]","requestingUserId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
Query: select "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."organization_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."provider_uid", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "dashboards" left join "chart_categories" on "dashboards"."dashboard_category_id" = "chart_categories"."chart_category_id" left join "users" on "dashboards"."created_by" = "users"."user_id" where "dashboards"."dashboard_id" = $1 limit $2 -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47", 1]
{"@timestamp":"2025-10-15T17:44:15.287Z","level":"INFO","message":"dashboards list query completed - returned 8 of 8","service":"bendcare-os","env":"development","file":"rbac-dashboards-service.ts","line":211,"function":"RBACDashboardsServiceImpl.getDashboards","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_dashboards","resourceType":"dashboards","userId":"[UUID]","filters":{"is_active":true,"is_published":true},"filterCount":2,"results":{"returned":8,"total":8,"page":1},"empty":false,"duration":7,"slow":false,"component":"service","query":{"duration":7,"slow":false},"rbacScope":"all","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
Query: select count(*) from "dashboards" where ("dashboards"."is_active" = $1 and "dashboards"."is_published" = $2) -- params: [true, true]
{"@timestamp":"2025-10-15T17:44:15.289Z","level":"INFO","message":"dashboards counted","service":"bendcare-os","env":"development","file":"rbac-dashboards-service.ts","line":366,"function":"RBACDashboardsServiceImpl.getDashboardCount","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"count_dashboards","userId":"[UUID]","filters":{"is_active":true,"is_published":true},"count":8,"duration":1,"metadata":{"query":{"duration":1,"slow":false},"rbacScope":"all","component":"service"},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.289Z","level":"INFO","message":"dashboards list query completed - returned 8 of 8","service":"bendcare-os","env":"development","file":"route.ts","line":63,"function":"getDashboardsHandler","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_dashboards","resourceType":"dashboards","userId":"[UUID]","filters":{"is_active":true,"is_published":true},"filterCount":2,"results":{"returned":8,"total":8,"published":8,"draft":0,"hasDefault":true,"defaultDashboardId":"[UUID]","totalCharts":30,"averageChartsPerDashboard":4,"page":1,"pageSize":8},"duration":9,"slow":false,"component":"analytics","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.290Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":11,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:15.290Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa5ysr_av77qby8","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":261,"userId":"[UUID]","statusCode":200,"totalDuration":261,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
 GET /api/admin/analytics/dashboards?is_published=true&is_active=true 200 in 330ms
Query: select count(*) from "dashboard_charts" where "dashboard_charts"."dashboard_id" = $1 -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47"]
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "dashboard_charts"."position_config" from "dashboard_charts" inner join "chart_definitions" on "dashboard_charts"."chart_definition_id" = "chart_definitions"."chart_definition_id" where "dashboard_charts"."dashboard_id" = $1 order by "dashboard_charts"."added_at" -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47"]
{"@timestamp":"2025-10-15T17:44:15.304Z","level":"INFO","message":"dashboard retrieved successfully","service":"bendcare-os","env":"development","file":"rbac-dashboards-service.ts","line":336,"function":"RBACDashboardsServiceImpl.getDashboardById","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"read_dashboard","resourceType":"dashboard","resourceId":"[UUID]","resourceName":"Charges","userId":"[UUID]","found":true,"duration":23,"slow":false,"component":"service","query":{"duration":19,"slow":false},"chartCountQuery":{"duration":1,"slow":false},"chartsQuery":{"duration":3,"slow":false},"chartCount":1,"rbacScope":"all","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.304Z","level":"DEBUG","message":"DB: SELECT on dashboards","service":"bendcare-os","env":"development","file":"route.ts","line":42,"function":"getDashboardHandler","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","component":"database","operation":"SELECT","table":"dashboards","duration":24,"rowCount":1,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.305Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":25,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:15.305Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa5yss_vt2unhvk","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":243,"userId":"[UUID]","statusCode":200,"totalDuration":243,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
 GET /api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47 200 in 333ms
{"@timestamp":"2025-10-15T17:44:15.344Z","level":"INFO","message":"GET /api/admin/analytics/charts - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.344Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/admin/analytics/charts","requiredPermissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.395Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":51,"type":"api","identifier":"::1","current":6,"remaining":194,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.395Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":51,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.395Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":51,"pathname":"/api/admin/analytics/charts","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.426Z","level":"INFO","message":"Main database connections closed","service":"bendcare-os","env":"development","file":"index.ts","line":160,"function":"process.closeDb"}
{"@timestamp":"2025-10-15T17:44:15.428Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":84,"type":"api","identifier":"::1","current":7,"remaining":193,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.428Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":84,"pathname":"/api/admin/analytics/charts","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.428Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":84,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.490Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":146,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.491Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/charts","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":63,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.491Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":96,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.491Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":147,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.491Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.491Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":147,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.491Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.491Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":147,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.491Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":147,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "chart_definitions"."data_source", "chart_definitions"."chart_config", "chart_definitions"."access_control", "chart_definitions"."data_source_id", "chart_definitions"."chart_category_id", "chart_definitions"."created_by", "chart_definitions"."created_at", "chart_definitions"."updated_at", "chart_definitions"."is_active", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."provider_uid", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "chart_definitions" left join "chart_categories" on "chart_definitions"."chart_category_id" = "chart_categories"."chart_category_id" left join "users" on "chart_definitions"."created_by" = "users"."user_id" where "chart_definitions"."is_active" = $1 order by "chart_definitions"."created_at" desc limit $2 -- params: [true, 1000000]
Query: select count(*) from "chart_definitions" where "chart_definitions"."is_active" = $1 -- params: [true]
{"@timestamp":"2025-10-15T17:44:15.499Z","level":"INFO","message":"charts list query completed - returned 15 of 15","service":"bendcare-os","env":"development","file":"route.ts","line":50,"function":"getChartsHandler","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_charts","resourceType":"chart_definitions","userId":"[UUID]","filters":{"is_active":true},"filterCount":1,"results":{"returned":15,"total":15,"chartTypeBreakdown":{"bar":5,"number":3,"stacked-bar":2,"dual-axis":2,"progress-bar":1,"table":1,"horizontal-bar":1},"activeCount":15,"inactiveCount":0},"duration":8,"slow":false,"component":"analytics","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.499Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":8,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:15.499Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa5z2o_ynrf759x","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":155,"userId":"[UUID]","statusCode":200,"totalDuration":155,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
 GET /api/admin/analytics/charts?is_active=true 200 in 187ms
üåê MIDDLEWARE: ‚úì CSRF validated for POST /api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render
{"@timestamp":"2025-10-15T17:44:15.511Z","level":"DEBUG","message":"Request sanitization completed","service":"bendcare-os","env":"development","file":"request-sanitization.ts","line":232,"function":"sanitizeRequestBody","duration":0,"hasErrors":false,"errorCount":0}
{"@timestamp":"2025-10-15T17:44:15.553Z","level":"INFO","message":"Registering chart type handlers","service":"bendcare-os","env":"development","file":"index.ts","line":43,"function":"registerAllHandlers"}
{"@timestamp":"2025-10-15T17:44:15.553Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"line","totalHandlers":1}
{"@timestamp":"2025-10-15T17:44:15.553Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"bar","totalHandlers":2}
{"@timestamp":"2025-10-15T17:44:15.553Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"pie","totalHandlers":3}
{"@timestamp":"2025-10-15T17:44:15.553Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"table","totalHandlers":4}
{"@timestamp":"2025-10-15T17:44:15.553Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"number","totalHandlers":5}
{"@timestamp":"2025-10-15T17:44:15.553Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"progress-bar","totalHandlers":6}
{"@timestamp":"2025-10-15T17:44:15.553Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"dual-axis","totalHandlers":7}
{"@timestamp":"2025-10-15T17:44:15.553Z","level":"INFO","message":"Chart type handlers registered successfully","service":"bendcare-os","env":"development","file":"index.ts","line":66,"function":"registerAllHandlers","count":7,"types":["line","bar","pie","table","number","progress-bar","dual-axis"]}
{"@timestamp":"2025-10-15T17:44:15.557Z","level":"INFO","message":"POST /api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.557Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","requiredPermissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAllPermissions":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.590Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":33,"type":"api","identifier":"::1","current":8,"remaining":192,"limit":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.590Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":33,"limitType":"api","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.590Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":33,"pathname":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.622Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":65,"type":"api","identifier":"::1","current":9,"remaining":191,"limit":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.622Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":65,"pathname":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.622Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":65,"component":"auth","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.688Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":131,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.688Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":66,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.688Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":98,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.688Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":131,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.688Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.689Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":132,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.689Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAll":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.689Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":132,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"rbacDuration":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.689Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":132,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
Error: Route "/api/admin/analytics/dashboard/[dashboardId]/render" used `params.dashboardId`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at renderDashboardHandler (app/api/admin/analytics/dashboard/[dashboardId]/render/route.ts:47:11)
    at eval (lib/api/rbac-route-handler.ts:261:32)
  45 |   const startTime = Date.now();
  46 |   const { params } = args[0] as RenderDashboardParams;
> 47 |   const { dashboardId } = params;
     |           ^
  48 |
  49 |   log.info('Dashboard batch render request initiated', {
  50 |     dashboardId,
{"@timestamp":"2025-10-15T17:44:15.733Z","level":"INFO","message":"Dashboard batch render request initiated","service":"bendcare-os","env":"development","file":"route.ts","line":25,"function":"renderDashboardHandler","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":176,"dashboardId":"[UUID]","userId":"[UUID]","component":"analytics","operation":"batch_render","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.733Z","level":"INFO","message":"Dashboard universal filters applied","service":"bendcare-os","env":"development","file":"route.ts","line":40,"function":"renderDashboardHandler","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":176,"dashboardId":"[UUID]","filters":{"hasDateRange":false,"dateRangePreset":"this_year","organizationId":"[UUID]"},"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.734Z","level":"INFO","message":"Dashboard batch render initiated","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":55,"function":"DashboardRenderer.renderDashboard","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":177,"dashboardId":"[UUID]","userId":"[UUID]","hasUniversalFilters":true,"organizationFilter":"[UUID]","queryDeduplicationEnabled":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
Query: select "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."organization_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."provider_uid", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "dashboards" left join "chart_categories" on "dashboards"."dashboard_category_id" = "chart_categories"."chart_category_id" left join "users" on "dashboards"."created_by" = "users"."user_id" where "dashboards"."dashboard_id" = $1 limit $2 -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47", 1]
Query: select count(*) from "dashboard_charts" where "dashboard_charts"."dashboard_id" = $1 -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47"]
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "dashboard_charts"."position_config" from "dashboard_charts" inner join "chart_definitions" on "dashboard_charts"."chart_definition_id" = "chart_definitions"."chart_definition_id" where "dashboard_charts"."dashboard_id" = $1 order by "dashboard_charts"."added_at" -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47"]
{"@timestamp":"2025-10-15T17:44:15.747Z","level":"INFO","message":"dashboard retrieved successfully","service":"bendcare-os","env":"development","file":"rbac-dashboards-service.ts","line":336,"function":"RBACDashboardsServiceImpl.getDashboardById","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"read_dashboard","resourceType":"dashboard","resourceId":"[UUID]","resourceName":"Charges","userId":"[UUID]","found":true,"duration":13,"slow":false,"component":"service","query":{"duration":11,"slow":false},"chartCountQuery":{"duration":1,"slow":false},"chartsQuery":{"duration":1,"slow":false},"chartCount":1,"rbacScope":"all","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.748Z","level":"INFO","message":"User has analytics:read:all - no practice_uid filtering","service":"bendcare-os","env":"development","file":"organization-access-service.ts","line":64,"function":"OrganizationAccessService.getAccessiblePracticeUids","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":191,"userId":"[UUID]","permissionScope":"all","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.748Z","level":"INFO","message":"Super admin can filter by any organization","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":370,"function":"DashboardRenderer.validateOrganizationFilterAccess","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":191,"userId":"[UUID]","requestedOrganizationId":"[UUID]","permissionScope":"all","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.781Z","level":"DEBUG","message":"Organization hierarchy cache hit","service":"bendcare-os","env":"development","file":"organization-hierarchy-service.ts","line":62,"function":"OrganizationHierarchyService.getAllOrganizations","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","totalOrganizations":5,"duration":32,"cacheHit":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.781Z","level":"INFO","message":"Organization hierarchy resolved","service":"bendcare-os","env":"development","file":"organization-hierarchy-service.ts","line":156,"function":"OrganizationHierarchyService.getOrganizationHierarchy","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","rootOrganizationId":"[UUID]","rootOrganizationName":"Family Arthrits Center","totalOrganizations":1,"includesChildren":false,"duration":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.781Z","level":"INFO","message":"Hierarchy practice_uids collected","service":"bendcare-os","env":"development","file":"organization-hierarchy-service.ts","line":200,"function":"OrganizationHierarchyService.getHierarchyPracticeUids","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","organizationId":"[UUID]","hierarchySize":1,"practiceUidCount":1,"practiceUids":[114],"duration":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.781Z","level":"INFO","message":"Organization practice_uids resolved for dashboard filter","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":429,"function":"DashboardRenderer.getOrganizationPracticeUids","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":224,"organizationId":"[UUID]","practiceUidCount":1,"practiceUids":[114],"includesHierarchy":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.781Z","level":"INFO","message":"Dashboard organization filter processed","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":74,"function":"DashboardRenderer.renderDashboard","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":224,"dashboardId":"[UUID]","organizationId":"[UUID]","practiceUidCount":1,"practiceUids":[114],"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "chart_definitions"."data_source", "chart_definitions"."chart_config", "chart_definitions"."access_control", "chart_definitions"."data_source_id", "chart_definitions"."chart_category_id", "chart_definitions"."created_by", "chart_definitions"."created_at", "chart_definitions"."updated_at", "chart_definitions"."is_active", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."provider_uid", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "chart_definitions" left join "chart_categories" on "chart_definitions"."chart_category_id" = "chart_categories"."chart_category_id" left join "users" on "chart_definitions"."created_by" = "users"."user_id" where "chart_definitions"."chart_definition_id" = $1 limit $2 -- params: ["60ffd8fd-d938-4256-8d9e-d4d0e0ae7164", 1]
{"@timestamp":"2025-10-15T17:44:15.784Z","level":"INFO","message":"Dashboard charts loaded","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":136,"function":"DashboardRenderer.renderDashboard","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":227,"dashboardId":"[UUID]","totalCharts":1,"validCharts":1,"chartTypes":["bar"],"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.785Z","level":"INFO","message":"Processing chart in batch","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":154,"function":"eval","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":228,"chartId":"[UUID]","chartName":"Charges by Provider","chartType":"bar","batchSupported":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.785Z","level":"INFO","message":"Batch chart config prepared","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":222,"function":"eval","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":228,"chartId":"[UUID]","chartType":"bar","chartName":"Charges by Provider","hasGroupBy":true,"groupByValue":"provider_name","hasDualAxisConfig":false,"hasAggregation":false,"runtimeFilterKeys":"[REDACTED]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.785Z","level":"DEBUG","message":"Query hash generated","service":"bendcare-os","env":"development","file":"dashboard-query-cache.ts","line":95,"function":"generateQueryHash","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":228,"dataSourceId":1,"measure":"Charges by Provider","hashLength":64,"signatureKeys":"[REDACTED]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.785Z","level":"INFO","message":"Query cache miss - executing query","service":"bendcare-os","env":"development","file":"dashboard-query-cache.ts","line":161,"function":"DashboardQueryCache.get","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":228,"queryHash":"[PHONE]","cacheSize":0,"deduplication":"miss","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.785Z","level":"INFO","message":"Chart configuration resolved","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":28,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":228,"chartType":"bar","dataSourceId":1,"hasRuntimeFilters":true,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
Query: select "data_source_id", "data_source_name", "data_source_description", "table_name", "schema_name", "database_type", "connection_config", "is_active", "requires_auth", "created_at", "updated_at", "created_by" from "chart_data_sources" where "chart_data_sources"."data_source_id" = $1 -- params: [1]
Query: select count(*) from "chart_data_source_columns" where ("chart_data_source_columns"."data_source_id" = $1 and "chart_data_source_columns"."is_active" = $2) -- params: [1, true]
{"@timestamp":"2025-10-15T17:44:15.789Z","level":"INFO","message":"Data source access check passed","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":207,"function":"ChartDataOrchestrator.verifyDataSourceAccess","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":232,"dataSourceId":1,"dataSourceName":"Practice Analytics","userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.789Z","level":"INFO","message":"Data source access verified","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":36,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":232,"dataSourceId":1,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.789Z","level":"INFO","message":"Runtime filters merged","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":42,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":232,"chartType":"bar","hasStartDate":true,"hasEndDate":true,"hasPracticeUid":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.789Z","level":"INFO","message":"Chart handler retrieved","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":55,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":232,"chartType":"bar","handlerType":"bar","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.789Z","level":"INFO","message":"Chart configuration validated","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":64,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":232,"chartType":"bar","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.790Z","level":"INFO","message":"dashboard organization filter applied","service":"bendcare-os","env":"development","file":"base-handler.ts","line":167,"function":"BarChartHandler.buildQueryParams","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":233,"operation":"build_query_params","practiceUidCount":1,"practiceUids":[114],"source":"dashboard_universal_filter","component":"chart-handler","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.790Z","level":"INFO","message":"Fetching chart data with Redis cache integration","service":"bendcare-os","env":"development","file":"base-handler.ts","line":42,"function":"BarChartHandler.fetchData","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":233,"chartType":"bar","dataSourceId":1,"userId":"[UUID]","hasDataSourceId":true,"note":"Passing UserContext to enable Redis cache path","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.790Z","level":"INFO","message":"Building analytics query with caching","service":"bendcare-os","env":"development","file":"analytics-query-builder.ts","line":325,"function":"AnalyticsQueryBuilder.queryMeasures","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":233,"params":{"data_source_id":1,"start_date":"2025-01-01","end_date":"2025-12-31","limit":10000,"measure":"Charges by Provider","advanced_filters":[{"field":"practice_uid","operator":"in","value":[114]}]},"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.896Z","level":"DEBUG","message":"Data source config cache hit","service":"bendcare-os","env":"development","file":"chart-config-cache.ts","line":50,"function":"ChartConfigCacheService.getDataSourceConfig","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":339,"component":"chart-config-cache","dataSourceId":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.896Z","level":"DEBUG","message":"Chart context built","service":"bendcare-os","env":"development","file":"chart-context.ts","line":46,"function":"buildChartRenderContext","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","userId":"[UUID]","permissionScope":"all","practiceCount":0,"providerCount":0,"organizationCount":0,"includesHierarchy":false,"duration":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:15.926Z","level":"INFO","message":"Registering chart type handlers","service":"bendcare-os","env":"development","file":"index.ts","line":43,"function":"registerAllHandlers"}
{"@timestamp":"2025-10-15T17:44:15.928Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"line","totalHandlers":1}
{"@timestamp":"2025-10-15T17:44:15.928Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"bar","totalHandlers":2}
{"@timestamp":"2025-10-15T17:44:15.928Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"pie","totalHandlers":3}
{"@timestamp":"2025-10-15T17:44:15.928Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"table","totalHandlers":4}
{"@timestamp":"2025-10-15T17:44:15.928Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"number","totalHandlers":5}
{"@timestamp":"2025-10-15T17:44:15.928Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"progress-bar","totalHandlers":6}
{"@timestamp":"2025-10-15T17:44:15.928Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"dual-axis","totalHandlers":7}
{"@timestamp":"2025-10-15T17:44:15.928Z","level":"INFO","message":"Chart type handlers registered successfully","service":"bendcare-os","env":"development","file":"index.ts","line":66,"function":"registerAllHandlers","count":7,"types":["line","bar","pie","table","number","progress-bar","dual-axis"]}
{"@timestamp":"2025-10-15T17:44:15.951Z","level":"INFO","message":"Main database connections closed","service":"bendcare-os","env":"development","file":"index.ts","line":160,"function":"process.closeDb"}
{"@timestamp":"2025-10-15T17:44:16.277Z","level":"INFO","message":"Data source cache hit","service":"bendcare-os","env":"development","file":"data-source-cache.ts","line":146,"function":"DataSourceCacheService.getCached","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":720,"cacheKey":"[REDACTED]","cacheLevel":0,"rowCount":4462,"sizeKB":1238,"cachedAt":"2025-10-15T17:37:28.635Z","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.278Z","level":"WARN","message":"Security: RBAC filter: all scope, no filtering","service":"bendcare-os","env":"development","file":"data-source-cache.ts","line":472,"function":"DataSourceCacheService.applyRBACFilter","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":721,"component":"security","event":"RBAC filter: all scope, no filtering","severity":"low","userId":"[UUID]","rowCount":4462,"permissionScope":"all","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.279Z","level":"DEBUG","message":"Column mapping cache miss - loading from config","service":"bendcare-os","env":"development","file":"column-mapping-service.ts","line":62,"function":"ColumnMappingService.getMapping","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":722,"component":"column-mapping-service","dataSourceId":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.313Z","level":"DEBUG","message":"Data source config cache hit","service":"bendcare-os","env":"development","file":"chart-config-cache.ts","line":50,"function":"ChartConfigCacheService.getDataSourceConfig","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":756,"component":"chart-config-cache","dataSourceId":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.314Z","level":"INFO","message":"Column mapping loaded and cached","service":"bendcare-os","env":"development","file":"column-mapping-service.ts","line":82,"function":"ColumnMappingService.getMapping","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":757,"component":"column-mapping-service","dataSourceId":1,"mapping":"[REDACTED]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.316Z","level":"INFO","message":"Data source served from cache (server-filtered)","service":"bendcare-os","env":"development","file":"data-source-cache.ts","line":615,"function":"DataSourceCacheService.fetchDataSource","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","cacheKey":"[REDACTED]","cacheLevel":0,"cachedRowCount":4462,"afterRBAC":3368,"finalRowCount":3368,"duration":420,"userId":"[UUID]","permissionScope":"all","security":"filtered_before_client_send","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.317Z","level":"DEBUG","message":"Column mapping cache hit","service":"bendcare-os","env":"development","file":"column-mapping-service.ts","line":56,"function":"ColumnMappingService.getMapping","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":760,"component":"column-mapping-service","dataSourceId":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.318Z","level":"INFO","message":"Analytics query completed (with caching)","service":"bendcare-os","env":"development","file":"analytics-query-builder.ts","line":391,"function":"AnalyticsQueryBuilder.queryMeasures","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","dataSourceId":1,"measure":"Charges by Provider","rowCount":3368,"totalCount":2321011858,"duration":528,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.319Z","level":"INFO","message":"Chart data fetched successfully","service":"bendcare-os","env":"development","file":"base-handler.ts","line":54,"function":"BarChartHandler.fetchData","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":762,"chartType":"bar","recordCount":3368,"queryTimeMs":528,"cacheHit":true,"fetchDuration":528,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.319Z","level":"INFO","message":"Chart data fetched","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":71,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":762,"chartType":"bar","recordCount":3368,"fetchDuration":530,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.320Z","level":"INFO","message":"Transforming bar chart data","service":"bendcare-os","env":"development","file":"bar-chart-handler.ts","line":41,"function":"BarChartHandler.transform","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":763,"chartType":"bar","recordCount":3368,"groupBy":"provider_name","colorPalette":"default","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.327Z","level":"INFO","message":"Bar chart data transformed","service":"bendcare-os","env":"development","file":"bar-chart-handler.ts","line":70,"function":"BarChartHandler.transform","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","chartType":"bar","duration":8,"datasetCount":300,"labelCount":12,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.327Z","level":"INFO","message":"Chart data transformed","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":80,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":771,"chartType":"bar","datasetCount":300,"labelCount":12,"transformDuration":8,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.328Z","level":"INFO","message":"Chart data orchestration completed","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":111,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":771,"chartType":"bar","totalDuration":543,"fetchDuration":530,"transformDuration":8,"recordCount":3368,"hasColumns":false,"columnCount":0,"hasFormattedData":false,"formattedRowCount":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.329Z","level":"INFO","message":"Dashboard batch render completed","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":306,"function":"DashboardRenderer.renderDashboard","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","dashboardId":"[UUID]","chartsRendered":1,"cacheHits":0,"cacheMisses":1,"totalQueryTime":530,"parallelDuration":543,"duration":594,"queryDeduplication":{"uniqueQueries":1,"queriesDeduped":0,"deduplicationRate":"0%","totalCharts":1,"queriesSaved":0},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.329Z","level":"INFO","message":"Query cache cleared","service":"bendcare-os","env":"development","file":"dashboard-query-cache.ts","line":184,"function":"DashboardQueryCache.clear","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":772,"uniqueQueries":1,"queriesDeduped":0,"deduplicationRate":"0%","totalRequests":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.330Z","level":"INFO","message":"Dashboard batch render completed","service":"bendcare-os","env":"development","file":"route.ts","line":58,"function":"renderDashboardHandler","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","dashboardId":"[UUID]","userId":"[UUID]","component":"analytics","operation":"batch_render","duration":641,"metrics":{"chartsRendered":1,"queriesExecuted":1,"cacheHits":0,"cacheMisses":1,"cacheHitRate":0,"totalQueryTime":530,"parallelExecution":true,"filtersApplied":3,"nocache":false},"slow":false,"performance":{"target":2000,"actual":641,"overTarget":false},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.337Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":647,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:16.337Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa5z85_dkb3l31b","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":780,"userId":"[UUID]","statusCode":200,"totalDuration":780,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
 POST /api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render 200 in 828ms
{"@timestamp":"2025-10-15T17:44:16.390Z","level":"INFO","message":"GET /api/organizations - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.390Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/organizations","requiredPermissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.447Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":57,"type":"api","identifier":"::1","current":10,"remaining":190,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.447Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":57,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.448Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":58,"pathname":"/api/organizations","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.482Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":92,"type":"api","identifier":"::1","current":11,"remaining":189,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.483Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":93,"pathname":"/api/organizations","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.483Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":93,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.556Z","level":"DEBUG","message":"Loading user context","service":"bendcare-os","env":"development","file":"user-context.ts","line":304,"function":"getUserContextSafe","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":166,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
Query: select "user_id", "email", "first_name", "last_name", "is_active", "email_verified", "created_at", "updated_at" from "users" where "users"."user_id" = $1 limit $2 -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", 1]
Query: select "user_organizations"."user_organization_id", "user_organizations"."user_id", "user_organizations"."organization_id", "user_organizations"."is_active", "user_organizations"."joined_at", "user_organizations"."created_at", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at" from "user_organizations" inner join "organizations" on "user_organizations"."organization_id" = "organizations"."organization_id" where ("user_organizations"."user_id" = $1 and "user_organizations"."is_active" = $2 and "organizations"."is_active" = $3) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true]
Query: select distinct "user_roles"."user_role_id", "user_roles"."user_id", "user_roles"."role_id", "user_roles"."organization_id", "user_roles"."granted_by", "user_roles"."granted_at", "user_roles"."expires_at", "user_roles"."is_active", "user_roles"."created_at", "roles"."name", "roles"."description", "roles"."organization_id", "roles"."is_system_role", "roles"."is_active", "roles"."created_at", "roles"."updated_at", "roles"."deleted_at", "permissions"."permission_id", "permissions"."name", "permissions"."description", "permissions"."resource", "permissions"."action", "permissions"."scope", "permissions"."is_active", "permissions"."created_at", "permissions"."updated_at" from "user_roles" inner join "roles" on "user_roles"."role_id" = "roles"."role_id" inner join "role_permissions" on "roles"."role_id" = "role_permissions"."role_id" inner join "permissions" on "role_permissions"."permission_id" = "permissions"."permission_id" where ("user_roles"."user_id" = $1 and "user_roles"."is_active" = $2 and "roles"."is_active" = $3 and "permissions"."is_active" = $4) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true, true]
{"@timestamp":"2025-10-15T17:44:16.574Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"user-context.ts","line":314,"function":"eval","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":184,"userId":"[UUID]","rolesCount":1,"permissionsCount":90,"organizationsCount":0,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.575Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/organizations","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":92,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.575Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":127,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.576Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":186,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.576Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.576Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":186,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.578Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.578Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":188,"userId":"[UUID]","permissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.578Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":188,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
Query: select "organizations"."organization_id", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at", "practices"."practice_id", "practices"."domain", "practices"."status", "practices"."template_id" from "organizations" left join "practices" on "organizations"."organization_id" = "practices"."practice_id" where ("organizations"."is_active" = $1 and "organizations"."deleted_at" is null and "organizations"."is_active" = $2) order by "organizations"."created_at" desc -- params: [true, true]
Query: select "organization_id", count(*) from "user_organizations" where ("user_organizations"."organization_id" in ($1, $2, $3, $4, $5) and "user_organizations"."is_active" = $6) group by "user_organizations"."organization_id" -- params: ["d9e5bd24-b104-4ff5-a219-678eedb31aaa", "4e23ee8f-33b1-4a6a-a371-0437d01c40d6", "7b70e645-82f2-4b18-8b22-db946991f6d5", "640c5969-74bc-4189-a455-81bf26f74829", "13f5a859-91ba-46ad-a4d1-40fb7a2996f2", true]
Query: select "parent_organization_id", count(*) from "organizations" where ("organizations"."parent_organization_id" in ($1, $2, $3, $4, $5) and "organizations"."parent_organization_id" is not null and "organizations"."is_active" = $6 and "organizations"."deleted_at" is null) group by "organizations"."parent_organization_id" -- params: ["d9e5bd24-b104-4ff5-a219-678eedb31aaa", "4e23ee8f-33b1-4a6a-a371-0437d01c40d6", "7b70e645-82f2-4b18-8b22-db946991f6d5", "640c5969-74bc-4189-a455-81bf26f74829", "13f5a859-91ba-46ad-a4d1-40fb7a2996f2", true]
{"@timestamp":"2025-10-15T17:44:16.585Z","level":"INFO","message":"organizations list query completed - returned 5 of 5","service":"bendcare-os","env":"development","file":"index.ts","line":257,"function":"OrganizationsService.getOrganizations","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_organizations","resourceType":"organizations","userId":"[UUID]","filters":{"is_active":true},"filterCount":1,"results":{"returned":5,"total":5,"page":1,"hasMore":false},"empty":false,"duration":5,"slow":false,"component":"service","query":{"duration":3,"slow":false},"enrichment":{"duration":2,"slow":false},"rbacScope":"all","batchOptimized":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.585Z","level":"INFO","message":"organizations list query completed - returned 5 organizations","service":"bendcare-os","env":"development","file":"route.ts","line":67,"function":"getOrganizationsHandler","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_organizations","resourceType":"organizations","userId":"[UUID]","isSuperAdmin":true,"filters":{"is_active":true},"filterCount":1,"results":{"returned":5,"active":5,"inactive":0,"page":1,"pageSize":10},"sort":{"field":"created_at","direction":"desc"},"duration":7,"slow":false,"component":"business-logic","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.586Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":7,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.586Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa5zvy_7r545lzk","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":196,"userId":"[UUID]","statusCode":200,"totalDuration":196,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
 GET /api/organizations?is_active=true 200 in 220ms
{"@timestamp":"2025-10-15T17:44:16.786Z","level":"INFO","message":"GET /api/organizations - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.786Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/organizations","requiredPermissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.821Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":35,"type":"api","identifier":"::1","current":12,"remaining":188,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.821Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":35,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.822Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":36,"pathname":"/api/organizations","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.942Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":156,"type":"api","identifier":"::1","current":13,"remaining":187,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.943Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":157,"pathname":"/api/organizations","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:16.944Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":158,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:17.006Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":220,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:17.007Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/organizations","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":64,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:17.007Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":185,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:17.008Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":222,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:17.008Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:17.008Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":222,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:17.009Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"userId":"[UUID]","permissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:17.010Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":224,"userId":"[UUID]","permissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"rbacDuration":1,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:17.011Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":225,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
Query: select "organizations"."organization_id", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at", "practices"."practice_id", "practices"."domain", "practices"."status", "practices"."template_id" from "organizations" left join "practices" on "organizations"."organization_id" = "practices"."practice_id" where ("organizations"."is_active" = $1 and "organizations"."deleted_at" is null and "organizations"."is_active" = $2) order by "organizations"."created_at" desc -- params: [true, true]
Query: select "organization_id", count(*) from "user_organizations" where ("user_organizations"."organization_id" in ($1, $2, $3, $4, $5) and "user_organizations"."is_active" = $6) group by "user_organizations"."organization_id" -- params: ["d9e5bd24-b104-4ff5-a219-678eedb31aaa", "4e23ee8f-33b1-4a6a-a371-0437d01c40d6", "7b70e645-82f2-4b18-8b22-db946991f6d5", "640c5969-74bc-4189-a455-81bf26f74829", "13f5a859-91ba-46ad-a4d1-40fb7a2996f2", true]
Query: select "parent_organization_id", count(*) from "organizations" where ("organizations"."parent_organization_id" in ($1, $2, $3, $4, $5) and "organizations"."parent_organization_id" is not null and "organizations"."is_active" = $6 and "organizations"."deleted_at" is null) group by "organizations"."parent_organization_id" -- params: ["d9e5bd24-b104-4ff5-a219-678eedb31aaa", "4e23ee8f-33b1-4a6a-a371-0437d01c40d6", "7b70e645-82f2-4b18-8b22-db946991f6d5", "640c5969-74bc-4189-a455-81bf26f74829", "13f5a859-91ba-46ad-a4d1-40fb7a2996f2", true]
{"@timestamp":"2025-10-15T17:44:17.018Z","level":"INFO","message":"organizations list query completed - returned 5 of 5","service":"bendcare-os","env":"development","file":"index.ts","line":257,"function":"OrganizationsService.getOrganizations","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_organizations","resourceType":"organizations","userId":"[UUID]","filters":{"is_active":true},"filterCount":1,"results":{"returned":5,"total":5,"page":1,"hasMore":false},"empty":false,"duration":6,"slow":false,"component":"service","query":{"duration":3,"slow":false},"enrichment":{"duration":3,"slow":false},"rbacScope":"all","batchOptimized":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:17.018Z","level":"INFO","message":"organizations list query completed - returned 5 organizations","service":"bendcare-os","env":"development","file":"route.ts","line":67,"function":"getOrganizationsHandler","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_organizations","resourceType":"organizations","userId":"[UUID]","isSuperAdmin":true,"filters":{"is_active":true},"filterCount":1,"results":{"returned":5,"active":5,"inactive":0,"page":1,"pageSize":10},"sort":{"field":"created_at","direction":"desc"},"duration":7,"slow":false,"component":"business-logic","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:17.019Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":7,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:17.019Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa606t_n3b2xpk9","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":233,"userId":"[UUID]","statusCode":200,"totalDuration":233,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
 GET /api/organizations?is_active=true 200 in 261ms
üåê MIDDLEWARE: Processing request for: /dashboard/view/e118a803-c656-4caa-a1d1-bd501c6d3e47
üåê MIDDLEWARE: Protected route detected
üåê MIDDLEWARE: Checking auth - access token: true, refresh token: true
üåê MIDDLEWARE: Access token valid - allowing access
üåê MIDDLEWARE: User authenticated (or has refresh token) - allowing request to proceed
 GET /dashboard/view/e118a803-c656-4caa-a1d1-bd501c6d3e47?datePreset=this_year&org=d9e5bd24-b104-4ff5-a219-678eedb31aaa 200 in 92ms
{"@timestamp":"2025-10-15T17:44:19.243Z","level":"INFO","message":"GET /api/admin/analytics/dashboards - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.243Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/admin/analytics/dashboards","requiredPermissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.256Z","level":"INFO","message":"GET /api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47 - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.256Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","requiredPermissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.274Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":31,"type":"api","identifier":"::1","current":14,"remaining":186,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.274Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":31,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.274Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":31,"pathname":"/api/admin/analytics/dashboards","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.287Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","type":"api","identifier":"::1","current":15,"remaining":185,"limit":200}
{"@timestamp":"2025-10-15T17:44:19.288Z","level":"INFO","message":"JWT authentication middleware initiated","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":100,"function":"requireJWTAuth","url":"http://localhost:4001/api/auth/me","method":"GET","hasAuthHeader":false,"hasCookieHeader":"[REDACTED]"}
üîê AUTH: Using access token from httpOnly cookie
{"@timestamp":"2025-10-15T17:44:19.288Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":32,"type":"api","identifier":"::1","current":16,"remaining":184,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.289Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":33,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.289Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":33,"pathname":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.304Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":61,"type":"api","identifier":"::1","current":17,"remaining":183,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.304Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":61,"pathname":"/api/admin/analytics/dashboards","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.304Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":61,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.318Z","level":"INFO","message":"Auth: jwt_validation","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":153,"function":"requireJWTAuth","component":"auth","action":"jwt_validation","success":true,"userId":"[UUID]","sessionId":"qEOcjMnIWE5Db5eTz8M7X8k6IywULeuQ","tokenSource":"[REDACTED]","validationDuration":30}
üîê AUTH: JWT cache miss, falling back to database query
{"@timestamp":"2025-10-15T17:44:19.322Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":66,"type":"api","identifier":"::1","current":18,"remaining":182,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.322Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":66,"pathname":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.322Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":66,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.420Z","level":"DEBUG","message":"Redis user context cache hit","service":"bendcare-os","env":"development","file":"cached-user-context.ts","line":261,"function":"eval","userId":"[UUID]","rolesCount":1,"permissionsCount":90,"fromRedis":true}
{"@timestamp":"2025-10-15T17:44:19.420Z","level":"INFO","message":"JWT authentication completed","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":189,"function":"requireJWTAuth","userId":"[UUID]","sessionId":"qEOcjMnIWE5Db5eTz8M7X8k6IywULeuQ","tokenSource":"[REDACTED]","cacheHit":true,"roleCount":1,"permissionCount":90,"duration":133}
{"@timestamp":"2025-10-15T17:44:19.420Z","level":"WARN","message":"Security: jwt_authentication_successful","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":199,"function":"requireJWTAuth","component":"security","event":"jwt_authentication_successful","severity":"low","action":"jwt_middleware_success","userId":"[UUID]","tokenValidated":"[REDACTED]","rbacContextLoaded":true,"cacheOptimized":true}
{"@timestamp":"2025-10-15T17:44:19.420Z","level":"INFO","message":"JWT middleware completed","service":"bendcare-os","env":"development","file":"jwt-auth.ts","line":207,"function":"requireJWTAuth","duration":133,"performanceTiming":true,"tokenValidationTime":"[REDACTED]","cacheEnabled":true,"totalOperations":91}
{"@timestamp":"2025-10-15T17:44:19.420Z","level":"INFO","message":"user context retrieved successfully from JWT token","service":"bendcare-os","env":"development","file":"route.ts","line":41,"function":"GET","operation":"get_user_context","userId":"[UUID]","email":"[REDACTED]","rbac":{"roles":1,"permissions":90,"isSuperAdmin":true,"orgAdminFor":0},"organizations":{"direct":0,"accessible":0,"current":null},"duration":167,"slow":false,"component":"auth","cached":true}
 GET /api/auth/me 200 in 223ms
{"@timestamp":"2025-10-15T17:44:19.421Z","level":"DEBUG","message":"Loading user context","service":"bendcare-os","env":"development","file":"user-context.ts","line":304,"function":"getUserContextSafe","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":178,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
Query: select "user_id", "email", "first_name", "last_name", "is_active", "email_verified", "created_at", "updated_at" from "users" where "users"."user_id" = $1 limit $2 -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", 1]
Query: select "user_organizations"."user_organization_id", "user_organizations"."user_id", "user_organizations"."organization_id", "user_organizations"."is_active", "user_organizations"."joined_at", "user_organizations"."created_at", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at" from "user_organizations" inner join "organizations" on "user_organizations"."organization_id" = "organizations"."organization_id" where ("user_organizations"."user_id" = $1 and "user_organizations"."is_active" = $2 and "organizations"."is_active" = $3) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true]
Query: select distinct "user_roles"."user_role_id", "user_roles"."user_id", "user_roles"."role_id", "user_roles"."organization_id", "user_roles"."granted_by", "user_roles"."granted_at", "user_roles"."expires_at", "user_roles"."is_active", "user_roles"."created_at", "roles"."name", "roles"."description", "roles"."organization_id", "roles"."is_system_role", "roles"."is_active", "roles"."created_at", "roles"."updated_at", "roles"."deleted_at", "permissions"."permission_id", "permissions"."name", "permissions"."description", "permissions"."resource", "permissions"."action", "permissions"."scope", "permissions"."is_active", "permissions"."created_at", "permissions"."updated_at" from "user_roles" inner join "roles" on "user_roles"."role_id" = "roles"."role_id" inner join "role_permissions" on "roles"."role_id" = "role_permissions"."role_id" inner join "permissions" on "role_permissions"."permission_id" = "permissions"."permission_id" where ("user_roles"."user_id" = $1 and "user_roles"."is_active" = $2 and "roles"."is_active" = $3 and "permissions"."is_active" = $4) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true, true]
{"@timestamp":"2025-10-15T17:44:19.429Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"user-context.ts","line":314,"function":"eval","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":186,"userId":"[UUID]","rolesCount":1,"permissionsCount":90,"organizationsCount":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.430Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/dashboards","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":126,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.430Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":156,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.430Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":187,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.430Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.430Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":187,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.430Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.430Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":187,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.430Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":187,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
Query: select "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."organization_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "users"."user_id", "users"."first_name", "users"."last_name", "users"."email", count("dashboard_charts"."chart_definition_id") from "dashboards" left join "chart_categories" on "dashboards"."dashboard_category_id" = "chart_categories"."chart_category_id" left join "users" on "dashboards"."created_by" = "users"."user_id" left join "dashboard_charts" on "dashboards"."dashboard_id" = "dashboard_charts"."dashboard_id" where ("dashboards"."is_active" = $1 and "dashboards"."is_published" = $2) group by "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."organization_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "users"."user_id", "users"."first_name", "users"."last_name", "users"."email" order by "dashboards"."created_at" desc limit $3 -- params: [true, true, 1000000]
{"@timestamp":"2025-10-15T17:44:19.435Z","level":"INFO","message":"dashboards list query completed - returned 8 of 8","service":"bendcare-os","env":"development","file":"rbac-dashboards-service.ts","line":211,"function":"RBACDashboardsServiceImpl.getDashboards","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_dashboards","resourceType":"dashboards","userId":"[UUID]","filters":{"is_active":true,"is_published":true},"filterCount":2,"results":{"returned":8,"total":8,"page":1},"empty":false,"duration":4,"slow":false,"component":"service","query":{"duration":4,"slow":false},"rbacScope":"all","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
Query: select count(*) from "dashboards" where ("dashboards"."is_active" = $1 and "dashboards"."is_published" = $2) -- params: [true, true]
{"@timestamp":"2025-10-15T17:44:19.436Z","level":"INFO","message":"dashboards counted","service":"bendcare-os","env":"development","file":"rbac-dashboards-service.ts","line":366,"function":"RBACDashboardsServiceImpl.getDashboardCount","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"count_dashboards","userId":"[UUID]","filters":{"is_active":true,"is_published":true},"count":8,"duration":1,"metadata":{"query":{"duration":1,"slow":false},"rbacScope":"all","component":"service"},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.436Z","level":"INFO","message":"dashboards list query completed - returned 8 of 8","service":"bendcare-os","env":"development","file":"route.ts","line":63,"function":"getDashboardsHandler","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_dashboards","resourceType":"dashboards","userId":"[UUID]","filters":{"is_active":true,"is_published":true},"filterCount":2,"results":{"returned":8,"total":8,"published":8,"draft":0,"hasDefault":true,"defaultDashboardId":"[UUID]","totalCharts":30,"averageChartsPerDashboard":4,"page":1,"pageSize":8},"duration":6,"slow":false,"component":"analytics","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.436Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":6,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
{"@timestamp":"2025-10-15T17:44:19.436Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa622k_x3sr6i4k","method":"GET","path":"/api/admin/analytics/dashboards","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":193,"userId":"[UUID]","statusCode":200,"totalDuration":193,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards"}}
 GET /api/admin/analytics/dashboards?is_published=true&is_active=true 200 in 239ms
{"@timestamp":"2025-10-15T17:44:19.452Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":196,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.452Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":130,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.452Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":163,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.452Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":196,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.453Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.453Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":197,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.453Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.453Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":197,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.453Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":197,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.453Z","level":"INFO","message":"Dashboard get request initiated","service":"bendcare-os","env":"development","file":"route.ts","line":30,"function":"getDashboardHandler","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":197,"dashboardId":"[UUID]","requestingUserId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
Query: select "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."organization_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."provider_uid", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "dashboards" left join "chart_categories" on "dashboards"."dashboard_category_id" = "chart_categories"."chart_category_id" left join "users" on "dashboards"."created_by" = "users"."user_id" where "dashboards"."dashboard_id" = $1 limit $2 -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47", 1]
Query: select count(*) from "dashboard_charts" where "dashboard_charts"."dashboard_id" = $1 -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47"]
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "dashboard_charts"."position_config" from "dashboard_charts" inner join "chart_definitions" on "dashboard_charts"."chart_definition_id" = "chart_definitions"."chart_definition_id" where "dashboard_charts"."dashboard_id" = $1 order by "dashboard_charts"."added_at" -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47"]
{"@timestamp":"2025-10-15T17:44:19.457Z","level":"INFO","message":"dashboard retrieved successfully","service":"bendcare-os","env":"development","file":"rbac-dashboards-service.ts","line":336,"function":"RBACDashboardsServiceImpl.getDashboardById","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"read_dashboard","resourceType":"dashboard","resourceId":"[UUID]","resourceName":"Charges","userId":"[UUID]","found":true,"duration":4,"slow":false,"component":"service","query":{"duration":2,"slow":false},"chartCountQuery":{"duration":1,"slow":false},"chartsQuery":{"duration":1,"slow":false},"chartCount":1,"rbacScope":"all","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.457Z","level":"DEBUG","message":"DB: SELECT on dashboards","service":"bendcare-os","env":"development","file":"route.ts","line":42,"function":"getDashboardHandler","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","component":"database","operation":"SELECT","table":"dashboards","duration":4,"rowCount":1,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.457Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":4,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
{"@timestamp":"2025-10-15T17:44:19.457Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa622k_1xa7mxdj","method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":201,"userId":"[UUID]","statusCode":200,"totalDuration":201,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47"}}
 GET /api/admin/analytics/dashboards/e118a803-c656-4caa-a1d1-bd501c6d3e47 200 in 243ms
{"@timestamp":"2025-10-15T17:44:19.482Z","level":"INFO","message":"GET /api/admin/analytics/charts - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.482Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/admin/analytics/charts","requiredPermissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.589Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":107,"type":"api","identifier":"::1","current":19,"remaining":181,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.589Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":107,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.589Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":107,"pathname":"/api/admin/analytics/charts","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.621Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":139,"type":"api","identifier":"::1","current":20,"remaining":180,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.621Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":139,"pathname":"/api/admin/analytics/charts","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.621Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":139,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.632Z","level":"INFO","message":"Main database connections closed","service":"bendcare-os","env":"development","file":"index.ts","line":160,"function":"process.closeDb"}
{"@timestamp":"2025-10-15T17:44:19.684Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":202,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.684Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/charts","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":63,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.684Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":95,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.684Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":202,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.684Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.684Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":202,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.684Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.684Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":202,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.684Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":202,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "chart_definitions"."data_source", "chart_definitions"."chart_config", "chart_definitions"."access_control", "chart_definitions"."data_source_id", "chart_definitions"."chart_category_id", "chart_definitions"."created_by", "chart_definitions"."created_at", "chart_definitions"."updated_at", "chart_definitions"."is_active", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."provider_uid", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "chart_definitions" left join "chart_categories" on "chart_definitions"."chart_category_id" = "chart_categories"."chart_category_id" left join "users" on "chart_definitions"."created_by" = "users"."user_id" where "chart_definitions"."is_active" = $1 order by "chart_definitions"."created_at" desc limit $2 -- params: [true, 1000000]
Query: select count(*) from "chart_definitions" where "chart_definitions"."is_active" = $1 -- params: [true]
{"@timestamp":"2025-10-15T17:44:19.689Z","level":"INFO","message":"charts list query completed - returned 15 of 15","service":"bendcare-os","env":"development","file":"route.ts","line":50,"function":"getChartsHandler","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_charts","resourceType":"chart_definitions","userId":"[UUID]","filters":{"is_active":true},"filterCount":1,"results":{"returned":15,"total":15,"chartTypeBreakdown":{"bar":5,"number":3,"stacked-bar":2,"dual-axis":2,"progress-bar":1,"table":1,"horizontal-bar":1},"activeCount":15,"inactiveCount":0},"duration":4,"slow":false,"component":"analytics","_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.690Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":5,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
{"@timestamp":"2025-10-15T17:44:19.690Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa62a0_ysnj724q","method":"GET","path":"/api/admin/analytics/charts","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":208,"userId":"[UUID]","statusCode":200,"totalDuration":208,"_contextMetadata":{"method":"GET","path":"/api/admin/analytics/charts"}}
 GET /api/admin/analytics/charts?is_active=true 200 in 225ms
üåê MIDDLEWARE: ‚úì CSRF validated for POST /api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render
{"@timestamp":"2025-10-15T17:44:19.699Z","level":"DEBUG","message":"Request sanitization completed","service":"bendcare-os","env":"development","file":"request-sanitization.ts","line":232,"function":"sanitizeRequestBody","duration":0,"hasErrors":false,"errorCount":0}
{"@timestamp":"2025-10-15T17:44:19.724Z","level":"INFO","message":"POST /api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.725Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"endpoint":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","requiredPermissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAllPermissions":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.756Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":32,"type":"api","identifier":"::1","current":21,"remaining":179,"limit":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.756Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":31,"limitType":"api","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.756Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":32,"pathname":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.790Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":66,"type":"api","identifier":"::1","current":22,"remaining":178,"limit":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.790Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":66,"pathname":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.790Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":66,"component":"auth","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.852Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":128,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.852Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":62,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.853Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":97,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.853Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":129,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.853Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.853Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":129,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.853Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"requireAll":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.853Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":129,"userId":"[UUID]","permissions":["analytics:read:all","analytics:read:organization","analytics:read:own"],"rbacDuration":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.853Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":129,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
Error: Route "/api/admin/analytics/dashboard/[dashboardId]/render" used `params.dashboardId`. `params` should be awaited before using its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis
    at renderDashboardHandler (app/api/admin/analytics/dashboard/[dashboardId]/render/route.ts:47:11)
    at eval (lib/api/rbac-route-handler.ts:261:32)
  45 |   const startTime = Date.now();
  46 |   const { params } = args[0] as RenderDashboardParams;
> 47 |   const { dashboardId } = params;
     |           ^
  48 |
  49 |   log.info('Dashboard batch render request initiated', {
  50 |     dashboardId,
{"@timestamp":"2025-10-15T17:44:19.887Z","level":"INFO","message":"Dashboard batch render request initiated","service":"bendcare-os","env":"development","file":"route.ts","line":25,"function":"renderDashboardHandler","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":163,"dashboardId":"[UUID]","userId":"[UUID]","component":"analytics","operation":"batch_render","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.888Z","level":"INFO","message":"Dashboard universal filters applied","service":"bendcare-os","env":"development","file":"route.ts","line":40,"function":"renderDashboardHandler","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":164,"dashboardId":"[UUID]","filters":{"hasDateRange":false,"dateRangePreset":"this_year","organizationId":"[UUID]"},"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.888Z","level":"INFO","message":"Dashboard batch render initiated","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":55,"function":"DashboardRenderer.renderDashboard","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":164,"dashboardId":"[UUID]","userId":"[UUID]","hasUniversalFilters":true,"organizationFilter":"[UUID]","queryDeduplicationEnabled":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
Query: select "dashboards"."dashboard_id", "dashboards"."dashboard_name", "dashboards"."dashboard_description", "dashboards"."layout_config", "dashboards"."dashboard_category_id", "dashboards"."organization_id", "dashboards"."created_by", "dashboards"."created_at", "dashboards"."updated_at", "dashboards"."is_active", "dashboards"."is_published", "dashboards"."is_default", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."provider_uid", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "dashboards" left join "chart_categories" on "dashboards"."dashboard_category_id" = "chart_categories"."chart_category_id" left join "users" on "dashboards"."created_by" = "users"."user_id" where "dashboards"."dashboard_id" = $1 limit $2 -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47", 1]
Query: select count(*) from "dashboard_charts" where "dashboard_charts"."dashboard_id" = $1 -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47"]
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "dashboard_charts"."position_config" from "dashboard_charts" inner join "chart_definitions" on "dashboard_charts"."chart_definition_id" = "chart_definitions"."chart_definition_id" where "dashboard_charts"."dashboard_id" = $1 order by "dashboard_charts"."added_at" -- params: ["e118a803-c656-4caa-a1d1-bd501c6d3e47"]
{"@timestamp":"2025-10-15T17:44:19.900Z","level":"INFO","message":"dashboard retrieved successfully","service":"bendcare-os","env":"development","file":"rbac-dashboards-service.ts","line":336,"function":"RBACDashboardsServiceImpl.getDashboardById","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"read_dashboard","resourceType":"dashboard","resourceId":"[UUID]","resourceName":"Charges","userId":"[UUID]","found":true,"duration":12,"slow":false,"component":"service","query":{"duration":10,"slow":false},"chartCountQuery":{"duration":0,"slow":false},"chartsQuery":{"duration":2,"slow":false},"chartCount":1,"rbacScope":"all","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.900Z","level":"INFO","message":"User has analytics:read:all - no practice_uid filtering","service":"bendcare-os","env":"development","file":"organization-access-service.ts","line":64,"function":"OrganizationAccessService.getAccessiblePracticeUids","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":176,"userId":"[UUID]","permissionScope":"all","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.900Z","level":"INFO","message":"Super admin can filter by any organization","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":370,"function":"DashboardRenderer.validateOrganizationFilterAccess","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":176,"userId":"[UUID]","requestedOrganizationId":"[UUID]","permissionScope":"all","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.931Z","level":"DEBUG","message":"Organization hierarchy cache hit","service":"bendcare-os","env":"development","file":"organization-hierarchy-service.ts","line":62,"function":"OrganizationHierarchyService.getAllOrganizations","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","totalOrganizations":5,"duration":31,"cacheHit":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.932Z","level":"INFO","message":"Organization hierarchy resolved","service":"bendcare-os","env":"development","file":"organization-hierarchy-service.ts","line":156,"function":"OrganizationHierarchyService.getOrganizationHierarchy","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","rootOrganizationId":"[UUID]","rootOrganizationName":"Family Arthrits Center","totalOrganizations":1,"includesChildren":false,"duration":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.932Z","level":"INFO","message":"Hierarchy practice_uids collected","service":"bendcare-os","env":"development","file":"organization-hierarchy-service.ts","line":200,"function":"OrganizationHierarchyService.getHierarchyPracticeUids","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","organizationId":"[UUID]","hierarchySize":1,"practiceUidCount":1,"practiceUids":[114],"duration":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.932Z","level":"INFO","message":"Organization practice_uids resolved for dashboard filter","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":429,"function":"DashboardRenderer.getOrganizationPracticeUids","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":208,"organizationId":"[UUID]","practiceUidCount":1,"practiceUids":[114],"includesHierarchy":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.932Z","level":"INFO","message":"Dashboard organization filter processed","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":74,"function":"DashboardRenderer.renderDashboard","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":208,"dashboardId":"[UUID]","organizationId":"[UUID]","practiceUidCount":1,"practiceUids":[114],"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
Query: select "chart_definitions"."chart_definition_id", "chart_definitions"."chart_name", "chart_definitions"."chart_description", "chart_definitions"."chart_type", "chart_definitions"."data_source", "chart_definitions"."chart_config", "chart_definitions"."access_control", "chart_definitions"."data_source_id", "chart_definitions"."chart_category_id", "chart_definitions"."created_by", "chart_definitions"."created_at", "chart_definitions"."updated_at", "chart_definitions"."is_active", "chart_categories"."chart_category_id", "chart_categories"."category_name", "chart_categories"."category_description", "chart_categories"."parent_category_id", "chart_categories"."created_at", "chart_categories"."updated_at", "users"."user_id", "users"."email", "users"."first_name", "users"."last_name", "users"."password_hash", "users"."email_verified", "users"."is_active", "users"."provider_uid", "users"."created_at", "users"."updated_at", "users"."deleted_at" from "chart_definitions" left join "chart_categories" on "chart_definitions"."chart_category_id" = "chart_categories"."chart_category_id" left join "users" on "chart_definitions"."created_by" = "users"."user_id" where "chart_definitions"."chart_definition_id" = $1 limit $2 -- params: ["60ffd8fd-d938-4256-8d9e-d4d0e0ae7164", 1]
{"@timestamp":"2025-10-15T17:44:19.934Z","level":"INFO","message":"Dashboard charts loaded","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":136,"function":"DashboardRenderer.renderDashboard","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":210,"dashboardId":"[UUID]","totalCharts":1,"validCharts":1,"chartTypes":["bar"],"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.934Z","level":"INFO","message":"Processing chart in batch","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":154,"function":"eval","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":210,"chartId":"[UUID]","chartName":"Charges by Provider","chartType":"bar","batchSupported":true,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.934Z","level":"INFO","message":"Batch chart config prepared","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":222,"function":"eval","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":210,"chartId":"[UUID]","chartType":"bar","chartName":"Charges by Provider","hasGroupBy":true,"groupByValue":"provider_name","hasDualAxisConfig":false,"hasAggregation":false,"runtimeFilterKeys":"[REDACTED]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.934Z","level":"DEBUG","message":"Query hash generated","service":"bendcare-os","env":"development","file":"dashboard-query-cache.ts","line":95,"function":"generateQueryHash","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":210,"dataSourceId":1,"measure":"Charges by Provider","hashLength":64,"signatureKeys":"[REDACTED]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.934Z","level":"INFO","message":"Query cache miss - executing query","service":"bendcare-os","env":"development","file":"dashboard-query-cache.ts","line":161,"function":"DashboardQueryCache.get","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":210,"queryHash":"[PHONE]","cacheSize":0,"deduplication":"miss","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.934Z","level":"INFO","message":"Chart configuration resolved","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":28,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":210,"chartType":"bar","dataSourceId":1,"hasRuntimeFilters":true,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
Query: select "data_source_id", "data_source_name", "data_source_description", "table_name", "schema_name", "database_type", "connection_config", "is_active", "requires_auth", "created_at", "updated_at", "created_by" from "chart_data_sources" where "chart_data_sources"."data_source_id" = $1 -- params: [1]
Query: select count(*) from "chart_data_source_columns" where ("chart_data_source_columns"."data_source_id" = $1 and "chart_data_source_columns"."is_active" = $2) -- params: [1, true]
{"@timestamp":"2025-10-15T17:44:19.936Z","level":"INFO","message":"Data source access check passed","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":207,"function":"ChartDataOrchestrator.verifyDataSourceAccess","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":212,"dataSourceId":1,"dataSourceName":"Practice Analytics","userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.936Z","level":"INFO","message":"Data source access verified","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":36,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":212,"dataSourceId":1,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.936Z","level":"INFO","message":"Runtime filters merged","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":42,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":212,"chartType":"bar","hasStartDate":true,"hasEndDate":true,"hasPracticeUid":false,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.936Z","level":"INFO","message":"Chart handler retrieved","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":55,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":212,"chartType":"bar","handlerType":"bar","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.936Z","level":"INFO","message":"Chart configuration validated","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":64,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":212,"chartType":"bar","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.936Z","level":"INFO","message":"dashboard organization filter applied","service":"bendcare-os","env":"development","file":"base-handler.ts","line":167,"function":"BarChartHandler.buildQueryParams","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":212,"operation":"build_query_params","practiceUidCount":1,"practiceUids":[114],"source":"dashboard_universal_filter","component":"chart-handler","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.936Z","level":"INFO","message":"Fetching chart data with Redis cache integration","service":"bendcare-os","env":"development","file":"base-handler.ts","line":42,"function":"BarChartHandler.fetchData","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":212,"chartType":"bar","dataSourceId":1,"userId":"[UUID]","hasDataSourceId":true,"note":"Passing UserContext to enable Redis cache path","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.936Z","level":"INFO","message":"Building analytics query with caching","service":"bendcare-os","env":"development","file":"analytics-query-builder.ts","line":325,"function":"AnalyticsQueryBuilder.queryMeasures","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":212,"params":{"data_source_id":1,"start_date":"2025-01-01","end_date":"2025-12-31","limit":10000,"measure":"Charges by Provider","advanced_filters":[{"field":"practice_uid","operator":"in","value":[114]}]},"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.969Z","level":"DEBUG","message":"Data source config cache hit","service":"bendcare-os","env":"development","file":"chart-config-cache.ts","line":50,"function":"ChartConfigCacheService.getDataSourceConfig","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":245,"component":"chart-config-cache","dataSourceId":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:19.969Z","level":"DEBUG","message":"Chart context built","service":"bendcare-os","env":"development","file":"chart-context.ts","line":46,"function":"buildChartRenderContext","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","userId":"[UUID]","permissionScope":"all","practiceCount":0,"providerCount":0,"organizationCount":0,"includesHierarchy":false,"duration":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.161Z","level":"INFO","message":"Registering chart type handlers","service":"bendcare-os","env":"development","file":"index.ts","line":43,"function":"registerAllHandlers"}
{"@timestamp":"2025-10-15T17:44:20.163Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"line","totalHandlers":1}
{"@timestamp":"2025-10-15T17:44:20.163Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"bar","totalHandlers":2}
{"@timestamp":"2025-10-15T17:44:20.163Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"pie","totalHandlers":3}
{"@timestamp":"2025-10-15T17:44:20.163Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"table","totalHandlers":4}
{"@timestamp":"2025-10-15T17:44:20.163Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"number","totalHandlers":5}
{"@timestamp":"2025-10-15T17:44:20.164Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"progress-bar","totalHandlers":6}
{"@timestamp":"2025-10-15T17:44:20.164Z","level":"INFO","message":"Chart type handler registered","service":"bendcare-os","env":"development","file":"chart-type-registry.ts","line":24,"function":"ChartTypeRegistry.register","chartType":"dual-axis","totalHandlers":7}
{"@timestamp":"2025-10-15T17:44:20.164Z","level":"INFO","message":"Chart type handlers registered successfully","service":"bendcare-os","env":"development","file":"index.ts","line":66,"function":"registerAllHandlers","count":7,"types":["line","bar","pie","table","number","progress-bar","dual-axis"]}
{"@timestamp":"2025-10-15T17:44:20.182Z","level":"INFO","message":"Main database connections closed","service":"bendcare-os","env":"development","file":"index.ts","line":160,"function":"process.closeDb"}
{"@timestamp":"2025-10-15T17:44:20.364Z","level":"INFO","message":"Data source cache hit","service":"bendcare-os","env":"development","file":"data-source-cache.ts","line":146,"function":"DataSourceCacheService.getCached","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":640,"cacheKey":"[REDACTED]","cacheLevel":0,"rowCount":4462,"sizeKB":1238,"cachedAt":"2025-10-15T17:37:28.635Z","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.364Z","level":"WARN","message":"Security: RBAC filter: all scope, no filtering","service":"bendcare-os","env":"development","file":"data-source-cache.ts","line":472,"function":"DataSourceCacheService.applyRBACFilter","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":640,"component":"security","event":"RBAC filter: all scope, no filtering","severity":"low","userId":"[UUID]","rowCount":4462,"permissionScope":"all","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.364Z","level":"DEBUG","message":"Column mapping cache hit","service":"bendcare-os","env":"development","file":"column-mapping-service.ts","line":56,"function":"ColumnMappingService.getMapping","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":640,"component":"column-mapping-service","dataSourceId":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.365Z","level":"INFO","message":"Data source served from cache (server-filtered)","service":"bendcare-os","env":"development","file":"data-source-cache.ts","line":615,"function":"DataSourceCacheService.fetchDataSource","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","cacheKey":"[REDACTED]","cacheLevel":0,"cachedRowCount":4462,"afterRBAC":3368,"finalRowCount":3368,"duration":395,"userId":"[UUID]","permissionScope":"all","security":"filtered_before_client_send","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.365Z","level":"DEBUG","message":"Column mapping cache hit","service":"bendcare-os","env":"development","file":"column-mapping-service.ts","line":56,"function":"ColumnMappingService.getMapping","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":641,"component":"column-mapping-service","dataSourceId":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.365Z","level":"INFO","message":"Analytics query completed (with caching)","service":"bendcare-os","env":"development","file":"analytics-query-builder.ts","line":391,"function":"AnalyticsQueryBuilder.queryMeasures","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","dataSourceId":1,"measure":"Charges by Provider","rowCount":3368,"totalCount":2321011858,"duration":429,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.365Z","level":"INFO","message":"Chart data fetched successfully","service":"bendcare-os","env":"development","file":"base-handler.ts","line":54,"function":"BarChartHandler.fetchData","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":641,"chartType":"bar","recordCount":3368,"queryTimeMs":429,"cacheHit":true,"fetchDuration":429,"userId":"[UUID]","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.365Z","level":"INFO","message":"Chart data fetched","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":71,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":641,"chartType":"bar","recordCount":3368,"fetchDuration":429,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.365Z","level":"INFO","message":"Transforming bar chart data","service":"bendcare-os","env":"development","file":"bar-chart-handler.ts","line":41,"function":"BarChartHandler.transform","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":641,"chartType":"bar","recordCount":3368,"groupBy":"provider_name","colorPalette":"default","_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.367Z","level":"INFO","message":"Bar chart data transformed","service":"bendcare-os","env":"development","file":"bar-chart-handler.ts","line":70,"function":"BarChartHandler.transform","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","chartType":"bar","duration":2,"datasetCount":300,"labelCount":12,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.367Z","level":"INFO","message":"Chart data transformed","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":80,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":643,"chartType":"bar","datasetCount":300,"labelCount":12,"transformDuration":2,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.367Z","level":"INFO","message":"Chart data orchestration completed","service":"bendcare-os","env":"development","file":"chart-data-orchestrator.ts","line":111,"function":"ChartDataOrchestrator.orchestrate","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":643,"chartType":"bar","totalDuration":433,"fetchDuration":429,"transformDuration":2,"recordCount":3368,"hasColumns":false,"columnCount":0,"hasFormattedData":false,"formattedRowCount":0,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.367Z","level":"INFO","message":"Dashboard batch render completed","service":"bendcare-os","env":"development","file":"dashboard-renderer.ts","line":306,"function":"DashboardRenderer.renderDashboard","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","dashboardId":"[UUID]","chartsRendered":1,"cacheHits":0,"cacheMisses":1,"totalQueryTime":429,"parallelDuration":433,"duration":479,"queryDeduplication":{"uniqueQueries":1,"queriesDeduped":0,"deduplicationRate":"0%","totalCharts":1,"queriesSaved":0},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.367Z","level":"INFO","message":"Query cache cleared","service":"bendcare-os","env":"development","file":"dashboard-query-cache.ts","line":184,"function":"DashboardQueryCache.clear","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":643,"uniqueQueries":1,"queriesDeduped":0,"deduplicationRate":"0%","totalRequests":1,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.367Z","level":"INFO","message":"Dashboard batch render completed","service":"bendcare-os","env":"development","file":"route.ts","line":58,"function":"renderDashboardHandler","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","dashboardId":"[UUID]","userId":"[UUID]","component":"analytics","operation":"batch_render","duration":514,"metrics":{"chartsRendered":1,"queriesExecuted":1,"cacheHits":0,"cacheMisses":1,"cacheHitRate":0,"totalQueryTime":429,"parallelExecution":true,"filtersApplied":3,"nocache":false},"slow":false,"performance":{"target":2000,"actual":514,"overTarget":false},"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.371Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":518,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
{"@timestamp":"2025-10-15T17:44:20.371Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa62gi_e9geuwsr","method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":647,"userId":"[UUID]","statusCode":200,"totalDuration":647,"_contextMetadata":{"method":"POST","path":"/api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render"}}
 POST /api/admin/analytics/dashboard/e118a803-c656-4caa-a1d1-bd501c6d3e47/render 200 in 670ms
{"@timestamp":"2025-10-15T17:44:20.407Z","level":"INFO","message":"GET /api/organizations - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.407Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/organizations","requiredPermissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.438Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":31,"type":"api","identifier":"::1","current":23,"remaining":177,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.438Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":31,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.438Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":31,"pathname":"/api/organizations","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.471Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":64,"type":"api","identifier":"::1","current":24,"remaining":176,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.471Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":64,"pathname":"/api/organizations","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.471Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":64,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.612Z","level":"DEBUG","message":"Loading user context","service":"bendcare-os","env":"development","file":"user-context.ts","line":304,"function":"getUserContextSafe","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":205,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
Query: select "user_id", "email", "first_name", "last_name", "is_active", "email_verified", "created_at", "updated_at" from "users" where "users"."user_id" = $1 limit $2 -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", 1]
Query: select "user_organizations"."user_organization_id", "user_organizations"."user_id", "user_organizations"."organization_id", "user_organizations"."is_active", "user_organizations"."joined_at", "user_organizations"."created_at", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at" from "user_organizations" inner join "organizations" on "user_organizations"."organization_id" = "organizations"."organization_id" where ("user_organizations"."user_id" = $1 and "user_organizations"."is_active" = $2 and "organizations"."is_active" = $3) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true]
Query: select distinct "user_roles"."user_role_id", "user_roles"."user_id", "user_roles"."role_id", "user_roles"."organization_id", "user_roles"."granted_by", "user_roles"."granted_at", "user_roles"."expires_at", "user_roles"."is_active", "user_roles"."created_at", "roles"."name", "roles"."description", "roles"."organization_id", "roles"."is_system_role", "roles"."is_active", "roles"."created_at", "roles"."updated_at", "roles"."deleted_at", "permissions"."permission_id", "permissions"."name", "permissions"."description", "permissions"."resource", "permissions"."action", "permissions"."scope", "permissions"."is_active", "permissions"."created_at", "permissions"."updated_at" from "user_roles" inner join "roles" on "user_roles"."role_id" = "roles"."role_id" inner join "role_permissions" on "roles"."role_id" = "role_permissions"."role_id" inner join "permissions" on "role_permissions"."permission_id" = "permissions"."permission_id" where ("user_roles"."user_id" = $1 and "user_roles"."is_active" = $2 and "roles"."is_active" = $3 and "permissions"."is_active" = $4) -- params: ["cfd640bd-fcb6-4a78-ab0f-0bc8f0ab8d0f", true, true, true]
{"@timestamp":"2025-10-15T17:44:20.628Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"user-context.ts","line":314,"function":"eval","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":221,"userId":"[UUID]","rolesCount":1,"permissionsCount":90,"organizationsCount":0,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.628Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/organizations","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":157,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.628Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":190,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.629Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":222,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.629Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.629Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":222,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.629Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","permissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.629Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":222,"userId":"[UUID]","permissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"rbacDuration":0,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.629Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":222,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
Query: select "organizations"."organization_id", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at", "practices"."practice_id", "practices"."domain", "practices"."status", "practices"."template_id" from "organizations" left join "practices" on "organizations"."organization_id" = "practices"."practice_id" where ("organizations"."is_active" = $1 and "organizations"."deleted_at" is null and "organizations"."is_active" = $2) order by "organizations"."created_at" desc -- params: [true, true]
Query: select "organization_id", count(*) from "user_organizations" where ("user_organizations"."organization_id" in ($1, $2, $3, $4, $5) and "user_organizations"."is_active" = $6) group by "user_organizations"."organization_id" -- params: ["d9e5bd24-b104-4ff5-a219-678eedb31aaa", "4e23ee8f-33b1-4a6a-a371-0437d01c40d6", "7b70e645-82f2-4b18-8b22-db946991f6d5", "640c5969-74bc-4189-a455-81bf26f74829", "13f5a859-91ba-46ad-a4d1-40fb7a2996f2", true]
Query: select "parent_organization_id", count(*) from "organizations" where ("organizations"."parent_organization_id" in ($1, $2, $3, $4, $5) and "organizations"."parent_organization_id" is not null and "organizations"."is_active" = $6 and "organizations"."deleted_at" is null) group by "organizations"."parent_organization_id" -- params: ["d9e5bd24-b104-4ff5-a219-678eedb31aaa", "4e23ee8f-33b1-4a6a-a371-0437d01c40d6", "7b70e645-82f2-4b18-8b22-db946991f6d5", "640c5969-74bc-4189-a455-81bf26f74829", "13f5a859-91ba-46ad-a4d1-40fb7a2996f2", true]
{"@timestamp":"2025-10-15T17:44:20.636Z","level":"INFO","message":"organizations list query completed - returned 5 of 5","service":"bendcare-os","env":"development","file":"index.ts","line":257,"function":"OrganizationsService.getOrganizations","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_organizations","resourceType":"organizations","userId":"[UUID]","filters":{"is_active":true},"filterCount":1,"results":{"returned":5,"total":5,"page":1,"hasMore":false},"empty":false,"duration":5,"slow":false,"component":"service","query":{"duration":3,"slow":false},"enrichment":{"duration":2,"slow":false},"rbacScope":"all","batchOptimized":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.636Z","level":"INFO","message":"organizations list query completed - returned 5 organizations","service":"bendcare-os","env":"development","file":"route.ts","line":67,"function":"getOrganizationsHandler","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_organizations","resourceType":"organizations","userId":"[UUID]","isSuperAdmin":true,"filters":{"is_active":true},"filterCount":1,"results":{"returned":5,"active":5,"inactive":0,"page":1,"pageSize":10},"sort":{"field":"created_at","direction":"desc"},"duration":7,"slow":false,"component":"business-logic","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.637Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":8,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.637Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa62zn_9b3akppa","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":230,"userId":"[UUID]","statusCode":200,"totalDuration":230,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
 GET /api/organizations?is_active=true 200 in 251ms
{"@timestamp":"2025-10-15T17:44:20.780Z","level":"INFO","message":"GET /api/organizations - RBAC route","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":47,"function":"eval","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"component":"api","request":{},"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.780Z","level":"INFO","message":"RBAC route initiated","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":48,"function":"eval","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"endpoint":"/api/organizations","requiredPermissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"requireAllPermissions":false,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.816Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":36,"type":"api","identifier":"::1","current":25,"remaining":175,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.816Z","level":"INFO","message":"Rate limit check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":61,"function":"eval","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":36,"limitType":"api","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.816Z","level":"DEBUG","message":"API auth check initiated","service":"bendcare-os","env":"development","file":"global-auth.ts","line":65,"function":"applyGlobalAuth","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":36,"pathname":"/api/organizations","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.847Z","level":"DEBUG","message":"Rate limit check passed","service":"bendcare-os","env":"development","file":"rate-limit.ts","line":94,"function":"applyRateLimit","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":67,"type":"api","identifier":"::1","current":26,"remaining":174,"limit":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.847Z","level":"DEBUG","message":"Using httpOnly cookie for authentication","service":"bendcare-os","env":"development","file":"global-auth.ts","line":100,"function":"applyGlobalAuth","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":67,"pathname":"/api/organizations","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.848Z","level":"DEBUG","message":"Using access token from httpOnly cookie","service":"bendcare-os","env":"development","file":"auth.ts","line":36,"function":"requireAuth","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":68,"component":"auth","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.914Z","level":"DEBUG","message":"User context cache hit","service":"bendcare-os","env":"development","file":"user-context.ts","line":288,"function":"getUserContextSafe","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":134,"userId":"[UUID]","operation":"getUserContext","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.915Z","level":"INFO","message":"API authentication successful","service":"bendcare-os","env":"development","file":"global-auth.ts","line":122,"function":"applyGlobalAuth","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","pathname":"/api/organizations","userId":"[UUID]","userEmail":"[REDACTED]","authMethod":"httponly_cookie","duration":67,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.915Z","level":"INFO","message":"Global auth check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":71,"function":"eval","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":99,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.916Z","level":"DEBUG","message":"Global authentication completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":74,"function":"eval","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":136,"hasSession":true,"hasUser":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.916Z","level":"INFO","message":"User context retrieved from session","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":145,"function":"eval","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":0,"userId":"[UUID]","cached":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.916Z","level":"DEBUG","message":"User context loaded successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":167,"function":"eval","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":136,"userId":"[UUID]","roleCount":1,"permissionCount":90,"isSuperAdmin":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.917Z","level":"INFO","message":"RBAC permission check completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":183,"function":"eval","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":1,"userId":"[UUID]","permissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"requireAll":false,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.917Z","level":"INFO","message":"RBAC permission check passed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":192,"function":"eval","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":137,"userId":"[UUID]","permissions":["organizations:read:own","organizations:read:organization","organizations:read:all"],"rbacDuration":1,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.918Z","level":"INFO","message":"Auth: rbac_check","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":199,"function":"eval","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":138,"component":"auth","action":"rbac_check","success":true,"userId":"[UUID]","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
Query: select "organizations"."organization_id", "organizations"."name", "organizations"."slug", "organizations"."parent_organization_id", "organizations"."is_active", "organizations"."created_at", "organizations"."updated_at", "organizations"."deleted_at", "practices"."practice_id", "practices"."domain", "practices"."status", "practices"."template_id" from "organizations" left join "practices" on "organizations"."organization_id" = "practices"."practice_id" where ("organizations"."is_active" = $1 and "organizations"."deleted_at" is null and "organizations"."is_active" = $2) order by "organizations"."created_at" desc -- params: [true, true]
Query: select "organization_id", count(*) from "user_organizations" where ("user_organizations"."organization_id" in ($1, $2, $3, $4, $5) and "user_organizations"."is_active" = $6) group by "user_organizations"."organization_id" -- params: ["d9e5bd24-b104-4ff5-a219-678eedb31aaa", "4e23ee8f-33b1-4a6a-a371-0437d01c40d6", "7b70e645-82f2-4b18-8b22-db946991f6d5", "640c5969-74bc-4189-a455-81bf26f74829", "13f5a859-91ba-46ad-a4d1-40fb7a2996f2", true]
Query: select "parent_organization_id", count(*) from "organizations" where ("organizations"."parent_organization_id" in ($1, $2, $3, $4, $5) and "organizations"."parent_organization_id" is not null and "organizations"."is_active" = $6 and "organizations"."deleted_at" is null) group by "organizations"."parent_organization_id" -- params: ["d9e5bd24-b104-4ff5-a219-678eedb31aaa", "4e23ee8f-33b1-4a6a-a371-0437d01c40d6", "7b70e645-82f2-4b18-8b22-db946991f6d5", "640c5969-74bc-4189-a455-81bf26f74829", "13f5a859-91ba-46ad-a4d1-40fb7a2996f2", true]
{"@timestamp":"2025-10-15T17:44:20.924Z","level":"INFO","message":"organizations list query completed - returned 5 of 5","service":"bendcare-os","env":"development","file":"index.ts","line":257,"function":"OrganizationsService.getOrganizations","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_organizations","resourceType":"organizations","userId":"[UUID]","filters":{"is_active":true},"filterCount":1,"results":{"returned":5,"total":5,"page":1,"hasMore":false},"empty":false,"duration":5,"slow":false,"component":"service","query":{"duration":3,"slow":false},"enrichment":{"duration":2,"slow":false},"rbacScope":"all","batchOptimized":true,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.924Z","level":"INFO","message":"organizations list query completed - returned 5 organizations","service":"bendcare-os","env":"development","file":"route.ts","line":67,"function":"getOrganizationsHandler","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","operation":"list_organizations","resourceType":"organizations","userId":"[UUID]","isSuperAdmin":true,"filters":{"is_active":true},"filterCount":1,"results":{"returned":5,"active":5,"inactive":0,"page":1,"pageSize":10},"sort":{"field":"created_at","direction":"desc"},"duration":6,"slow":false,"component":"business-logic","_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.925Z","level":"INFO","message":"Handler execution completed","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":205,"function":"eval","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":7,"userId":"[UUID]","statusCode":200,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
{"@timestamp":"2025-10-15T17:44:20.925Z","level":"INFO","message":"RBAC route completed successfully","service":"bendcare-os","env":"development","file":"rbac-route-handler.ts","line":211,"function":"eval","correlationId":"cor_mgsa639n_eragnxns","method":"GET","path":"/api/organizations","ipAddress":"::1","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36","duration":145,"userId":"[UUID]","statusCode":200,"totalDuration":145,"_contextMetadata":{"method":"GET","path":"/api/organizations"}}
 GET /api/organizations?is_active=true 200 in 177ms

