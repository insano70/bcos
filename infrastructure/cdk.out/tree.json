{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.215.0"},"children":{"BCOS-SecurityStack":{"id":"BCOS-SecurityStack","path":"BCOS-SecurityStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.215.0"},"children":{"BCOSEncryptionKey":{"id":"BCOSEncryptionKey","path":"BCOS-SecurityStack/BCOSEncryptionKey","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.Key","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-SecurityStack/BCOSEncryptionKey/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.CfnKey","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::KMS::Key","aws:cdk:cloudformation:props":{"description":"BCOS encryption key for logs, secrets, and ECR","enableKeyRotation":true,"keyPolicy":{"Statement":[{"Action":"kms:*","Effect":"Allow","Principal":{"AWS":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::854428944440:root"]]}},"Resource":"*","Sid":"Enable IAM User Permissions"},{"Action":["kms:Decrypt","kms:DescribeKey","kms:Encrypt","kms:GenerateDataKey*","kms:ReEncrypt*"],"Effect":"Allow","Principal":{"Service":"logs.amazonaws.com"},"Resource":"*","Sid":"Allow CloudWatch Logs"},{"Action":["kms:Decrypt","kms:DescribeKey","kms:GenerateDataKey"],"Effect":"Allow","Principal":{"Service":"ecr.amazonaws.com"},"Resource":"*","Sid":"Allow ECR Service"},{"Action":["kms:CreateGrant","kms:Decrypt","kms:DescribeKey","kms:Encrypt","kms:GenerateDataKey*","kms:ReEncrypt*"],"Condition":{"StringEquals":{"kms:ViaService":"secretsmanager.us-east-1.amazonaws.com"}},"Effect":"Allow","Principal":{"AWS":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::854428944440:root"]]}},"Resource":"*"},{"Action":"kms:Decrypt","Condition":{"StringEquals":{"kms:ViaService":"secretsmanager.us-east-1.amazonaws.com"}},"Effect":"Allow","Principal":{"AWS":[{"Fn::GetAtt":["ECSTaskExecutionRole911F5A4F","Arn"]},{"Fn::GetAtt":["ECSTaskRoleF2ADB362","Arn"]}]},"Resource":"*"}],"Version":"2012-10-17"}}}},"Alias":{"id":"Alias","path":"BCOS-SecurityStack/BCOSEncryptionKey/Alias","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.Alias","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-SecurityStack/BCOSEncryptionKey/Alias/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.CfnAlias","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::KMS::Alias","aws:cdk:cloudformation:props":{"aliasName":"alias/bcos-encryption","targetKeyId":{"Fn::GetAtt":["BCOSEncryptionKeyA46A0152","Arn"]}}}}}}}},"BCOSRepository":{"id":"BCOSRepository","path":"BCOS-SecurityStack/BCOSRepository","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.Repository","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-SecurityStack/BCOSRepository/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.CfnRepository","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECR::Repository","aws:cdk:cloudformation:props":{"encryptionConfiguration":{"encryptionType":"KMS","kmsKey":{"Fn::GetAtt":["BCOSEncryptionKeyA46A0152","Arn"]}},"imageScanningConfiguration":{"scanOnPush":true},"imageTagMutability":"MUTABLE","lifecyclePolicy":{"lifecyclePolicyText":"{\"rules\":[{\"rulePriority\":1,\"description\":\"Keep last 10 production images\",\"selection\":{\"tagStatus\":\"tagged\",\"tagPrefixList\":[\"v\",\"release\"],\"countType\":\"imageCountMoreThan\",\"countNumber\":10},\"action\":{\"type\":\"expire\"}},{\"rulePriority\":2,\"description\":\"Keep last 5 staging images\",\"selection\":{\"tagStatus\":\"tagged\",\"tagPrefixList\":[\"staging\"],\"countType\":\"imageCountMoreThan\",\"countNumber\":5},\"action\":{\"type\":\"expire\"}},{\"rulePriority\":3,\"description\":\"Delete untagged images after 7 days\",\"selection\":{\"tagStatus\":\"untagged\",\"countType\":\"sinceImagePushed\",\"countNumber\":7,\"countUnit\":\"days\"},\"action\":{\"type\":\"expire\"}}]}"},"repositoryName":"bcos"}}}}},"GitHubOidcProvider":{"id":"GitHubOidcProvider","path":"BCOS-SecurityStack/GitHubOidcProvider","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.OpenIdConnectProvider","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-SecurityStack/GitHubOidcProvider/Resource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.215.0","metadata":[]},"children":{"Default":{"id":"Default","path":"BCOS-SecurityStack/GitHubOidcProvider/Resource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.215.0"}}}}}},"Custom::AWSCDKOpenIdConnectProviderCustomResourceProvider":{"id":"Custom::AWSCDKOpenIdConnectProviderCustomResourceProvider","path":"BCOS-SecurityStack/Custom::AWSCDKOpenIdConnectProviderCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.215.0"},"children":{"Staging":{"id":"Staging","path":"BCOS-SecurityStack/Custom::AWSCDKOpenIdConnectProviderCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.215.0"}},"Role":{"id":"Role","path":"BCOS-SecurityStack/Custom::AWSCDKOpenIdConnectProviderCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.215.0"}},"Handler":{"id":"Handler","path":"BCOS-SecurityStack/Custom::AWSCDKOpenIdConnectProviderCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.215.0"}}}},"GitHubActionsRole":{"id":"GitHubActionsRole","path":"BCOS-SecurityStack/GitHubActionsRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.215.0","metadata":[]},"children":{"ImportGitHubActionsRole":{"id":"ImportGitHubActionsRole","path":"BCOS-SecurityStack/GitHubActionsRole/ImportGitHubActionsRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"Resource":{"id":"Resource","path":"BCOS-SecurityStack/GitHubActionsRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRoleWithWebIdentity","Condition":{"StringEquals":{"token.actions.githubusercontent.com:aud":"sts.amazonaws.com","token.actions.githubusercontent.com:iss":"https://token.actions.githubusercontent.com"},"StringLike":{"token.actions.githubusercontent.com:sub":["repo:pstewart/bcos:ref:refs/heads/main","repo:pstewart/bcos:ref:refs/heads/staging"]}},"Effect":"Allow","Principal":{"Federated":{"Ref":"GitHubOidcProvider7EBF861F"}}}],"Version":"2012-10-17"},"description":"Role for GitHub Actions to deploy BCOS application","maxSessionDuration":3600,"roleName":"BCOS-GitHubActionsDeploymentRole"}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"BCOS-SecurityStack/GitHubActionsRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-SecurityStack/GitHubActionsRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"ecr:GetAuthorizationToken","Effect":"Allow","Resource":"*","Sid":"ECRAccess"},{"Action":["ecr:BatchCheckLayerAvailability","ecr:BatchGetImage","ecr:CompleteLayerUpload","ecr:DescribeImages","ecr:GetDownloadUrlForLayer","ecr:InitiateLayerUpload","ecr:PutImage","ecr:UploadLayerPart"],"Effect":"Allow","Resource":{"Fn::GetAtt":["BCOSRepository8278F407","Arn"]},"Sid":"ECRRepository"},{"Action":["ecs:CreateService","ecs:DescribeServices","ecs:RegisterTaskDefinition","ecs:UpdateService"],"Effect":"Allow","Resource":["arn:aws:ecs:us-east-1:854428944440:cluster/bcos-*-cluster","arn:aws:ecs:us-east-1:854428944440:service/bcos-*-cluster/bcos-*-service","arn:aws:ecs:us-east-1:854428944440:task-definition/bcos-*"],"Sid":"ECSAccess"},{"Action":"ecs:DescribeTaskDefinition","Effect":"Allow","Resource":"*","Sid":"ECSDescribeTaskDefinition"},{"Action":["logs:CreateLogGroup","logs:PutRetentionPolicy","logs:TagLogGroup"],"Effect":"Allow","Resource":["arn:aws:logs:us-east-1:854428944440:log-group:/ecs/bcos-*","arn:aws:logs:us-east-1:854428944440:log-group:/ecs/bcos-*:*"],"Sid":"CloudWatchLogsAccess"},{"Action":"logs:DescribeLogGroups","Effect":"Allow","Resource":"*","Sid":"CloudWatchLogsDescribe"},{"Action":["ssm:GetParameter","ssm:GetParameters"],"Effect":"Allow","Resource":"arn:aws:ssm:us-east-1:854428944440:parameter/cdk-bootstrap/*","Sid":"SSMBootstrapAccess"},{"Action":"sts:AssumeRole","Effect":"Allow","Resource":["arn:aws:iam::854428944440:role/cdk-hnb659fds-deploy-role-854428944440-us-east-1","arn:aws:iam::854428944440:role/cdk-hnb659fds-file-publishing-role-854428944440-us-east-1","arn:aws:iam::854428944440:role/cdk-hnb659fds-lookup-role-854428944440-us-east-1"],"Sid":"CDKBootstrapAssumeRoles"},{"Action":["s3:GetBucketLocation","s3:GetObject","s3:ListBucket","s3:PutObject"],"Effect":"Allow","Resource":["arn:aws:s3:::cdk-hnb659fds-assets-854428944440-us-east-1","arn:aws:s3:::cdk-hnb659fds-assets-854428944440-us-east-1/*"],"Sid":"CDKAssetsBucketAccess"},{"Action":["cloudformation:CreateChangeSet","cloudformation:CreateStack","cloudformation:DeleteChangeSet","cloudformation:DeleteStack","cloudformation:DescribeChangeSet","cloudformation:DescribeStackEvents","cloudformation:DescribeStackResources","cloudformation:DescribeStacks","cloudformation:ExecuteChangeSet","cloudformation:GetStackPolicy","cloudformation:GetTemplate","cloudformation:ListChangeSets","cloudformation:ListStackResources","cloudformation:UpdateStack"],"Effect":"Allow","Resource":"arn:aws:cloudformation:us-east-1:854428944440:stack/BCOS-*/*","Sid":"CloudFormationAccess"},{"Action":"iam:PassRole","Condition":{"StringEquals":{"iam:PassedToService":"ecs-tasks.amazonaws.com"}},"Effect":"Allow","Resource":[{"Fn::GetAtt":["ECSTaskExecutionRole911F5A4F","Arn"]},{"Fn::GetAtt":["ECSTaskRoleF2ADB362","Arn"]}],"Sid":"PassRole"}],"Version":"2012-10-17"},"policyName":"GitHubActionsRoleDefaultPolicy69DA0189","roles":[{"Ref":"GitHubActionsRole4F1BBA26"}]}}}}}}},"ECSTaskExecutionRole":{"id":"ECSTaskExecutionRole","path":"BCOS-SecurityStack/ECSTaskExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.215.0","metadata":[]},"children":{"ImportECSTaskExecutionRole":{"id":"ImportECSTaskExecutionRole","path":"BCOS-SecurityStack/ECSTaskExecutionRole/ImportECSTaskExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"Resource":{"id":"Resource","path":"BCOS-SecurityStack/ECSTaskExecutionRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ecs-tasks.amazonaws.com"}}],"Version":"2012-10-17"},"description":"ECS Task Execution Role for BCOS application","managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"]]}],"roleName":"BCOS-ECSTaskExecutionRole"}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"BCOS-SecurityStack/ECSTaskExecutionRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-SecurityStack/ECSTaskExecutionRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["kms:Decrypt","kms:DescribeKey"],"Effect":"Allow","Resource":{"Fn::GetAtt":["BCOSEncryptionKeyA46A0152","Arn"]}},{"Action":["secretsmanager:DescribeSecret","secretsmanager:GetSecretValue"],"Effect":"Allow","Resource":[{"Ref":"ProductionSecrets9110CDFF"},{"Ref":"StagingSecrets66638D5D"}]}],"Version":"2012-10-17"},"policyName":"ECSTaskExecutionRoleDefaultPolicyC25F7D27","roles":[{"Ref":"ECSTaskExecutionRole911F5A4F"}]}}}}}}},"ECSTaskRole":{"id":"ECSTaskRole","path":"BCOS-SecurityStack/ECSTaskRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.215.0","metadata":[]},"children":{"ImportECSTaskRole":{"id":"ImportECSTaskRole","path":"BCOS-SecurityStack/ECSTaskRole/ImportECSTaskRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"Resource":{"id":"Resource","path":"BCOS-SecurityStack/ECSTaskRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ecs-tasks.amazonaws.com"}}],"Version":"2012-10-17"},"description":"ECS Task Role for BCOS application runtime permissions","roleName":"BCOS-ECSTaskRole"}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"BCOS-SecurityStack/ECSTaskRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-SecurityStack/ECSTaskRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["secretsmanager:DescribeSecret","secretsmanager:GetSecretValue"],"Effect":"Allow","Resource":[{"Ref":"ProductionSecrets9110CDFF"},{"Ref":"StagingSecrets66638D5D"}]}],"Version":"2012-10-17"},"policyName":"ECSTaskRoleDefaultPolicy82FC9293","roles":[{"Ref":"ECSTaskRoleF2ADB362"}]}}}}}}},"ProductionSecrets":{"id":"ProductionSecrets","path":"BCOS-SecurityStack/ProductionSecrets","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-SecurityStack/ProductionSecrets/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Production secrets for BCOS application","generateSecretString":{"secretStringTemplate":"{\"NODE_ENV\":\"production\",\"PORT\":\"4001\"}","generateStringKey":"JWT_SECRET","excludeCharacters":"\"@/\\","includeSpace":false,"passwordLength":64},"kmsKeyId":{"Fn::GetAtt":["BCOSEncryptionKeyA46A0152","Arn"]},"name":"production/bcos-secrets"}}}}},"StagingSecrets":{"id":"StagingSecrets","path":"BCOS-SecurityStack/StagingSecrets","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-SecurityStack/StagingSecrets/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Staging secrets for BCOS application","generateSecretString":{"secretStringTemplate":"{\"NODE_ENV\":\"staging\",\"PORT\":\"4001\"}","generateStringKey":"JWT_SECRET","excludeCharacters":"\"@/\\","includeSpace":false,"passwordLength":64},"kmsKeyId":{"Fn::GetAtt":["BCOSEncryptionKeyA46A0152","Arn"]},"name":"staging/bcos-secrets"}}}}},"KMSKeyId":{"id":"KMSKeyId","path":"BCOS-SecurityStack/KMSKeyId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"KMSKeyArn":{"id":"KMSKeyArn","path":"BCOS-SecurityStack/KMSKeyArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"ECRRepositoryName":{"id":"ECRRepositoryName","path":"BCOS-SecurityStack/ECRRepositoryName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"ECSTaskExecutionRoleArn":{"id":"ECSTaskExecutionRoleArn","path":"BCOS-SecurityStack/ECSTaskExecutionRoleArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"ECSTaskRoleArn":{"id":"ECSTaskRoleArn","path":"BCOS-SecurityStack/ECSTaskRoleArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"ProductionSecretArn":{"id":"ProductionSecretArn","path":"BCOS-SecurityStack/ProductionSecretArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"StagingSecretArn":{"id":"StagingSecretArn","path":"BCOS-SecurityStack/StagingSecretArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"GitHubActionsRoleOutput":{"id":"GitHubActionsRoleOutput","path":"BCOS-SecurityStack/GitHubActionsRoleOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"GitHubActionsRoleArn":{"id":"GitHubActionsRoleArn","path":"BCOS-SecurityStack/GitHubActionsRoleArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"ECRRepositoryUri":{"id":"ECRRepositoryUri","path":"BCOS-SecurityStack/ECRRepositoryUri","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"BCOS-SecurityStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"BCOS-SecurityStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.215.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"BCOS-SecurityStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.215.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"BCOS-SecurityStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.215.0"}}}},"BCOS-NetworkStack":{"id":"BCOS-NetworkStack","path":"BCOS-NetworkStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.215.0"},"children":{"ExistingVPC":{"id":"ExistingVPC","path":"BCOS-NetworkStack/ExistingVPC","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]},"children":{"PublicSubnet1":{"id":"PublicSubnet1","path":"BCOS-NetworkStack/ExistingVPC/PublicSubnet1","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet2":{"id":"PublicSubnet2","path":"BCOS-NetworkStack/ExistingVPC/PublicSubnet2","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet3":{"id":"PublicSubnet3","path":"BCOS-NetworkStack/ExistingVPC/PublicSubnet3","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet4":{"id":"PublicSubnet4","path":"BCOS-NetworkStack/ExistingVPC/PublicSubnet4","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet5":{"id":"PublicSubnet5","path":"BCOS-NetworkStack/ExistingVPC/PublicSubnet5","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet6":{"id":"PublicSubnet6","path":"BCOS-NetworkStack/ExistingVPC/PublicSubnet6","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PrivateSubnet1":{"id":"PrivateSubnet1","path":"BCOS-NetworkStack/ExistingVPC/PrivateSubnet1","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PrivateSubnet2":{"id":"PrivateSubnet2","path":"BCOS-NetworkStack/ExistingVPC/PrivateSubnet2","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PrivateSubnet3":{"id":"PrivateSubnet3","path":"BCOS-NetworkStack/ExistingVPC/PrivateSubnet3","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PrivateSubnet4":{"id":"PrivateSubnet4","path":"BCOS-NetworkStack/ExistingVPC/PrivateSubnet4","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}}}},"HostedZone":{"id":"HostedZone","path":"BCOS-NetworkStack/HostedZone","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"ALBAccessLogsBucket":{"id":"ALBAccessLogsBucket","path":"BCOS-NetworkStack/ALBAccessLogsBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-NetworkStack/ALBAccessLogsBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"lifecycleConfiguration":{"rules":[{"abortIncompleteMultipartUpload":{"daysAfterInitiation":7},"expirationInDays":90,"id":"DeleteOldAccessLogs","status":"Enabled"}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"BCOS-NetworkStack/ALBAccessLogsBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-NetworkStack/ALBAccessLogsBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"ALBAccessLogsBucket00D07A1D"},"policyDocument":{"Statement":[{"Action":"s3:PutObject","Effect":"Allow","Principal":{"AWS":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::127311923021:root"]]}},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["ALBAccessLogsBucket00D07A1D","Arn"]},"/alb-access-logs/AWSLogs/854428944440/*"]]}},{"Action":"s3:PutObject","Condition":{"StringEquals":{"s3:x-amz-acl":"bucket-owner-full-control"}},"Effect":"Allow","Principal":{"Service":"delivery.logs.amazonaws.com"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["ALBAccessLogsBucket00D07A1D","Arn"]},"/alb-access-logs/AWSLogs/854428944440/*"]]}},{"Action":"s3:GetBucketAcl","Effect":"Allow","Principal":{"Service":"delivery.logs.amazonaws.com"},"Resource":{"Fn::GetAtt":["ALBAccessLogsBucket00D07A1D","Arn"]}}],"Version":"2012-10-17"}}}}}}}},"SSLCertificate":{"id":"SSLCertificate","path":"BCOS-NetworkStack/SSLCertificate","constructInfo":{"fqn":"aws-cdk-lib.aws_certificatemanager.Certificate","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-NetworkStack/SSLCertificate/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_certificatemanager.CfnCertificate","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CertificateManager::Certificate","aws:cdk:cloudformation:props":{"domainName":"app.bendcare.com","domainValidationOptions":[{"domainName":"app.bendcare.com","hostedZoneId":"Z05961102TVIVESKQ4GAL"},{"domainName":"staging.bendcare.com","hostedZoneId":"Z05961102TVIVESKQ4GAL"}],"keyAlgorithm":"RSA_2048","subjectAlternativeNames":["staging.bendcare.com"],"tags":[{"key":"Name","value":"BCOS-NetworkStack/SSLCertificate"}],"validationMethod":"DNS"}}}}},"ALBSecurityGroup":{"id":"ALBSecurityGroup","path":"BCOS-NetworkStack/ALBSecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-NetworkStack/ALBSecurityGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Security group for BCOS Application Load Balancer","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"securityGroupIngress":[{"cidrIp":"0.0.0.0/0","ipProtocol":"tcp","fromPort":443,"toPort":443,"description":"Allow HTTPS traffic from internet"},{"cidrIp":"0.0.0.0/0","ipProtocol":"tcp","fromPort":80,"toPort":80,"description":"Allow HTTP traffic from internet (for redirect)"}],"vpcId":"vpc-febca387"}}}}},"ECSSecurityGroup":{"id":"ECSSecurityGroup","path":"BCOS-NetworkStack/ECSSecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-NetworkStack/ECSSecurityGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Security group for BCOS ECS tasks","securityGroupEgress":[{"cidrIp":"10.104.172.0/22","ipProtocol":"tcp","fromPort":443,"toPort":443,"description":"Allow HTTPS to VPC endpoints"},{"cidrIp":"0.0.0.0/0","ipProtocol":"tcp","fromPort":53,"toPort":53,"description":"Allow DNS TCP"},{"cidrIp":"0.0.0.0/0","ipProtocol":"udp","fromPort":53,"toPort":53,"description":"Allow DNS UDP"}],"securityGroupIngress":[{"sourceSecurityGroupId":{"Fn::GetAtt":["ALBSecurityGroup29A3BDEF","GroupId"]},"ipProtocol":"tcp","fromPort":3000,"toPort":3000,"description":"Allow HTTP traffic from ALB"},{"cidrIp":"10.104.172.0/22","ipProtocol":"tcp","fromPort":443,"toPort":443,"description":"from 10.104.172.0/22:443"}],"vpcId":"vpc-febca387"}}}}},"ECR-API-Endpoint":{"id":"ECR-API-Endpoint","path":"BCOS-NetworkStack/ECR-API-Endpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-NetworkStack/ECR-API-Endpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"privateDnsEnabled":true,"securityGroupIds":[{"Fn::GetAtt":["ECSSecurityGroupA14DBE7D","GroupId"]}],"serviceName":"com.amazonaws.us-east-1.ecr.api","subnetIds":["subnet-095fa406c94abb01f","subnet-1d132031","subnet-2563a41a","subnet-6f277e63"],"vpcEndpointType":"Interface","vpcId":"vpc-febca387"}}}}},"ECR-DKR-Endpoint":{"id":"ECR-DKR-Endpoint","path":"BCOS-NetworkStack/ECR-DKR-Endpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-NetworkStack/ECR-DKR-Endpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"privateDnsEnabled":true,"securityGroupIds":[{"Fn::GetAtt":["ECSSecurityGroupA14DBE7D","GroupId"]}],"serviceName":"com.amazonaws.us-east-1.ecr.dkr","subnetIds":["subnet-095fa406c94abb01f","subnet-1d132031","subnet-2563a41a","subnet-6f277e63"],"vpcEndpointType":"Interface","vpcId":"vpc-febca387"}}}}},"CloudWatch-Logs-Endpoint":{"id":"CloudWatch-Logs-Endpoint","path":"BCOS-NetworkStack/CloudWatch-Logs-Endpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-NetworkStack/CloudWatch-Logs-Endpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"privateDnsEnabled":true,"securityGroupIds":[{"Fn::GetAtt":["ECSSecurityGroupA14DBE7D","GroupId"]}],"serviceName":"com.amazonaws.us-east-1.logs","subnetIds":["subnet-095fa406c94abb01f","subnet-1d132031","subnet-2563a41a","subnet-6f277e63"],"vpcEndpointType":"Interface","vpcId":"vpc-febca387"}}}}},"Secrets-Manager-Endpoint":{"id":"Secrets-Manager-Endpoint","path":"BCOS-NetworkStack/Secrets-Manager-Endpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-NetworkStack/Secrets-Manager-Endpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"privateDnsEnabled":true,"securityGroupIds":[{"Fn::GetAtt":["ECSSecurityGroupA14DBE7D","GroupId"]}],"serviceName":"com.amazonaws.us-east-1.secretsmanager","subnetIds":["subnet-095fa406c94abb01f","subnet-1d132031","subnet-2563a41a","subnet-6f277e63"],"vpcEndpointType":"Interface","vpcId":"vpc-febca387"}}}}},"STS-Endpoint":{"id":"STS-Endpoint","path":"BCOS-NetworkStack/STS-Endpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-NetworkStack/STS-Endpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"privateDnsEnabled":true,"securityGroupIds":[{"Fn::GetAtt":["ECSSecurityGroupA14DBE7D","GroupId"]}],"serviceName":"com.amazonaws.us-east-1.sts","subnetIds":["subnet-095fa406c94abb01f","subnet-1d132031","subnet-2563a41a","subnet-6f277e63"],"vpcEndpointType":"Interface","vpcId":"vpc-febca387"}}}}},"S3-Gateway-Endpoint":{"id":"S3-Gateway-Endpoint","path":"BCOS-NetworkStack/S3-Gateway-Endpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.GatewayVpcEndpoint","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-NetworkStack/S3-Gateway-Endpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"routeTableIds":["rtb-cf8babb4"],"serviceName":{"Fn::Join":["",["com.amazonaws.",{"Ref":"AWS::Region"},".s3"]]},"vpcEndpointType":"Gateway","vpcId":"vpc-febca387"}}}}},"ApplicationLoadBalancer":{"id":"ApplicationLoadBalancer","path":"BCOS-NetworkStack/ApplicationLoadBalancer","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationLoadBalancer","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-NetworkStack/ApplicationLoadBalancer/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnLoadBalancer","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::LoadBalancer","aws:cdk:cloudformation:props":{"loadBalancerAttributes":[{"key":"deletion_protection.enabled","value":"false"},{"key":"access_logs.s3.enabled","value":"true"},{"key":"access_logs.s3.bucket","value":{"Ref":"ALBAccessLogsBucket00D07A1D"}},{"key":"access_logs.s3.prefix","value":"alb-access-logs"}],"scheme":"internet-facing","securityGroups":[{"Fn::GetAtt":["ALBSecurityGroup29A3BDEF","GroupId"]}],"subnets":["subnet-1c132030","subnet-02e36d31eafc7b9cc","subnet-053f73f2d9a4005d9"],"type":"application"}}},"HTTPListener":{"id":"HTTPListener","path":"BCOS-NetworkStack/ApplicationLoadBalancer/HTTPListener","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListener","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-NetworkStack/ApplicationLoadBalancer/HTTPListener/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnListener","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::Listener","aws:cdk:cloudformation:props":{"defaultActions":[{"type":"redirect","redirectConfig":{"statusCode":"HTTP_301","port":"443","protocol":"HTTPS"}}],"loadBalancerArn":{"Ref":"ApplicationLoadBalancerFD56DEE1"},"port":80,"protocol":"HTTP"}}}}},"HTTPSListener":{"id":"HTTPSListener","path":"BCOS-NetworkStack/ApplicationLoadBalancer/HTTPSListener","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListener","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-NetworkStack/ApplicationLoadBalancer/HTTPSListener/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnListener","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::Listener","aws:cdk:cloudformation:props":{"certificates":[{"certificateArn":{"Ref":"SSLCertificate2E93C565"}}],"defaultActions":[{"type":"fixed-response","fixedResponseConfig":{"statusCode":"404","contentType":"text/plain","messageBody":"Not Found"}}],"loadBalancerArn":{"Ref":"ApplicationLoadBalancerFD56DEE1"},"port":443,"protocol":"HTTPS","sslPolicy":"ELBSecurityPolicy-TLS-1-2-2017-01"}}}}}}},"VPCId":{"id":"VPCId","path":"BCOS-NetworkStack/VPCId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"LoadBalancerDNSOutput":{"id":"LoadBalancerDNSOutput","path":"BCOS-NetworkStack/LoadBalancerDNSOutput","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"LoadBalancerArn":{"id":"LoadBalancerArn","path":"BCOS-NetworkStack/LoadBalancerArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"LoadBalancerCanonicalHostedZoneId":{"id":"LoadBalancerCanonicalHostedZoneId","path":"BCOS-NetworkStack/LoadBalancerCanonicalHostedZoneId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"HTTPSListenerArn":{"id":"HTTPSListenerArn","path":"BCOS-NetworkStack/HTTPSListenerArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"HostedZoneId":{"id":"HostedZoneId","path":"BCOS-NetworkStack/HostedZoneId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"CertificateArn":{"id":"CertificateArn","path":"BCOS-NetworkStack/CertificateArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"ALBSecurityGroupId":{"id":"ALBSecurityGroupId","path":"BCOS-NetworkStack/ALBSecurityGroupId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"ECSSecurityGroupId":{"id":"ECSSecurityGroupId","path":"BCOS-NetworkStack/ECSSecurityGroupId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"LoadBalancerDNS":{"id":"LoadBalancerDNS","path":"BCOS-NetworkStack/LoadBalancerDNS","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"BCOS-NetworkStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"BCOS-NetworkStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.215.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"BCOS-NetworkStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.215.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"BCOS-NetworkStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.215.0"}}}},"BCOS-StagingStack":{"id":"BCOS-StagingStack","path":"BCOS-StagingStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.215.0"},"children":{"VPC":{"id":"VPC","path":"BCOS-StagingStack/VPC","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]},"children":{"PublicSubnet1":{"id":"PublicSubnet1","path":"BCOS-StagingStack/VPC/PublicSubnet1","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet2":{"id":"PublicSubnet2","path":"BCOS-StagingStack/VPC/PublicSubnet2","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet3":{"id":"PublicSubnet3","path":"BCOS-StagingStack/VPC/PublicSubnet3","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet4":{"id":"PublicSubnet4","path":"BCOS-StagingStack/VPC/PublicSubnet4","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet5":{"id":"PublicSubnet5","path":"BCOS-StagingStack/VPC/PublicSubnet5","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet6":{"id":"PublicSubnet6","path":"BCOS-StagingStack/VPC/PublicSubnet6","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PrivateSubnet1":{"id":"PrivateSubnet1","path":"BCOS-StagingStack/VPC/PrivateSubnet1","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PrivateSubnet2":{"id":"PrivateSubnet2","path":"BCOS-StagingStack/VPC/PrivateSubnet2","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PrivateSubnet3":{"id":"PrivateSubnet3","path":"BCOS-StagingStack/VPC/PrivateSubnet3","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PrivateSubnet4":{"id":"PrivateSubnet4","path":"BCOS-StagingStack/VPC/PrivateSubnet4","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}}}},"KMSKey":{"id":"KMSKey","path":"BCOS-StagingStack/KMSKey","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"ECRRepository":{"id":"ECRRepository","path":"BCOS-StagingStack/ECRRepository","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.RepositoryBase","version":"2.215.0","metadata":[]}},"ExecutionRole":{"id":"ExecutionRole","path":"BCOS-StagingStack/ExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"TaskRole":{"id":"TaskRole","path":"BCOS-StagingStack/TaskRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"Secret":{"id":"Secret","path":"BCOS-StagingStack/Secret","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"LoadBalancer":{"id":"LoadBalancer","path":"BCOS-StagingStack/LoadBalancer","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]},"children":{"SecurityGroup":{"id":"SecurityGroup","path":"BCOS-StagingStack/LoadBalancer/SecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}}}},"ALBSecurityGroup":{"id":"ALBSecurityGroup","path":"BCOS-StagingStack/ALBSecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"HTTPSListener":{"id":"HTTPSListener","path":"BCOS-StagingStack/HTTPSListener","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"HostedZone":{"id":"HostedZone","path":"BCOS-StagingStack/HostedZone","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"ECSSecurityGroup":{"id":"ECSSecurityGroup","path":"BCOS-StagingStack/ECSSecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"StagingCluster":{"id":"StagingCluster","path":"BCOS-StagingStack/StagingCluster","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.Cluster","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-StagingStack/StagingCluster/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnCluster","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::Cluster","aws:cdk:cloudformation:props":{"clusterName":"bcos-staging-cluster","clusterSettings":[{"name":"containerInsights","value":"disabled"}],"tags":[{"key":"Backup","value":"weekly"},{"key":"CostCenter","value":"Development"},{"key":"Environment","value":"staging"}]}}},"StagingCluster":{"id":"StagingCluster","path":"BCOS-StagingStack/StagingCluster/StagingCluster","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnClusterCapacityProviderAssociations","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::ClusterCapacityProviderAssociations","aws:cdk:cloudformation:props":{"capacityProviders":["FARGATE","FARGATE_SPOT"],"cluster":{"Ref":"StagingClusterD0FDCA09"},"defaultCapacityProviderStrategy":[]}}}}},"StagingTargetGroup":{"id":"StagingTargetGroup","path":"BCOS-StagingStack/StagingTargetGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationTargetGroup","version":"2.215.0"},"children":{"Resource":{"id":"Resource","path":"BCOS-StagingStack/StagingTargetGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnTargetGroup","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::TargetGroup","aws:cdk:cloudformation:props":{"healthCheckEnabled":true,"healthCheckIntervalSeconds":30,"healthCheckPath":"/api/health","healthCheckPort":"3000","healthCheckProtocol":"HTTP","healthCheckTimeoutSeconds":10,"healthyThresholdCount":2,"matcher":{"httpCode":"200"},"name":"bcos-staging-tg","port":3000,"protocol":"HTTP","tags":[{"key":"Backup","value":"weekly"},{"key":"CostCenter","value":"Development"},{"key":"Environment","value":"staging"}],"targetGroupAttributes":[{"key":"stickiness.enabled","value":"false"}],"targetType":"ip","unhealthyThresholdCount":5,"vpcId":"vpc-febca387"}}}}},"StagingListenerRule":{"id":"StagingListenerRule","path":"BCOS-StagingStack/StagingListenerRule","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListenerRule","version":"2.215.0"},"children":{"Resource":{"id":"Resource","path":"BCOS-StagingStack/StagingListenerRule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnListenerRule","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::ListenerRule","aws:cdk:cloudformation:props":{"actions":[{"type":"forward","targetGroupArn":{"Ref":"StagingTargetGroupD48C3A0A"}}],"conditions":[{"field":"host-header","hostHeaderConfig":{"values":["staging.bendcare.com"]}}],"listenerArn":"arn:aws:elasticloadbalancing:us-east-1:854428944440:listener/app/BCOS-N-Appli-rIo4btfCQRZj/ac6744264a6b1239/93962089e0bad510","priority":100}}}}},"StagingARecord":{"id":"StagingARecord","path":"BCOS-StagingStack/StagingARecord","constructInfo":{"fqn":"aws-cdk-lib.aws_route53.ARecord","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-StagingStack/StagingARecord/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_route53.CfnRecordSet","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Route53::RecordSet","aws:cdk:cloudformation:props":{"aliasTarget":{"hostedZoneId":"Z35SXDOTRQ7X7K","dnsName":"dualstack.BCOS-N-Appli-rIo4btfCQRZj-401564420.us-east-1.elb.amazonaws.com"},"hostedZoneId":"Z05961102TVIVESKQ4GAL","name":"staging.bendcare.com.","type":"A"}}}}},"WAFProtection":{"id":"WAFProtection","path":"BCOS-StagingStack/WAFProtection","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"WAFLogGroup":{"id":"WAFLogGroup","path":"BCOS-StagingStack/WAFProtection/WAFLogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-StagingStack/WAFProtection/WAFLogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":"/aws/waf/bcos-staging-1758708411502","retentionInDays":30,"tags":[{"key":"Backup","value":"weekly"},{"key":"CostCenter","value":"Development"},{"key":"Environment","value":"staging"}]}}}}},"WebACL":{"id":"WebACL","path":"BCOS-StagingStack/WAFProtection/WebACL","constructInfo":{"fqn":"aws-cdk-lib.aws_wafv2.CfnWebACL","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::WAFv2::WebACL","aws:cdk:cloudformation:props":{"defaultAction":{"allow":{}},"description":"WAF protection for BCOS staging environment","name":"BCOS-staging-WebACL","rules":[{"name":"AWS-AWSManagedRulesCommonRuleSet","priority":1,"overrideAction":{"none":{}},"statement":{"managedRuleGroupStatement":{"vendorName":"AWS","name":"AWSManagedRulesCommonRuleSet","excludedRules":[]}},"visibilityConfig":{"sampledRequestsEnabled":true,"cloudWatchMetricsEnabled":true,"metricName":"CommonRuleSet-staging"}},{"name":"AWS-AWSManagedRulesKnownBadInputsRuleSet","priority":2,"overrideAction":{"none":{}},"statement":{"managedRuleGroupStatement":{"vendorName":"AWS","name":"AWSManagedRulesKnownBadInputsRuleSet"}},"visibilityConfig":{"sampledRequestsEnabled":true,"cloudWatchMetricsEnabled":true,"metricName":"KnownBadInputs-staging"}},{"name":"RateLimitRule-staging","priority":3,"action":{"block":{}},"statement":{"rateBasedStatement":{"limit":2000,"aggregateKeyType":"IP","scopeDownStatement":{"notStatement":{"statement":{"byteMatchStatement":{"searchString":"/health","fieldToMatch":{"uriPath":{}},"textTransformations":[{"priority":0,"type":"LOWERCASE"}],"positionalConstraint":"STARTS_WITH"}}}}}},"visibilityConfig":{"sampledRequestsEnabled":true,"cloudWatchMetricsEnabled":true,"metricName":"RateLimit-staging"}}],"scope":"REGIONAL","tags":[{"key":"Application","value":"BCOS"},{"key":"Backup","value":"weekly"},{"key":"CostCenter","value":"Development"},{"key":"Environment","value":"staging"},{"key":"ManagedBy","value":"CDK"}],"visibilityConfig":{"sampledRequestsEnabled":true,"cloudWatchMetricsEnabled":true,"metricName":"BCOS-staging-WebACL"}}}},"WebACLArn":{"id":"WebACLArn","path":"BCOS-StagingStack/WAFProtection/WebACLArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"WebACLId":{"id":"WebACLId","path":"BCOS-StagingStack/WAFProtection/WebACLId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"WebACLAssociation":{"id":"WebACLAssociation","path":"BCOS-StagingStack/WAFProtection/WebACLAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_wafv2.CfnWebACLAssociation","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::WAFv2::WebACLAssociation","aws:cdk:cloudformation:props":{"resourceArn":"arn:aws:elasticloadbalancing:us-east-1:854428944440:loadbalancer/app/BCOS-N-Appli-rIo4btfCQRZj/ac6744264a6b1239","webAclArn":{"Fn::GetAtt":["WAFProtectionWebACLA37FE6E3","Arn"]}}}}}},"StagingClusterName":{"id":"StagingClusterName","path":"BCOS-StagingStack/StagingClusterName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"StagingURL":{"id":"StagingURL","path":"BCOS-StagingStack/StagingURL","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"StagingTargetGroupArn":{"id":"StagingTargetGroupArn","path":"BCOS-StagingStack/StagingTargetGroupArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"StagingStackArn":{"id":"StagingStackArn","path":"BCOS-StagingStack/StagingStackArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"BCOS-StagingStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"BCOS-StagingStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.215.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"BCOS-StagingStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.215.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"BCOS-StagingStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.215.0"}}}},"BCOS-ProductionStack":{"id":"BCOS-ProductionStack","path":"BCOS-ProductionStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.215.0"},"children":{"VPC":{"id":"VPC","path":"BCOS-ProductionStack/VPC","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]},"children":{"PublicSubnet1":{"id":"PublicSubnet1","path":"BCOS-ProductionStack/VPC/PublicSubnet1","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet2":{"id":"PublicSubnet2","path":"BCOS-ProductionStack/VPC/PublicSubnet2","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet3":{"id":"PublicSubnet3","path":"BCOS-ProductionStack/VPC/PublicSubnet3","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet4":{"id":"PublicSubnet4","path":"BCOS-ProductionStack/VPC/PublicSubnet4","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet5":{"id":"PublicSubnet5","path":"BCOS-ProductionStack/VPC/PublicSubnet5","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PublicSubnet6":{"id":"PublicSubnet6","path":"BCOS-ProductionStack/VPC/PublicSubnet6","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PrivateSubnet1":{"id":"PrivateSubnet1","path":"BCOS-ProductionStack/VPC/PrivateSubnet1","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PrivateSubnet2":{"id":"PrivateSubnet2","path":"BCOS-ProductionStack/VPC/PrivateSubnet2","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PrivateSubnet3":{"id":"PrivateSubnet3","path":"BCOS-ProductionStack/VPC/PrivateSubnet3","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"PrivateSubnet4":{"id":"PrivateSubnet4","path":"BCOS-ProductionStack/VPC/PrivateSubnet4","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}}}},"KMSKey":{"id":"KMSKey","path":"BCOS-ProductionStack/KMSKey","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"ECRRepository":{"id":"ECRRepository","path":"BCOS-ProductionStack/ECRRepository","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.RepositoryBase","version":"2.215.0","metadata":[]}},"ExecutionRole":{"id":"ExecutionRole","path":"BCOS-ProductionStack/ExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]},"children":{"Policy":{"id":"Policy","path":"BCOS-ProductionStack/ExecutionRole/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/ExecutionRole/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":{"Fn::GetAtt":["SecureContainerLogGroup7C38C890","Arn"]}},{"Action":["secretsmanager:DescribeSecret","secretsmanager:GetSecretValue"],"Effect":"Allow","Resource":{"Fn::ImportValue":"BCOS-ProductionSecret-Arn"}}],"Version":"2012-10-17"},"policyName":"ExecutionRolePolicy79A7F477","roles":[{"Fn::Select":[1,{"Fn::Split":["/",{"Fn::Select":[5,{"Fn::Split":[":",{"Fn::ImportValue":"BCOS-ECSTaskExecutionRole-Arn"}]}]}]}]}]}}}}}}},"TaskRole":{"id":"TaskRole","path":"BCOS-ProductionStack/TaskRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]},"children":{"Policy":{"id":"Policy","path":"BCOS-ProductionStack/TaskRole/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/TaskRole/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["logs:DescribeLogGroups","ssmmessages:CreateControlChannel","ssmmessages:CreateDataChannel","ssmmessages:OpenControlChannel","ssmmessages:OpenDataChannel"],"Effect":"Allow","Resource":"*"},{"Action":["logs:CreateLogStream","logs:DescribeLogStreams","logs:PutLogEvents"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:us-east-1:854428944440:log-group:",{"Ref":"ExecuteCommandLogGroup3D257AE9"},":*"]]}}],"Version":"2012-10-17"},"policyName":"TaskRolePolicy470C6022","roles":[{"Fn::Select":[1,{"Fn::Split":["/",{"Fn::Select":[5,{"Fn::Split":[":",{"Fn::ImportValue":"BCOS-ECSTaskRole-Arn"}]}]}]}]}]}}}}}}},"Secret":{"id":"Secret","path":"BCOS-ProductionStack/Secret","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"LoadBalancer":{"id":"LoadBalancer","path":"BCOS-ProductionStack/LoadBalancer","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]},"children":{"SecurityGroup":{"id":"SecurityGroup","path":"BCOS-ProductionStack/LoadBalancer/SecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}}}},"ALBSecurityGroup":{"id":"ALBSecurityGroup","path":"BCOS-ProductionStack/ALBSecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"HTTPSListener":{"id":"HTTPSListener","path":"BCOS-ProductionStack/HTTPSListener","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"HostedZone":{"id":"HostedZone","path":"BCOS-ProductionStack/HostedZone","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"ECSSecurityGroup":{"id":"ECSSecurityGroup","path":"BCOS-ProductionStack/ECSSecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]},"children":{"from BCOSProductionStackALBSecurityGroup5746FAE8:3000":{"id":"from BCOSProductionStackALBSecurityGroup5746FAE8:3000","path":"BCOS-ProductionStack/ECSSecurityGroup/from BCOSProductionStackALBSecurityGroup5746FAE8:3000","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"Load balancer to target","fromPort":3000,"groupId":{"Fn::ImportValue":"BCOS-ECSSecurityGroup-Id"},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::ImportValue":"BCOS-ECSSecurityGroup-Id"},"toPort":3000}}}}},"ExecuteCommandLogGroup":{"id":"ExecuteCommandLogGroup","path":"BCOS-ProductionStack/ExecuteCommandLogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/ExecuteCommandLogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":"/ecs/execute-command/bcos-production","retentionInDays":30,"tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}]}}}}},"ProductionCluster":{"id":"ProductionCluster","path":"BCOS-ProductionStack/ProductionCluster","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.Cluster","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/ProductionCluster/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnCluster","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::Cluster","aws:cdk:cloudformation:props":{"clusterName":"bcos-production-cluster","clusterSettings":[{"name":"containerInsights","value":"enabled"}],"configuration":{"executeCommandConfiguration":{"logConfiguration":{"cloudWatchEncryptionEnabled":true,"cloudWatchLogGroupName":{"Ref":"ExecuteCommandLogGroup3D257AE9"}},"logging":"OVERRIDE"}},"tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}]}}},"ProductionCluster":{"id":"ProductionCluster","path":"BCOS-ProductionStack/ProductionCluster/ProductionCluster","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnClusterCapacityProviderAssociations","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::ClusterCapacityProviderAssociations","aws:cdk:cloudformation:props":{"capacityProviders":["FARGATE","FARGATE_SPOT"],"cluster":{"Ref":"ProductionCluster0525040D"},"defaultCapacityProviderStrategy":[]}}}}},"SecureContainer":{"id":"SecureContainer","path":"BCOS-ProductionStack/SecureContainer","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"LogGroup":{"id":"LogGroup","path":"BCOS-ProductionStack/SecureContainer/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/SecureContainer/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":"/ecs/bcos-production-1758708411510","retentionInDays":90,"tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}]}}}}},"TaskDefinition":{"id":"TaskDefinition","path":"BCOS-ProductionStack/SecureContainer/TaskDefinition","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.FargateTaskDefinition","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/SecureContainer/TaskDefinition/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnTaskDefinition","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::TaskDefinition","aws:cdk:cloudformation:props":{"containerDefinitions":[{"cpu":1024,"essential":true,"image":{"Fn::Join":["",[{"Fn::Select":[4,{"Fn::Split":[":",{"Fn::ImportValue":"BCOS-ECRRepositoryUri"}]}]},".dkr.ecr.",{"Fn::Select":[3,{"Fn::Split":[":",{"Fn::ImportValue":"BCOS-ECRRepositoryUri"}]}]},".",{"Ref":"AWS::URLSuffix"},"/bcos:latest"]]},"memory":2048,"name":"bcos","portMappings":[{"containerPort":3000,"protocol":"tcp","name":"http"}],"privileged":false,"readonlyRootFilesystem":true,"stopTimeout":30,"ulimits":[{"name":"nofile","softLimit":65536,"hardLimit":65536}],"user":"1001","logConfiguration":{"logDriver":"awslogs","options":{"awslogs-group":{"Ref":"SecureContainerLogGroup7C38C890"},"awslogs-stream-prefix":"ecs","awslogs-region":"us-east-1","awslogs-datetime-format":"%Y-%m-%d %H:%M:%S"}},"environment":[{"name":"NODE_ENV","value":"production"},{"name":"PORT","value":"3000"},{"name":"AWS_REGION","value":"us-east-1"},{"name":"ENVIRONMENT","value":"production"},{"name":"NEXT_PUBLIC_APP_URL","value":"https://app.bendcare.com"}],"secrets":[{"name":"DATABASE_URL","valueFrom":{"Fn::Join":["",[{"Fn::ImportValue":"BCOS-ProductionSecret-Arn"},":DATABASE_URL::"]]}},{"name":"ANALYTICS_DATABASE_URL","valueFrom":{"Fn::Join":["",[{"Fn::ImportValue":"BCOS-ProductionSecret-Arn"},":ANALYTICS_DATABASE_URL::"]]}},{"name":"JWT_SECRET","valueFrom":{"Fn::Join":["",[{"Fn::ImportValue":"BCOS-ProductionSecret-Arn"},":JWT_SECRET::"]]}},{"name":"JWT_REFRESH_SECRET","valueFrom":{"Fn::Join":["",[{"Fn::ImportValue":"BCOS-ProductionSecret-Arn"},":JWT_REFRESH_SECRET::"]]}},{"name":"CSRF_SECRET","valueFrom":{"Fn::Join":["",[{"Fn::ImportValue":"BCOS-ProductionSecret-Arn"},":CSRF_SECRET::"]]}},{"name":"EMAIL_FROM","valueFrom":{"Fn::Join":["",[{"Fn::ImportValue":"BCOS-ProductionSecret-Arn"},":EMAIL_FROM::"]]}},{"name":"ADMIN_NOTIFICATION_EMAILS","valueFrom":{"Fn::Join":["",[{"Fn::ImportValue":"BCOS-ProductionSecret-Arn"},":ADMIN_NOTIFICATION_EMAILS::"]]}}],"healthCheck":{"command":["CMD-SHELL","curl -f http://localhost:3000/health || exit 1"],"interval":30,"retries":3,"startPeriod":60,"timeout":5},"linuxParameters":{"initProcessEnabled":true,"capabilities":{}}}],"cpu":"1024","executionRoleArn":{"Fn::ImportValue":"BCOS-ECSTaskExecutionRole-Arn"},"family":"bcos-production","memory":"2048","networkMode":"awsvpc","requiresCompatibilities":["FARGATE"],"runtimePlatform":{"cpuArchitecture":"X86_64","operatingSystemFamily":"LINUX"},"tags":[{"key":"Application","value":"BCOS"},{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"ManagedBy","value":"CDK"},{"key":"Monitoring","value":"enhanced"}],"taskRoleArn":{"Fn::ImportValue":"BCOS-ECSTaskRole-Arn"}}}},"app":{"id":"app","path":"BCOS-ProductionStack/SecureContainer/TaskDefinition/app","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.ContainerDefinition","version":"2.215.0"}}}},"LinuxParameters":{"id":"LinuxParameters","path":"BCOS-ProductionStack/SecureContainer/LinuxParameters","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.LinuxParameters","version":"2.215.0"}}}},"ProductionTargetGroup":{"id":"ProductionTargetGroup","path":"BCOS-ProductionStack/ProductionTargetGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationTargetGroup","version":"2.215.0"},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/ProductionTargetGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnTargetGroup","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::TargetGroup","aws:cdk:cloudformation:props":{"healthCheckEnabled":true,"healthCheckIntervalSeconds":15,"healthCheckPath":"/api/health","healthCheckPort":"3000","healthCheckProtocol":"HTTP","healthCheckTimeoutSeconds":5,"healthyThresholdCount":2,"matcher":{"httpCode":"200"},"name":"bcos-production-tg","port":3000,"protocol":"HTTP","tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}],"targetGroupAttributes":[{"key":"deregistration_delay.timeout_seconds","value":"30"},{"key":"stickiness.enabled","value":"true"},{"key":"stickiness.type","value":"lb_cookie"},{"key":"stickiness.lb_cookie.duration_seconds","value":"3600"}],"targetType":"ip","unhealthyThresholdCount":3,"vpcId":"vpc-febca387"}}}}},"ProductionService":{"id":"ProductionService","path":"BCOS-ProductionStack/ProductionService","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.FargateService","version":"2.215.0","metadata":[]},"children":{"Service":{"id":"Service","path":"BCOS-ProductionStack/ProductionService/Service","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnService","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::Service","aws:cdk:cloudformation:props":{"cluster":{"Ref":"ProductionCluster0525040D"},"deploymentConfiguration":{"maximumPercent":200,"minimumHealthyPercent":50,"deploymentCircuitBreaker":{"enable":true,"rollback":true},"alarms":{"alarmNames":[],"enable":false,"rollback":false}},"deploymentController":{"type":"ECS"},"desiredCount":2,"enableEcsManagedTags":false,"enableExecuteCommand":true,"healthCheckGracePeriodSeconds":120,"launchType":"FARGATE","loadBalancers":[{"targetGroupArn":{"Ref":"ProductionTargetGroup8A92AA3C"},"containerName":"bcos","containerPort":3000}],"networkConfiguration":{"awsvpcConfiguration":{"assignPublicIp":"DISABLED","subnets":["subnet-095fa406c94abb01f","subnet-1d132031","subnet-2563a41a","subnet-6f277e63"],"securityGroups":[{"Fn::ImportValue":"BCOS-ECSSecurityGroup-Id"}]}},"serviceName":"bcos-production-service","tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}],"taskDefinition":{"Ref":"SecureContainerTaskDefinition0F11F2CE"}}}}}},"ProductionListenerRule":{"id":"ProductionListenerRule","path":"BCOS-ProductionStack/ProductionListenerRule","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListenerRule","version":"2.215.0"},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/ProductionListenerRule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_elasticloadbalancingv2.CfnListenerRule","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ElasticLoadBalancingV2::ListenerRule","aws:cdk:cloudformation:props":{"actions":[{"type":"forward","targetGroupArn":{"Ref":"ProductionTargetGroup8A92AA3C"}}],"conditions":[{"field":"host-header","hostHeaderConfig":{"values":["app.bendcare.com"]}}],"listenerArn":{"Fn::ImportValue":"BCOS-HTTPSListener-Arn"},"priority":10}}}}},"ProductionARecord":{"id":"ProductionARecord","path":"BCOS-ProductionStack/ProductionARecord","constructInfo":{"fqn":"aws-cdk-lib.aws_route53.ARecord","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/ProductionARecord/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_route53.CfnRecordSet","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Route53::RecordSet","aws:cdk:cloudformation:props":{"aliasTarget":{"hostedZoneId":{"Fn::ImportValue":"BCOS-LoadBalancer-CanonicalHostedZoneId"},"dnsName":{"Fn::Join":["",["dualstack.",{"Fn::ImportValue":"BCOS-LoadBalancer-DnsName"}]]}},"hostedZoneId":{"Fn::ImportValue":"BCOS-HostedZone-Id"},"name":"app.bendcare.com.","type":"A"}}}}},"WAFProtection":{"id":"WAFProtection","path":"BCOS-ProductionStack/WAFProtection","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"WAFLogGroup":{"id":"WAFLogGroup","path":"BCOS-ProductionStack/WAFProtection/WAFLogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/WAFProtection/WAFLogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":"/aws/waf/bcos-production-1758708411520","retentionInDays":90,"tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}]}}}}},"WebACL":{"id":"WebACL","path":"BCOS-ProductionStack/WAFProtection/WebACL","constructInfo":{"fqn":"aws-cdk-lib.aws_wafv2.CfnWebACL","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::WAFv2::WebACL","aws:cdk:cloudformation:props":{"defaultAction":{"allow":{}},"description":"WAF protection for BCOS production environment","name":"BCOS-production-WebACL","rules":[{"name":"AWS-AWSManagedRulesCommonRuleSet","priority":1,"overrideAction":{"none":{}},"statement":{"managedRuleGroupStatement":{"vendorName":"AWS","name":"AWSManagedRulesCommonRuleSet","excludedRules":[]}},"visibilityConfig":{"sampledRequestsEnabled":true,"cloudWatchMetricsEnabled":true,"metricName":"CommonRuleSet-production"}},{"name":"AWS-AWSManagedRulesKnownBadInputsRuleSet","priority":2,"overrideAction":{"none":{}},"statement":{"managedRuleGroupStatement":{"vendorName":"AWS","name":"AWSManagedRulesKnownBadInputsRuleSet"}},"visibilityConfig":{"sampledRequestsEnabled":true,"cloudWatchMetricsEnabled":true,"metricName":"KnownBadInputs-production"}},{"name":"AWS-AWSManagedRulesOWASPTopTenRuleSet","priority":3,"overrideAction":{"none":{}},"statement":{"managedRuleGroupStatement":{"vendorName":"AWS","name":"AWSManagedRulesOWASPTopTenRuleSet"}},"visibilityConfig":{"sampledRequestsEnabled":true,"cloudWatchMetricsEnabled":true,"metricName":"OWASPTopTen-production"}},{"name":"RateLimitRule-production","priority":4,"action":{"block":{}},"statement":{"rateBasedStatement":{"limit":1000,"aggregateKeyType":"IP","scopeDownStatement":{"notStatement":{"statement":{"byteMatchStatement":{"searchString":"/health","fieldToMatch":{"uriPath":{}},"textTransformations":[{"priority":0,"type":"LOWERCASE"}],"positionalConstraint":"STARTS_WITH"}}}}}},"visibilityConfig":{"sampledRequestsEnabled":true,"cloudWatchMetricsEnabled":true,"metricName":"RateLimit-production"}},{"name":"APIAbuseProtection-production","priority":5,"action":{"block":{}},"statement":{"andStatement":{"statements":[{"byteMatchStatement":{"searchString":"/api/","fieldToMatch":{"uriPath":{}},"textTransformations":[{"priority":0,"type":"LOWERCASE"}],"positionalConstraint":"STARTS_WITH"}},{"rateBasedStatement":{"limit":500,"aggregateKeyType":"IP"}}]}},"visibilityConfig":{"sampledRequestsEnabled":true,"cloudWatchMetricsEnabled":true,"metricName":"APIAbuseProtection-production"}}],"scope":"REGIONAL","tags":[{"key":"Application","value":"BCOS"},{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"ManagedBy","value":"CDK"},{"key":"Monitoring","value":"enhanced"}],"visibilityConfig":{"sampledRequestsEnabled":true,"cloudWatchMetricsEnabled":true,"metricName":"BCOS-production-WebACL"}}}},"WebACLArn":{"id":"WebACLArn","path":"BCOS-ProductionStack/WAFProtection/WebACLArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"WebACLId":{"id":"WebACLId","path":"BCOS-ProductionStack/WAFProtection/WebACLId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"WebACLAssociation":{"id":"WebACLAssociation","path":"BCOS-ProductionStack/WAFProtection/WebACLAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_wafv2.CfnWebACLAssociation","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::WAFv2::WebACLAssociation","aws:cdk:cloudformation:props":{"resourceArn":{"Fn::ImportValue":"BCOS-LoadBalancer-Arn"},"webAclArn":{"Fn::GetAtt":["WAFProtectionWebACLA37FE6E3","Arn"]}}}}}},"Monitoring":{"id":"Monitoring","path":"BCOS-ProductionStack/Monitoring","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"AlertTopic":{"id":"AlertTopic","path":"BCOS-ProductionStack/Monitoring/AlertTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Topic","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/Monitoring/AlertTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopic","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Topic","aws:cdk:cloudformation:props":{"displayName":"BCOS production Alerts","kmsMasterKeyId":{"Fn::ImportValue":"BCOS-KMS-Key-Arn"},"tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}],"topicName":"bcos-production-alerts"}}},"production-alerts@bendcare.com":{"id":"production-alerts@bendcare.com","path":"BCOS-ProductionStack/Monitoring/AlertTopic/production-alerts@bendcare.com","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Subscription","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/Monitoring/AlertTopic/production-alerts@bendcare.com/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnSubscription","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Subscription","aws:cdk:cloudformation:props":{"endpoint":"production-alerts@bendcare.com","protocol":"email","topicArn":{"Ref":"MonitoringAlertTopicB48B06C2"}}}}}}}},"Dashboard":{"id":"Dashboard","path":"BCOS-ProductionStack/Monitoring/Dashboard","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Dashboard","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/Monitoring/Dashboard/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnDashboard","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Dashboard","aws:cdk:cloudformation:props":{"dashboardBody":{"Fn::Join":["",["{\"widgets\":[{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":0,\"y\":0,\"properties\":{\"view\":\"timeSeries\",\"title\":\"ECS Service Metrics - production\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"AWS/ECS\",\"CPUUtilization\",\"ClusterName\",\"",{"Ref":"ProductionCluster0525040D"},"\",\"ServiceName\",\"",{"Fn::GetAtt":["ProductionService0C624589","Name"]},"\"],[\"AWS/ECS\",\"MemoryUtilization\",\"ClusterName\",\"",{"Ref":"ProductionCluster0525040D"},"\",\"ServiceName\",\"",{"Fn::GetAtt":["ProductionService0C624589","Name"]},"\",{\"yAxis\":\"right\"}]],\"yAxis\":{}}},{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":0,\"y\":6,\"properties\":{\"view\":\"timeSeries\",\"title\":\"ALB Metrics - production\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"AWS/ApplicationELB\",\"RequestCount\",\"LoadBalancer\",\"dummy-alb-name\",{\"stat\":\"Sum\"}],[\"AWS/ApplicationELB\",\"TargetResponseTime\",\"LoadBalancer\",\"dummy-alb-name\",{\"yAxis\":\"right\"}]],\"yAxis\":{}}},{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":0,\"y\":12,\"properties\":{\"view\":\"timeSeries\",\"title\":\"Application Errors - production\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"BCOS/production\",\"ErrorCount\",{\"stat\":\"Sum\"}]],\"yAxis\":{}}}]}"]]},"dashboardName":"BCOS-production-Dashboard"}}}}},"ECS-RunningTaskCount":{"id":"ECS-RunningTaskCount","path":"BCOS-ProductionStack/Monitoring/ECS-RunningTaskCount","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/Monitoring/ECS-RunningTaskCount/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"MonitoringAlertTopicB48B06C2"}],"alarmDescription":"ECS service has fewer running tasks than desired for production","alarmName":"BCOS-production-ECS-LowTaskCount","tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}],"comparisonOperator":"LessThanThreshold","dimensions":[{"name":"ClusterName","value":{"Ref":"ProductionCluster0525040D"}},{"name":"ServiceName","value":{"Fn::GetAtt":["ProductionService0C624589","Name"]}}],"evaluationPeriods":2,"metricName":"RunningTaskCount","namespace":"AWS/ECS","period":60,"statistic":"Average","threshold":1}}}}},"ECS-HighCPU":{"id":"ECS-HighCPU","path":"BCOS-ProductionStack/Monitoring/ECS-HighCPU","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/Monitoring/ECS-HighCPU/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"MonitoringAlertTopicB48B06C2"}],"alarmDescription":"ECS service CPU utilization is high for production","alarmName":"BCOS-production-ECS-HighCPU","tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}],"comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"ClusterName","value":{"Ref":"ProductionCluster0525040D"}},{"name":"ServiceName","value":{"Fn::GetAtt":["ProductionService0C624589","Name"]}}],"evaluationPeriods":3,"metricName":"CPUUtilization","namespace":"AWS/ECS","period":300,"statistic":"Average","threshold":80}}}}},"ECS-HighMemory":{"id":"ECS-HighMemory","path":"BCOS-ProductionStack/Monitoring/ECS-HighMemory","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/Monitoring/ECS-HighMemory/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"MonitoringAlertTopicB48B06C2"}],"alarmDescription":"ECS service memory utilization is high for production","alarmName":"BCOS-production-ECS-HighMemory","tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}],"comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"ClusterName","value":{"Ref":"ProductionCluster0525040D"}},{"name":"ServiceName","value":{"Fn::GetAtt":["ProductionService0C624589","Name"]}}],"evaluationPeriods":3,"metricName":"MemoryUtilization","namespace":"AWS/ECS","period":300,"statistic":"Average","threshold":85}}}}},"ALB-UnhealthyTargets":{"id":"ALB-UnhealthyTargets","path":"BCOS-ProductionStack/Monitoring/ALB-UnhealthyTargets","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/Monitoring/ALB-UnhealthyTargets/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"MonitoringAlertTopicB48B06C2"}],"alarmDescription":"ALB has unhealthy targets for production","alarmName":"BCOS-production-ALB-UnhealthyTargets","tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}],"comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"LoadBalancer","value":"dummy-alb-name"},{"name":"TargetGroup","value":"dummy-tg-name"}],"evaluationPeriods":2,"metricName":"UnHealthyHostCount","namespace":"AWS/ApplicationELB","period":60,"statistic":"Maximum","threshold":0}}}}},"ALB-High5XXErrors":{"id":"ALB-High5XXErrors","path":"BCOS-ProductionStack/Monitoring/ALB-High5XXErrors","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/Monitoring/ALB-High5XXErrors/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"MonitoringAlertTopicB48B06C2"}],"alarmDescription":"ALB is returning high 5XX errors for production","alarmName":"BCOS-production-ALB-High5XXErrors","tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}],"comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"LoadBalancer","value":"dummy-alb-name"}],"evaluationPeriods":2,"metricName":"HTTPCode_ELB_5XX_Count","namespace":"AWS/ApplicationELB","period":300,"statistic":"Sum","threshold":10}}}}},"ALB-HighResponseTime":{"id":"ALB-HighResponseTime","path":"BCOS-ProductionStack/Monitoring/ALB-HighResponseTime","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/Monitoring/ALB-HighResponseTime/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"MonitoringAlertTopicB48B06C2"}],"alarmDescription":"ALB response time is high for production","alarmName":"BCOS-production-ALB-HighResponseTime","tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}],"comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"LoadBalancer","value":"dummy-alb-name"}],"evaluationPeriods":3,"metricName":"TargetResponseTime","namespace":"AWS/ApplicationELB","period":300,"statistic":"Average","threshold":2}}}}},"ErrorLogFilter":{"id":"ErrorLogFilter","path":"BCOS-ProductionStack/Monitoring/ErrorLogFilter","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.MetricFilter","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/Monitoring/ErrorLogFilter/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnMetricFilter","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::MetricFilter","aws:cdk:cloudformation:props":{"filterPattern":"?\"ERROR\" ?\"FATAL\" ?\"panic\" ?\"exception\"","logGroupName":{"Ref":"SecureContainerLogGroup7C38C890"},"metricTransformations":[{"metricNamespace":"BCOS/production","metricName":"ErrorCount","metricValue":"1","defaultValue":0}]}}}}},"App-HighErrorRate":{"id":"App-HighErrorRate","path":"BCOS-ProductionStack/Monitoring/App-HighErrorRate","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/Monitoring/App-HighErrorRate/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"MonitoringAlertTopicB48B06C2"}],"alarmDescription":"Application is logging high error rates for production","alarmName":"BCOS-production-App-HighErrorRate","tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}],"comparisonOperator":"GreaterThanThreshold","evaluationPeriods":2,"metricName":"ErrorCount","namespace":"BCOS/production","period":300,"statistic":"Sum","threshold":5}}}}},"HealthCheckFailureFilter":{"id":"HealthCheckFailureFilter","path":"BCOS-ProductionStack/Monitoring/HealthCheckFailureFilter","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.MetricFilter","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/Monitoring/HealthCheckFailureFilter/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnMetricFilter","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::MetricFilter","aws:cdk:cloudformation:props":{"filterPattern":"[timestamp, level=\"ERROR\", message=\"*health*\"]","logGroupName":{"Ref":"SecureContainerLogGroup7C38C890"},"metricTransformations":[{"metricNamespace":"BCOS/production","metricName":"HealthCheckFailures","metricValue":"1","defaultValue":0}]}}}}},"App-HealthCheckFailures":{"id":"App-HealthCheckFailures","path":"BCOS-ProductionStack/Monitoring/App-HealthCheckFailures","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/Monitoring/App-HealthCheckFailures/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"MonitoringAlertTopicB48B06C2"}],"alarmDescription":"Application health checks are failing for production","alarmName":"BCOS-production-App-HealthCheckFailures","tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}],"comparisonOperator":"GreaterThanThreshold","evaluationPeriods":2,"metricName":"HealthCheckFailures","namespace":"BCOS/production","period":300,"statistic":"Sum","threshold":3}}}}},"RefECSTaskCount":{"id":"RefECSTaskCount","path":"BCOS-ProductionStack/Monitoring/RefECSTaskCount","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.AlarmBase","version":"2.215.0","metadata":[]}},"RefUnhealthyTargets":{"id":"RefUnhealthyTargets","path":"BCOS-ProductionStack/Monitoring/RefUnhealthyTargets","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.AlarmBase","version":"2.215.0","metadata":[]}},"ServiceHealth-Composite":{"id":"ServiceHealth-Composite","path":"BCOS-ProductionStack/Monitoring/ServiceHealth-Composite","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CompositeAlarm","version":"2.215.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/Monitoring/ServiceHealth-Composite/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnCompositeAlarm","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::CompositeAlarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"MonitoringAlertTopicB48B06C2"}],"alarmDescription":"Overall service health for production","alarmName":"BCOS-production-ServiceHealth","alarmRule":"(ALARM(\"arn:aws:cloudwatch:us-east-1:854428944440:alarm:BCOS-production-ECS-LowTaskCount\") OR ALARM(\"arn:aws:cloudwatch:us-east-1:854428944440:alarm:BCOS-production-ALB-UnhealthyTargets\"))","tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}]}}}}}}},"ProductionScalableTarget":{"id":"ProductionScalableTarget","path":"BCOS-ProductionStack/ProductionScalableTarget","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.ScalableTarget","version":"2.215.0","metadata":[]},"children":{"Role":{"id":"Role","path":"BCOS-ProductionStack/ProductionScalableTarget/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.215.0","metadata":[]},"children":{"ImportRole":{"id":"ImportRole","path":"BCOS-ProductionStack/ProductionScalableTarget/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.215.0","metadata":[]}},"Resource":{"id":"Resource","path":"BCOS-ProductionStack/ProductionScalableTarget/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"application-autoscaling.amazonaws.com"}}],"Version":"2012-10-17"},"tags":[{"key":"Backup","value":"daily"},{"key":"Compliance","value":"required"},{"key":"CostCenter","value":"Operations"},{"key":"Environment","value":"production"},{"key":"Monitoring","value":"enhanced"}]}}}}},"Resource":{"id":"Resource","path":"BCOS-ProductionStack/ProductionScalableTarget/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.CfnScalableTarget","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApplicationAutoScaling::ScalableTarget","aws:cdk:cloudformation:props":{"maxCapacity":20,"minCapacity":2,"resourceId":{"Fn::Join":["",["service/",{"Ref":"ProductionCluster0525040D"},"/",{"Fn::GetAtt":["ProductionService0C624589","Name"]}]]},"roleArn":{"Fn::GetAtt":["ProductionScalableTargetRoleD93CE746","Arn"]},"scalableDimension":"ecs:service:DesiredCount","scheduledActions":[{"scheduledActionName":"ProductionBusinessHoursScaling","schedule":"cron(0 8 ? * 1-5 *)","scalableTargetAction":{"maxCapacity":20,"minCapacity":4}},{"scheduledActionName":"ProductionOffHoursScaling","schedule":"cron(0 20 ? * 1-5 *)","scalableTargetAction":{"maxCapacity":10,"minCapacity":2}}],"serviceNamespace":"ecs"}}},"ProductionCPUScaling":{"id":"ProductionCPUScaling","path":"BCOS-ProductionStack/ProductionScalableTarget/ProductionCPUScaling","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.TargetTrackingScalingPolicy","version":"2.215.0"},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/ProductionScalableTarget/ProductionCPUScaling/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.CfnScalingPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApplicationAutoScaling::ScalingPolicy","aws:cdk:cloudformation:props":{"policyName":"BCOSProductionStackProductionScalableTargetProductionCPUScaling1C8AD1D2","policyType":"TargetTrackingScaling","scalingTargetId":{"Ref":"ProductionScalableTarget99484CA2"},"targetTrackingScalingPolicyConfiguration":{"predefinedMetricSpecification":{"predefinedMetricType":"ECSServiceAverageCPUUtilization"},"scaleInCooldown":600,"scaleOutCooldown":300,"targetValue":70}}}}}},"ProductionMemoryScaling":{"id":"ProductionMemoryScaling","path":"BCOS-ProductionStack/ProductionScalableTarget/ProductionMemoryScaling","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.TargetTrackingScalingPolicy","version":"2.215.0"},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/ProductionScalableTarget/ProductionMemoryScaling/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.CfnScalingPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApplicationAutoScaling::ScalingPolicy","aws:cdk:cloudformation:props":{"policyName":"BCOSProductionStackProductionScalableTargetProductionMemoryScalingE399F743","policyType":"TargetTrackingScaling","scalingTargetId":{"Ref":"ProductionScalableTarget99484CA2"},"targetTrackingScalingPolicyConfiguration":{"predefinedMetricSpecification":{"predefinedMetricType":"ECSServiceAverageMemoryUtilization"},"scaleInCooldown":600,"scaleOutCooldown":300,"targetValue":75}}}}}},"ProductionRequestScaling":{"id":"ProductionRequestScaling","path":"BCOS-ProductionStack/ProductionScalableTarget/ProductionRequestScaling","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.TargetTrackingScalingPolicy","version":"2.215.0"},"children":{"Resource":{"id":"Resource","path":"BCOS-ProductionStack/ProductionScalableTarget/ProductionRequestScaling/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_applicationautoscaling.CfnScalingPolicy","version":"2.215.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApplicationAutoScaling::ScalingPolicy","aws:cdk:cloudformation:props":{"policyName":"BCOSProductionStackProductionScalableTargetProductionRequestScaling067FBF9F","policyType":"TargetTrackingScaling","scalingTargetId":{"Ref":"ProductionScalableTarget99484CA2"},"targetTrackingScalingPolicyConfiguration":{"customizedMetricSpecification":{"dimensions":[{"name":"LoadBalancer","value":"dummy-alb-name"},{"name":"TargetGroup","value":"dummy-tg-name"}],"metricName":"RequestCountPerTarget","namespace":"AWS/ApplicationELB","statistic":"Sum"},"scaleInCooldown":600,"scaleOutCooldown":300,"targetValue":1000}}}}}}}},"ProductionClusterName":{"id":"ProductionClusterName","path":"BCOS-ProductionStack/ProductionClusterName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"ProductionServiceName":{"id":"ProductionServiceName","path":"BCOS-ProductionStack/ProductionServiceName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"ProductionURL":{"id":"ProductionURL","path":"BCOS-ProductionStack/ProductionURL","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"ProductionTargetGroupArn":{"id":"ProductionTargetGroupArn","path":"BCOS-ProductionStack/ProductionTargetGroupArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"ProductionDashboardURL":{"id":"ProductionDashboardURL","path":"BCOS-ProductionStack/ProductionDashboardURL","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"ProductionStackArn":{"id":"ProductionStackArn","path":"BCOS-ProductionStack/ProductionStackArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.215.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"BCOS-ProductionStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"BCOS-ProductionStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.215.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"BCOS-ProductionStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.215.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"BCOS-ProductionStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.215.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}